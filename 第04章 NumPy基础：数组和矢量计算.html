<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;z-index:-1;pointer-events:none;opacity:0}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;z-index:0;pointer-events:auto;opacity:1}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{font-family:Helvetica,Arial,sans-serif;height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;font-size:1.1em;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,93.3%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93.3%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>@charset "UTF-8";@import url("https://fonts.googleapis.com/css?family=Lato:400,900|Roboto+Mono:400,700&display=swap");div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp / Marpit Gaia theme.
 *
 * @theme gaia
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .hljs{display:block;overflow-x:auto;padding:.5em;background:#000;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-quote{color:#aeaeae;font-style:italic}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#e28964}div#p>svg>foreignObject>section .hljs-string{color:#65b042}div#p>svg>foreignObject>section .hljs-subst{color:#daefa3}div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-regexp{color:#e9c062}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-tag,div#p>svg>foreignObject>section .hljs-title{color:#89bdff}div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-doctag{text-decoration:underline}div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol{color:#3387cc}div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#3e87e3}div#p>svg>foreignObject>section .hljs-attribute{color:#cda869}div#p>svg>foreignObject>section .hljs-meta{color:#8996a8}div#p>svg>foreignObject>section .hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}div#p>svg>foreignObject>section .hljs-addition{background-color:#253b22;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-deletion{background-color:#420e09;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-selector-class{color:#9b703f}div#p>svg>foreignObject>section .hljs-selector-id{color:#8b98ab}div#p>svg>foreignObject>section .hljs-emphasis{font-style:italic}div#p>svg>foreignObject>section .hljs-strong{font-weight:700}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:580px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin:.5em 0 0}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{font-weight:inherit}div#p>svg>foreignObject>section h1{font-size:1.8em}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.3em}div#p>svg>foreignObject>section h4{font-size:1.1em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section p{margin:1em 0 0}div#p>svg>foreignObject>section ol>li,div#p>svg>foreignObject>section ul>li{margin:.3em 0 0}div#p>svg>foreignObject>section ol>li>p,div#p>svg>foreignObject>section ul>li>p{margin:.6em 0 0}div#p>svg>foreignObject>section code{display:inline-block;font-family:Roboto Mono,monospace;font-size:.8em;letter-spacing:0;margin:-.1em .15em;padding:.1em .2em;vertical-align:baseline}div#p>svg>foreignObject>section pre{display:block;margin:1em 0 0;min-height:1em;overflow:visible}div#p>svg>foreignObject>section pre code{box-sizing:border-box;margin:0;min-width:100%;padding:.5em;font-size:.7em}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:calc(580px - 1em)}div#p>svg>foreignObject>section blockquote{margin:1em 0 0;padding:0 1em;position:relative}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before{content:"“";display:block;font-family:Times New Roman,serif;font-weight:700;position:absolute}div#p>svg>foreignObject>section blockquote:before{top:0;left:0}div#p>svg>foreignObject>section blockquote:after{right:0;bottom:0;transform:rotate(180deg)}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section mark{background:transparent}div#p>svg>foreignObject>section table{border-spacing:0;border-collapse:collapse;margin:1em 0 0}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{padding:.2em .4em;border-width:1px;border-style:solid}div#p>svg>foreignObject>section{background-image:linear-gradient(135deg,hsla(0,0%,53.3%,0),hsla(0,0%,53.3%,.02) 50%,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.05));font-size:35px;font-family:Lato,Avenir Next,Avenir,Trebuchet MS,Segoe UI,sans-serif;height:720px;line-height:1.35;letter-spacing:1.25px;padding:70px;width:1280px;word-wrap:break-word;color:#455a64;background-color:#fff8e1}div#p>svg>foreignObject>section{--marpit-root-font-size:35px}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section a,div#p>svg>foreignObject>section mark{color:#0288d1}div#p>svg>foreignObject>section code{background:#6a7a7d;color:#fff8e1}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{color:#0288d1}div#p>svg>foreignObject>section pre>code{background:#455a64}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header,div#p>svg>foreignObject>section section:after{color:#6a7a7d}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border-color:#455a64}div#p>svg>foreignObject>section table thead th{background:#455a64;color:#fff8e1}div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) th{background:rgba(69,90,100,.1)}div#p>svg>foreignObject>section.invert{color:#fff8e1;background-color:#455a64}div#p>svg>foreignObject>section.invert a,div#p>svg>foreignObject>section.invert mark{color:#81d4fa}div#p>svg>foreignObject>section.invert code{background:#dad8c8;color:#455a64}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.invert pre>code{background:#fff8e1}div#p>svg>foreignObject>section.invert blockquote:after,div#p>svg>foreignObject>section.invert blockquote:before,div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header,div#p>svg>foreignObject>section.invert section:after{color:#dad8c8}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#fff8e1}div#p>svg>foreignObject>section.invert table thead th{background:#fff8e1;color:#455a64}div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.gaia{color:#fff8e1;background-color:#0288d1}div#p>svg>foreignObject>section.gaia a,div#p>svg>foreignObject>section.gaia mark{color:#81d4fa}div#p>svg>foreignObject>section.gaia code{background:#cce2de;color:#0288d1}div#p>svg>foreignObject>section.gaia h1 strong,div#p>svg>foreignObject>section.gaia h2 strong,div#p>svg>foreignObject>section.gaia h3 strong,div#p>svg>foreignObject>section.gaia h4 strong,div#p>svg>foreignObject>section.gaia h5 strong,div#p>svg>foreignObject>section.gaia h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.gaia pre>code{background:#fff8e1}div#p>svg>foreignObject>section.gaia blockquote:after,div#p>svg>foreignObject>section.gaia blockquote:before,div#p>svg>foreignObject>section.gaia footer,div#p>svg>foreignObject>section.gaia header,div#p>svg>foreignObject>section.gaia section:after{color:#cce2de}div#p>svg>foreignObject>section.gaia table td,div#p>svg>foreignObject>section.gaia table th{border-color:#fff8e1}div#p>svg>foreignObject>section.gaia table thead th{background:#fff8e1;color:#0288d1}div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.lead{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center}div#p>svg>foreignObject>section.lead h1,div#p>svg>foreignObject>section.lead h2,div#p>svg>foreignObject>section.lead h3,div#p>svg>foreignObject>section.lead h4,div#p>svg>foreignObject>section.lead h5,div#p>svg>foreignObject>section.lead h6{text-align:center}div#p>svg>foreignObject>section.lead h1 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h2 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h3 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h4 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h5 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h6 svg[data-marp-fitting=svg]{--preserve-aspect-ratio:xMidYMid meet}div#p>svg>foreignObject>section.lead p{text-align:center}div#p>svg>foreignObject>section.lead blockquote>h1,div#p>svg>foreignObject>section.lead blockquote>h2,div#p>svg>foreignObject>section.lead blockquote>h3,div#p>svg>foreignObject>section.lead blockquote>h4,div#p>svg>foreignObject>section.lead blockquote>h5,div#p>svg>foreignObject>section.lead blockquote>h6,div#p>svg>foreignObject>section.lead blockquote>p{text-align:left}div#p>svg>foreignObject>section.lead blockquote svg[data-marp-fitting=svg]:not([data-marp-fitting-math]){--preserve-aspect-ratio:xMinYMin meet}div#p>svg>foreignObject>section.lead ol>li>p,div#p>svg>foreignObject>section.lead ul>li>p{text-align:left}div#p>svg>foreignObject>section.lead table{margin-left:auto;margin-right:auto}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{box-sizing:border-box;font-size:66%;height:70px;line-height:50px;overflow:hidden;padding:10px 25px;position:absolute}div#p>svg>foreignObject>section:after{--marpit-root-font-size:66%}div#p>svg>foreignObject>section header{top:0}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{left:0;right:0}div#p>svg>foreignObject>section footer{bottom:0}div#p>svg>foreignObject>section:after{right:0;bottom:0;font-size:80%}div#p>svg>foreignObject>section:after{--marpit-root-font-size:80%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-class="lead" data-theme="gaia" class="lead" data-marpit-pagination="1" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--class:lead;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>第4章 Numpy 基础: 数组与向量化计算</h1>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-marpit-fragments="5" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="2" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>NumPy（Numerical Python的简称）是Python数值计算最重要的基础包。大多数提供科学计算的包都是用NumPy的数组作为构建基础。</p>
<p>NumPy的部分功能如下：</p>
<ul>
<li data-marpit-fragment="1">ndarray，一个具有矢量算术运算和复杂广播能力的快速且节省空间的多维数组。</li>
<li data-marpit-fragment="2">用于对整组数据进行快速运算的标准数学函数（无需编写循环）。</li>
<li data-marpit-fragment="3">用于读写磁盘数据的工具以及用于操作内存映射文件的工具。</li>
<li data-marpit-fragment="4">线性代数、随机数生成以及傅里叶变换功能。</li>
<li data-marpit-fragment="5">用于连接 Numpy 到 C、C++、Fortran 等语言编写的代码的 C 语言 API。</li>
</ul>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="3" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>由于NumPy提供了一个简单易用的C API，因此很容易将数据传递给由低级语言编写的外部库，外部库也能以NumPy数组的形式将数据返回给Python。这个功能使Python成为一种包装C/C++/Fortran历史代码库的选择，并使被包装库拥有一个动态的、易用的接口。</p>
<p>NumPy本身并没有提供多么高级的数据分析功能，理解NumPy数组以及面向数组的计算将有助于你更加高效地使用诸如pandas之类的工具。因为NumPy是一个很大的题目，我会在附录A中介绍更多NumPy高级功能，比如广播。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-marpit-fragments="6" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="4" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于大部分数据分析应用而言，我最关注的功能主要集中在：</p>
<ul>
<li data-marpit-fragment="1">用于数据整理和清理、子集构造和过滤、转换等快速的矢量化数组运算。</li>
<li data-marpit-fragment="2">常用的数组算法，如排序、唯一化、集合运算等。</li>
<li data-marpit-fragment="3">高效的描述统计和数据聚合/摘要运算。</li>
<li data-marpit-fragment="4">用于异构数据集的合并/连接运算的数据对齐和关系型数据运算。</li>
<li data-marpit-fragment="5">将条件逻辑表述为数组表达式（而不是带有if-elif-else分支的循环）。</li>
<li data-marpit-fragment="6">数据的分组运算（聚合、转换、函数应用等）。。</li>
</ul>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="5" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>虽然NumPy提供了通用的数值数据处理的计算基础，但大多数读者可能还是想将pandas作为统计和分析工作的基础，尤其是处理表格数据时。pandas还提供了一些NumPy所没有的领域特定的功能，如时间序列处理等。</p>
<blockquote>
<p>笔记：Python 的面向数组计算可以追溯到1995年，Jim Hugunin 创建了 Numeric 库。接下来的10年，许多科学编程社区纷纷开始使用 Python 的数组编程，但是进入 21 世纪，库的生态系统变得碎片化了。2005年，Travis Oliphant从 Numeric 和 Numarray 项目整合出了 NumPy 项目，进而所有社区都集合到了这个框架下。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="6" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>NumPy之于数值计算特别重要的原因之一，是因为它可以高效处理大数组的数据。这是因为：</p>
<ul>
<li>NumPy是在一个连续的内存块中存储数据，独立于其他Python内置对象。NumPy的C语言编写的算法库可以操作内存，而不必进行类型检查或其它前期工作。比起Python的内置序列，NumPy数组使用的内存更少。</li>
<li>NumPy可以在整个数组上执行复杂的计算，而不需要Python的for循环。</li>
</ul>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="7" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>要搞明白具体的性能差距，考察一个包含一百万整数的数组，和一个等价的Python列表：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">7</span>]: <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

In [<span class="hljs-number">8</span>]: my_arr = np.arange(<span class="hljs-number">1000000</span>)

In [<span class="hljs-number">9</span>]: my_list = list(range(<span class="hljs-number">1000000</span>))
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="8" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>各个序列分别乘以2：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">10</span>]: %time <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>): my_arr2 = my_arr * <span class="hljs-number">2</span>
CPU times: user <span class="hljs-number">20</span> ms, sys: <span class="hljs-number">50</span> ms, total: <span class="hljs-number">70</span> ms
Wall time: <span class="hljs-number">72.4</span> ms

In [<span class="hljs-number">11</span>]: %time <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>): my_list2 = [x * <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> my_list]
CPU times: user <span class="hljs-number">760</span> ms, sys: <span class="hljs-number">290</span> ms, total: <span class="hljs-number">1.05</span> s
Wall time: <span class="hljs-number">1.05</span> s
</span></span></foreignObject></svg></code></pre>
<p>基于NumPy的算法要比纯Python快10到100倍（甚至更快），并且使用的内存更少。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="9" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.1 NumPy的ndarray：一种多维数组对象</h2>
<p>NumPy最重要的一个特点就是其N维数组对象（即ndarray），该对象是一个快速而灵活的大数据集容器。你可以利用这种数组对整块数据执行一些数学运算，其语法跟标量元素之间的运算一样。</p>
<p>要明白Python是如何利用与标量值类似的语法进行批次计算，我先引入NumPy，然后生成一个包含随机数据的小数组：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="10" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">12</span>]: <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># Generate some random data</span>
In [<span class="hljs-number">13</span>]: data = np.random.randn(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

In [<span class="hljs-number">14</span>]: data
Out[<span class="hljs-number">14</span>]: 
array([[<span class="hljs-number">-0.2047</span>,  <span class="hljs-number">0.4789</span>, <span class="hljs-number">-0.5194</span>],
       [<span class="hljs-number">-0.5557</span>,  <span class="hljs-number">1.9658</span>,  <span class="hljs-number">1.3934</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="11" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>然后进行数学运算：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">15</span>]: data * <span class="hljs-number">10</span>
Out[<span class="hljs-number">15</span>]: 
array([[ <span class="hljs-number">-2.0471</span>,   <span class="hljs-number">4.7894</span>,  <span class="hljs-number">-5.1944</span>],
       [ <span class="hljs-number">-5.5573</span>,  <span class="hljs-number">19.6578</span>,  <span class="hljs-number">13.9341</span>]])

In [<span class="hljs-number">16</span>]: data + data
Out[<span class="hljs-number">16</span>]: 
array([[<span class="hljs-number">-0.4094</span>,  <span class="hljs-number">0.9579</span>, <span class="hljs-number">-1.0389</span>],
       [<span class="hljs-number">-1.1115</span>,  <span class="hljs-number">3.9316</span>,  <span class="hljs-number">2.7868</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="12" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>第一个例子中，所有的元素都乘以10。第二个例子中，每个元素都与自身相加。</p>
<blockquote>
<p>笔记：在本章及全书中，我会使用标准的NumPy惯用法<code>import numpy as np</code>。你当然也可以在代码中使用<code>from numpy import *</code>，但不建议这么做。<code>numpy</code>的命名空间很大，包含许多函数，其中一些的名字与Python的内置函数重名（比如min和max）。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="13" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>ndarray是一个通用的同构数据多维容器，也就是说，其中的所有元素必须是相同类型的。每个数组都有一个shape（一个表示各维度大小的元组）和一个dtype（一个用于说明数组数据类型的对象）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">17</span>]: data.shape
Out[<span class="hljs-number">17</span>]: (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

In [<span class="hljs-number">18</span>]: data.dtype
Out[<span class="hljs-number">18</span>]: dtype(<span class="hljs-string">&#x27;float64&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="14" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>本章将会介绍NumPy数组的基本用法，这对于本书后面各章的理解基本够用。虽然大多数数据分析工作不需要深入理解NumPy，但是精通面向数组的编程和思维方式是成为Python科学计算牛人的一大关键步骤。</p>
<blockquote>
<p>笔记：当你在本书中看到“数组”、“NumPy数组”、&quot;ndarray&quot;时，基本上都指的是同一样东西，即ndarray对象。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="15" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.1 创建ndarray</h3>
<p>创建数组最简单的办法就是使用array函数。它接受一切序列型的对象（包括其他数组），然后产生一个新的含有传入数据的NumPy数组。以一个列表的转换为例：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">19</span>]: data1 = [<span class="hljs-number">6</span>, <span class="hljs-number">7.5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]

In [<span class="hljs-number">20</span>]: arr1 = np.array(data1)

In [<span class="hljs-number">21</span>]: arr1
Out[<span class="hljs-number">21</span>]: array([ <span class="hljs-number">6.</span> ,  <span class="hljs-number">7.5</span>,  <span class="hljs-number">8.</span> ,  <span class="hljs-number">0.</span> ,  <span class="hljs-number">1.</span> ])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="16" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>嵌套序列（比如由一组等长列表组成的列表）将会被转换为一个多维数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">22</span>]: data2 = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]]

In [<span class="hljs-number">23</span>]: arr2 = np.array(data2)

In [<span class="hljs-number">24</span>]: arr2
Out[<span class="hljs-number">24</span>]: 
array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
       [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="17" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>因为data2是列表的列表，NumPy数组arr2的两个维度的shape是从data2引入的。可以用属性ndim和shape验证：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">25</span>]: arr2.ndim
Out[<span class="hljs-number">25</span>]: <span class="hljs-number">2</span>

In [<span class="hljs-number">26</span>]: arr2.shape
Out[<span class="hljs-number">26</span>]: (<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="18" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>除非特别说明（稍后将会详细介绍），np.array会尝试为新建的这个数组推断出一个较为合适的数据类型。数据类型保存在一个特殊的dtype对象中。比如说，在上面的两个例子中，我们有：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">27</span>]: arr1.dtype
Out[<span class="hljs-number">27</span>]: dtype(<span class="hljs-string">&#x27;float64&#x27;</span>)

In [<span class="hljs-number">28</span>]: arr2.dtype
Out[<span class="hljs-number">28</span>]: dtype(<span class="hljs-string">&#x27;int64&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="19" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>除np.array之外，还有一些函数也可以新建数组。比如，zeros和ones分别可以创建指定长度或形状的全0或全1数组。empty可以创建一个没有任何具体值的数组。要用这些方法创建多维数组，只需传入一个表示形状的元组即可：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="20" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">29</span>]: np.zeros(<span class="hljs-number">10</span>)
Out[<span class="hljs-number">29</span>]: array([ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>])

In [<span class="hljs-number">30</span>]: np.zeros((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>))
Out[<span class="hljs-number">30</span>]: 
array([[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>]])

In [<span class="hljs-number">31</span>]: np.empty((<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>))
Out[<span class="hljs-number">31</span>]: 
array([[[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
        [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
        [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>]],
       [[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
        [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
        [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>]]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="21" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<blockquote>
<p>注意：认为np.empty会返回全0数组的想法是不安全的。很多情况下（如前所示），它返回的都是一些未初始化的垃圾值。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="22" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>arange是Python内置函数range的数组版：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">32</span>]: np.arange(<span class="hljs-number">15</span>)
Out[<span class="hljs-number">32</span>]: array([ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="23" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表4-1列出了一些数组创建函数。由于NumPy关注的是数值计算，因此，如果没有特别指定，数据类型基本都是float64（浮点数）。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-78ab11f67e7077a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表4-1 数组创建函数" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="24" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.2 ndarray的数据类型</h3>
<p>dtype（数据类型）是一个特殊的对象，它含有ndarray将一块内存解释为特定数据类型所需的信息：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">33</span>]: arr1 = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], dtype=np.float64)

In [<span class="hljs-number">34</span>]: arr2 = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], dtype=np.int32)

In [<span class="hljs-number">35</span>]: arr1.dtype
Out[<span class="hljs-number">35</span>]: dtype(<span class="hljs-string">&#x27;float64&#x27;</span>)

In [<span class="hljs-number">36</span>]: arr2.dtype
Out[<span class="hljs-number">36</span>]: dtype(<span class="hljs-string">&#x27;int32&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="25" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>dtype是NumPy灵活交互其它系统的源泉之一。多数情况下，它们直接映射到相应的机器表示，这使得“读写磁盘上的二进制数据流”以及“集成低级语言代码（如C、Fortran）”等工作变得更加简单。数值型dtype的命名方式相同：一个类型名（如float或int），后面跟一个用于表示各元素位长的数字。标准的双精度浮点值（即Python中的float对象）需要占用8字节（即64位）。因此，该类型在NumPy中就记作float64。表4-2列出了NumPy所支持的全部数据类型。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="26" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-2f2d7406a8bc076c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:1000" style="width:1000px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="27" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-5cc31115615737b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="28" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<blockquote>
<p>笔记：记不住这些NumPy的dtype也没关系，新手更是如此。通常只需要知道你所处理的数据的大致类型是浮点数、复数、整数、布尔值、字符串，还是普通的Python对象即可。当你需要控制数据在内存和磁盘中的存储方式时（尤其是对大数据集），那就得了解如何控制存储类型。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="29" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>你可以通过ndarray的astype方法明确地将一个数组从一个dtype转换成另一个dtype：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">37</span>]: arr = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])

In [<span class="hljs-number">38</span>]: arr.dtype
Out[<span class="hljs-number">38</span>]: dtype(<span class="hljs-string">&#x27;int64&#x27;</span>)

In [<span class="hljs-number">39</span>]: float_arr = arr.astype(np.float64)

In [<span class="hljs-number">40</span>]: float_arr.dtype
Out[<span class="hljs-number">40</span>]: dtype(<span class="hljs-string">&#x27;float64&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="30" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在本例中，整数被转换成了浮点数。如果将浮点数转换成整数，则小数部分将会被截取删除：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">41</span>]: arr = np.array([<span class="hljs-number">3.7</span>, <span class="hljs-number">-1.2</span>, <span class="hljs-number">-2.6</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">12.9</span>, <span class="hljs-number">10.1</span>])

In [<span class="hljs-number">42</span>]: arr
Out[<span class="hljs-number">42</span>]: array([  <span class="hljs-number">3.7</span>,  <span class="hljs-number">-1.2</span>,  <span class="hljs-number">-2.6</span>,   <span class="hljs-number">0.5</span>,  <span class="hljs-number">12.9</span>,  <span class="hljs-number">10.1</span>])

In [<span class="hljs-number">43</span>]: arr.astype(np.int32)
Out[<span class="hljs-number">43</span>]: array([ <span class="hljs-number">3</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">-2</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>], dtype=int32)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="31" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果某字符串数组表示的全是数字，也可以用astype将其转换为数值形式：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">44</span>]: numeric_strings = np.array([<span class="hljs-string">&#x27;1.25&#x27;</span>, <span class="hljs-string">&#x27;-9.6&#x27;</span>, <span class="hljs-string">&#x27;42&#x27;</span>], dtype=np.string_)

In [<span class="hljs-number">45</span>]: numeric_strings.astype(float)
Out[<span class="hljs-number">45</span>]: array([  <span class="hljs-number">1.25</span>,  <span class="hljs-number">-9.6</span> ,  <span class="hljs-number">42.</span>  ])
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>注意：使用numpy.string_类型时，一定要小心，因为NumPy的字符串数据是大小固定的，发生截取时，不会发出警告。pandas提供了更多非数值数据的便利的处理方法。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="32" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果转换过程因为某种原因而失败了（比如某个不能被转换为float64的字符串），就会引发一个ValueError。这里，我比较懒，写的是float而不是np.float64；NumPy很聪明，它会将Python类型映射到等价的dtype上。</p>
<p>数组的dtype还有另一个属性：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">46</span>]: int_array = np.arange(<span class="hljs-number">10</span>)

In [<span class="hljs-number">47</span>]: calibers = np.array([<span class="hljs-number">.22</span>, <span class="hljs-number">.270</span>, <span class="hljs-number">.357</span>, <span class="hljs-number">.380</span>, <span class="hljs-number">.44</span>, <span class="hljs-number">.50</span>], dtype=np.float64)

In [<span class="hljs-number">48</span>]: int_array.astype(calibers.dtype)
Out[<span class="hljs-number">48</span>]: array([ <span class="hljs-number">0.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">6.</span>,  <span class="hljs-number">7.</span>,  <span class="hljs-number">8.</span>,  <span class="hljs-number">9.</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="33" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>你还可以用简洁的类型代码来表示dtype：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">49</span>]: empty_uint32 = np.empty(<span class="hljs-number">8</span>, dtype=<span class="hljs-string">&#x27;u4&#x27;</span>)

In [<span class="hljs-number">50</span>]: empty_uint32
Out[<span class="hljs-number">50</span>]: 
array([         <span class="hljs-number">0</span>, <span class="hljs-number">1075314688</span>,          <span class="hljs-number">0</span>, <span class="hljs-number">1075707904</span>,          <span class="hljs-number">0</span>,
       <span class="hljs-number">1075838976</span>,          <span class="hljs-number">0</span>, <span class="hljs-number">1072693248</span>], dtype=uint32)
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>笔记：调用astype总会创建一个新的数组（一个数据的备份），即使新的dtype与旧的dtype相同。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="34" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.3 NumPy数组的运算</h3>
<p>数组很重要，因为它使你不用编写循环即可对数据执行批量运算。NumPy用户称其为矢量化（vectorization）。大小相等的数组之间的任何算术运算都会将运算应用到元素级：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="35" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">51</span>]: arr = np.array([[<span class="hljs-number">1.</span>, <span class="hljs-number">2.</span>, <span class="hljs-number">3.</span>], [<span class="hljs-number">4.</span>, <span class="hljs-number">5.</span>, <span class="hljs-number">6.</span>]])

In [<span class="hljs-number">52</span>]: arr
Out[<span class="hljs-number">52</span>]: 
array([[ <span class="hljs-number">1.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">3.</span>],
       [ <span class="hljs-number">4.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">6.</span>]])

In [<span class="hljs-number">53</span>]: arr * arr
Out[<span class="hljs-number">53</span>]: 
array([[  <span class="hljs-number">1.</span>,   <span class="hljs-number">4.</span>,   <span class="hljs-number">9.</span>],
       [ <span class="hljs-number">16.</span>,  <span class="hljs-number">25.</span>,  <span class="hljs-number">36.</span>]])

In [<span class="hljs-number">54</span>]: arr - arr
Out[<span class="hljs-number">54</span>]: 
array([[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="36" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>数组与标量的算术运算会将标量值传播到各个元素：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">55</span>]: <span class="hljs-number">1</span> / arr
Out[<span class="hljs-number">55</span>]: 
array([[ <span class="hljs-number">1.</span>    ,  <span class="hljs-number">0.5</span>   ,  <span class="hljs-number">0.3333</span>],
       [ <span class="hljs-number">0.25</span>  ,  <span class="hljs-number">0.2</span>   ,  <span class="hljs-number">0.1667</span>]])

In [<span class="hljs-number">56</span>]: arr ** <span class="hljs-number">0.5</span>
Out[<span class="hljs-number">56</span>]: 
array([[ <span class="hljs-number">1.</span>    ,  <span class="hljs-number">1.4142</span>,  <span class="hljs-number">1.7321</span>],
       [ <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.2361</span>,  <span class="hljs-number">2.4495</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="37" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>大小相同的数组之间的比较会生成布尔值数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">57</span>]: arr2 = np.array([[<span class="hljs-number">0.</span>, <span class="hljs-number">4.</span>, <span class="hljs-number">1.</span>], [<span class="hljs-number">7.</span>, <span class="hljs-number">2.</span>, <span class="hljs-number">12.</span>]])

In [<span class="hljs-number">58</span>]: arr2
Out[<span class="hljs-number">58</span>]: 
array([[  <span class="hljs-number">0.</span>,   <span class="hljs-number">4.</span>,   <span class="hljs-number">1.</span>],
       [  <span class="hljs-number">7.</span>,   <span class="hljs-number">2.</span>,  <span class="hljs-number">12.</span>]])

In [<span class="hljs-number">59</span>]: arr2 &gt; arr
Out[<span class="hljs-number">59</span>]:
array([[<span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>],
       [ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>]], dtype=bool)
</span></span></foreignObject></svg></code></pre>
<p>不同大小的数组之间的运算叫做广播（broadcasting），将在附录A中对其进行详细讨论。本书的内容不需要对广播机制有多深的理解。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="38" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="38" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.4 基本的索引和切片</h3>
<p>NumPy数组的索引是一个内容丰富的主题，因为选取数据子集或单个元素的方式有很多。一维数组很简单。从表面上看，它们跟Python列表的功能差不多：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="39" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="39" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">60</span>]: arr = np.arange(<span class="hljs-number">10</span>)

In [<span class="hljs-number">61</span>]: arr
Out[<span class="hljs-number">61</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])

In [<span class="hljs-number">62</span>]: arr[<span class="hljs-number">5</span>]
Out[<span class="hljs-number">62</span>]: <span class="hljs-number">5</span>

In [<span class="hljs-number">63</span>]: arr[<span class="hljs-number">5</span>:<span class="hljs-number">8</span>]
Out[<span class="hljs-number">63</span>]: array([<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>])

In [<span class="hljs-number">64</span>]: arr[<span class="hljs-number">5</span>:<span class="hljs-number">8</span>] = <span class="hljs-number">12</span>

In [<span class="hljs-number">65</span>]: arr
Out[<span class="hljs-number">65</span>]: array([ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">12</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="40" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="40" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如上所示，当你将一个标量值赋值给一个切片时（如arr[5:8]=12），该值会自动传播（也就说后面将会讲到的“广播”）到整个选区。跟列表最重要的区别在于，数组切片是原始数组的视图。这意味着数据不会被复制，视图上的任何修改都会直接反映到源数组上。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="41" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="41" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>作为例子，先创建一个arr的切片：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">66</span>]: arr_slice = arr[<span class="hljs-number">5</span>:<span class="hljs-number">8</span>]

In [<span class="hljs-number">67</span>]: arr_slice
Out[<span class="hljs-number">67</span>]: array([<span class="hljs-number">12</span>, <span class="hljs-number">12</span>, <span class="hljs-number">12</span>])
</span></span></foreignObject></svg></code></pre>
<p>现在，当我修稿arr_slice中的值，变动也会体现在原始数组arr中：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">68</span>]: arr_slice[<span class="hljs-number">1</span>] = <span class="hljs-number">12345</span>

In [<span class="hljs-number">69</span>]: arr
Out[<span class="hljs-number">69</span>]: array([    <span class="hljs-number">0</span>,     <span class="hljs-number">1</span>,     <span class="hljs-number">2</span>,     <span class="hljs-number">3</span>,     <span class="hljs-number">4</span>,    <span class="hljs-number">12</span>, <span class="hljs-number">12345</span>,    <span class="hljs-number">12</span>,     <span class="hljs-number">8</span>,   
  <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="42" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="42" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>切片[ : ]会给数组中的所有值赋值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">70</span>]: arr_slice[:] = <span class="hljs-number">64</span>

In [<span class="hljs-number">71</span>]: arr
Out[<span class="hljs-number">71</span>]: array([ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="43" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="43" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果你刚开始接触NumPy，可能会对此感到惊讶（尤其是当你曾经用过其他热衷于复制数组数据的编程语言）。由于NumPy的设计目的是处理大数据，所以你可以想象一下，假如NumPy坚持要将数据复制来复制去的话会产生何等的性能和内存问题。</p>
<blockquote>
<p>注意：如果你想要得到的是ndarray切片的一份副本而非视图，就需要明确地进行复制操作，例如<code>arr[5:8].copy()</code>。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="44" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="44" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于高维度数组，能做的事情更多。在一个二维数组中，各索引位置上的元素不再是标量而是一维数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">72</span>]: arr2d = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]])

In [<span class="hljs-number">73</span>]: arr2d[<span class="hljs-number">2</span>]
Out[<span class="hljs-number">73</span>]: array([<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="45" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="45" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>因此，可以对各个元素进行递归访问，但这样需要做的事情有点多。你可以传入一个以逗号隔开的索引列表来选取单个元素。也就是说，下面两种方式是等价的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">74</span>]: arr2d[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]
Out[<span class="hljs-number">74</span>]: <span class="hljs-number">3</span>

In [<span class="hljs-number">75</span>]: arr2d[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>]
Out[<span class="hljs-number">75</span>]: <span class="hljs-number">3</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="46" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="46" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>图4-1说明了二维数组的索引方式。轴0作为行，轴1作为列。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-0a641536f73f560e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图4-1 NumPy数组中的元素索引 w:600 center" style="width:600px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="47" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="47" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在多维数组中，如果省略了后面的索引，则返回对象会是一个维度低一点的ndarray（它含有高一级维度上的所有数据）。因此，在2×2×3数组arr3d中：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">76</span>]: arr3d = np.array([[[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]], [[<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]]])

In [<span class="hljs-number">77</span>]: arr3d
Out[<span class="hljs-number">77</span>]: 
array([[[ <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
        [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>]],
       [[ <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],
        [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="48" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="48" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>arr3d[0]是一个2×3数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">78</span>]: arr3d[<span class="hljs-number">0</span>]
Out[<span class="hljs-number">78</span>]: 
array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
       [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="49" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="49" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>标量值和数组都可以被赋值给arr3d[0]：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">79</span>]: old_values = arr3d[<span class="hljs-number">0</span>].copy()

In [<span class="hljs-number">80</span>]: arr3d[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>

In [<span class="hljs-number">81</span>]: arr3d
Out[<span class="hljs-number">81</span>]: 
array([[[<span class="hljs-number">42</span>, <span class="hljs-number">42</span>, <span class="hljs-number">42</span>],
        [<span class="hljs-number">42</span>, <span class="hljs-number">42</span>, <span class="hljs-number">42</span>]],
       [[ <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],
        [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]]])

In [<span class="hljs-number">82</span>]: arr3d[<span class="hljs-number">0</span>] = old_values
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="50" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="50" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">83</span>]: arr3d
Out[<span class="hljs-number">83</span>]: 
array([[[ <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
        [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>]],
       [[ <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],
        [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]]])
</span></span></foreignObject></svg></code></pre>
<p>相似的，arr3d[1,0]可以访问索引以(1,0)开头的那些值（以一维数组的形式返回）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">84</span>]: arr3d[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
Out[<span class="hljs-number">84</span>]: array([<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="51" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="51" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>虽然是用两步进行索引的，表达式是相同的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">85</span>]: x = arr3d[<span class="hljs-number">1</span>]

In [<span class="hljs-number">86</span>]: x
Out[<span class="hljs-number">86</span>]: 
array([[ <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],
       [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]])

In [<span class="hljs-number">87</span>]: x[<span class="hljs-number">0</span>]
Out[<span class="hljs-number">87</span>]: array([<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<p>注意，在上面所有这些选取数组子集的例子中，返回的数组都是视图。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="52" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="52" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h4>4.1.4.1 切片索引</h4>
<p>ndarray的切片语法跟Python列表这样的一维对象差不多：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">88</span>]: arr
Out[<span class="hljs-number">88</span>]: array([ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>])

In [<span class="hljs-number">89</span>]: arr[<span class="hljs-number">1</span>:<span class="hljs-number">6</span>]
Out[<span class="hljs-number">89</span>]: array([ <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">64</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="53" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="53" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于之前的二维数组arr2d，其切片方式稍显不同：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">90</span>]: arr2d
Out[<span class="hljs-number">90</span>]: 
array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
       [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],
       [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]])

In [<span class="hljs-number">91</span>]: arr2d[:<span class="hljs-number">2</span>]
Out[<span class="hljs-number">91</span>]: 
array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
       [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="54" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="54" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>可以看出，它是沿着第0轴（即第一个轴）切片的。也就是说，切片是沿着一个轴向选取元素的。表达式arr2d[:2]可以被认为是“选取arr2d的前两行”。</p>
<p>你可以一次传入多个切片，就像传入多个索引那样：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">92</span>]: arr2d[:<span class="hljs-number">2</span>, <span class="hljs-number">1</span>:]
Out[<span class="hljs-number">92</span>]: 
array([[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
       [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="55" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="55" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>像这样进行切片时，只能得到相同维数的数组视图。通过将整数索引和切片混合，可以得到低维度的切片。</p>
<p>例如，我可以选取第二行的前两列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">93</span>]: arr2d[<span class="hljs-number">1</span>, :<span class="hljs-number">2</span>]
Out[<span class="hljs-number">93</span>]: array([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>])
</span></span></foreignObject></svg></code></pre>
<p>相似的，还可以选择第三列的前两行：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">94</span>]: arr2d[:<span class="hljs-number">2</span>, <span class="hljs-number">2</span>]
Out[<span class="hljs-number">94</span>]: array([<span class="hljs-number">3</span>, <span class="hljs-number">6</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="56" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="56" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>图4-2对此进行了说明。注意，“只有冒号”表示选取整个轴，因此你可以像下面这样只对高维轴进行切片：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">95</span>]: arr2d[:, :<span class="hljs-number">1</span>]
Out[<span class="hljs-number">95</span>]: 
array([[<span class="hljs-number">1</span>],
       [<span class="hljs-number">4</span>],
       [<span class="hljs-number">7</span>]])
</span></span></foreignObject></svg></code></pre>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-9da32d2f4629c304.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图4-2 二维数组切片 w:200" style="width:200px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="57" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="57" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>自然，对切片表达式的赋值操作也会被扩散到整个选区：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">96</span>]: arr2d[:<span class="hljs-number">2</span>, <span class="hljs-number">1</span>:] = <span class="hljs-number">0</span>

In [<span class="hljs-number">97</span>]: arr2d
Out[<span class="hljs-number">97</span>]: 
array([[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
       [<span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
       [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="58" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="58" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.5 布尔型索引</h3>
<p>来看这样一个例子，假设我们有一个用于存储数据的数组以及一个存储姓名的数组（含有重复项）。在这里，我将使用numpy.random中的randn函数生成一些正态分布的随机数据：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="59" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="59" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">98</span>]: names = np.array([<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>])

In [<span class="hljs-number">99</span>]: data = np.random.randn(<span class="hljs-number">7</span>, <span class="hljs-number">4</span>)

In [<span class="hljs-number">100</span>]: names
Out[<span class="hljs-number">100</span>]: 
array([<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>],
      dtype=<span class="hljs-string">&#x27;&lt;U4&#x27;</span>)

In [<span class="hljs-number">101</span>]: data
Out[<span class="hljs-number">101</span>]: 
array([[ <span class="hljs-number">0.0929</span>,  <span class="hljs-number">0.2817</span>,  <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [ <span class="hljs-number">1.0072</span>, <span class="hljs-number">-1.2962</span>,  <span class="hljs-number">0.275</span> ,  <span class="hljs-number">0.2289</span>],
       [ <span class="hljs-number">1.3529</span>,  <span class="hljs-number">0.8864</span>, <span class="hljs-number">-2.0016</span>, <span class="hljs-number">-0.3718</span>],
       [ <span class="hljs-number">1.669</span> , <span class="hljs-number">-0.4386</span>, <span class="hljs-number">-0.5397</span>,  <span class="hljs-number">0.477</span> ],
       [ <span class="hljs-number">3.2489</span>, <span class="hljs-number">-1.0212</span>, <span class="hljs-number">-0.5771</span>,  <span class="hljs-number">0.1241</span>],
       [ <span class="hljs-number">0.3026</span>,  <span class="hljs-number">0.5238</span>,  <span class="hljs-number">0.0009</span>,  <span class="hljs-number">1.3438</span>],
       [<span class="hljs-number">-0.7135</span>, <span class="hljs-number">-0.8312</span>, <span class="hljs-number">-2.3702</span>, <span class="hljs-number">-1.8608</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="60" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="60" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>假设每个名字都对应data数组中的一行，而我们想要选出对应于名字&quot;Bob&quot;的所有行。跟算术运算一样，数组的比较运算（如==）也是矢量化的。因此，对names和字符串&quot;Bob&quot;的比较运算将会产生一个布尔型数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">102</span>]: names == <span class="hljs-string">&#x27;Bob&#x27;</span>
Out[<span class="hljs-number">102</span>]: array([ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>], dtype=bool)
</span></span></foreignObject></svg></code></pre>
<p>这个布尔型数组可用于数组索引：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">103</span>]: data[names == <span class="hljs-string">&#x27;Bob&#x27;</span>]
Out[<span class="hljs-number">103</span>]: 
array([[ <span class="hljs-number">0.0929</span>,  <span class="hljs-number">0.2817</span>,  <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [ <span class="hljs-number">1.669</span> , <span class="hljs-number">-0.4386</span>, <span class="hljs-number">-0.5397</span>,  <span class="hljs-number">0.477</span> ]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="61" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="61" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>布尔型数组的长度必须跟被索引的轴长度一致。此外，还可以将布尔型数组跟切片、整数（或整数序列，稍后将对此进行详细讲解）混合使用：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">103</span>]: data[names == <span class="hljs-string">&#x27;Bob&#x27;</span>]
Out[<span class="hljs-number">103</span>]: 
array([[ <span class="hljs-number">0.0929</span>,  <span class="hljs-number">0.2817</span>,  <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [ <span class="hljs-number">1.669</span> , <span class="hljs-number">-0.4386</span>, <span class="hljs-number">-0.5397</span>,  <span class="hljs-number">0.477</span> ]])
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>注意：如果布尔型数组的长度不对，布尔型选择就会出错，因此一定要小心。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="62" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="62" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>下面的例子，我选取了<code>names == 'Bob'</code>的行，并索引了列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">104</span>]: data[names == <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-number">2</span>:]
Out[<span class="hljs-number">104</span>]: 
array([[ <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [<span class="hljs-number">-0.5397</span>,  <span class="hljs-number">0.477</span> ]])

In [<span class="hljs-number">105</span>]: data[names == <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-number">3</span>]
Out[<span class="hljs-number">105</span>]: array([ <span class="hljs-number">1.2464</span>,  <span class="hljs-number">0.477</span> ])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="63" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="63" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>要选择除&quot;Bob&quot;以外的其他值，既可以使用不等于符号（<code>!=</code>），也可以通过<code>~</code>对条件进行否定：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">106</span>]: names != <span class="hljs-string">&#x27;Bob&#x27;</span>
Out[<span class="hljs-number">106</span>]: array([<span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>], dtype=bool)

In [<span class="hljs-number">107</span>]: data[~(names == <span class="hljs-string">&#x27;Bob&#x27;</span>)]
Out[<span class="hljs-number">107</span>]:
array([[ <span class="hljs-number">1.0072</span>, <span class="hljs-number">-1.2962</span>,  <span class="hljs-number">0.275</span> ,  <span class="hljs-number">0.2289</span>],
       [ <span class="hljs-number">1.3529</span>,  <span class="hljs-number">0.8864</span>, <span class="hljs-number">-2.0016</span>, <span class="hljs-number">-0.3718</span>],
       [ <span class="hljs-number">3.2489</span>, <span class="hljs-number">-1.0212</span>, <span class="hljs-number">-0.5771</span>,  <span class="hljs-number">0.1241</span>],
       [ <span class="hljs-number">0.3026</span>,  <span class="hljs-number">0.5238</span>,  <span class="hljs-number">0.0009</span>,  <span class="hljs-number">1.3438</span>],
       [<span class="hljs-number">-0.7135</span>, <span class="hljs-number">-0.8312</span>, <span class="hljs-number">-2.3702</span>, <span class="hljs-number">-1.8608</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="64" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="64" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><code>~</code>操作符用来反转条件很好用：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">108</span>]: cond = names == <span class="hljs-string">&#x27;Bob&#x27;</span>

In [<span class="hljs-number">109</span>]: data[~cond]
Out[<span class="hljs-number">109</span>]: 
array([[ <span class="hljs-number">1.0072</span>, <span class="hljs-number">-1.2962</span>,  <span class="hljs-number">0.275</span> ,  <span class="hljs-number">0.2289</span>],
       [ <span class="hljs-number">1.3529</span>,  <span class="hljs-number">0.8864</span>, <span class="hljs-number">-2.0016</span>, <span class="hljs-number">-0.3718</span>],
       [ <span class="hljs-number">3.2489</span>, <span class="hljs-number">-1.0212</span>, <span class="hljs-number">-0.5771</span>,  <span class="hljs-number">0.1241</span>],
       [ <span class="hljs-number">0.3026</span>,  <span class="hljs-number">0.5238</span>,  <span class="hljs-number">0.0009</span>,  <span class="hljs-number">1.3438</span>],
       [<span class="hljs-number">-0.7135</span>, <span class="hljs-number">-0.8312</span>, <span class="hljs-number">-2.3702</span>, <span class="hljs-number">-1.8608</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="65" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="65" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>选取这三个名字中的两个需要组合应用多个布尔条件，使用&amp;（和）、|（或）之类的布尔算术运算符即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">110</span>]: mask = (names == <span class="hljs-string">&#x27;Bob&#x27;</span>) | (names == <span class="hljs-string">&#x27;Will&#x27;</span>)

In [<span class="hljs-number">111</span>]: mask
Out[<span class="hljs-number">111</span>]: array([ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>], dtype=bool)

In [<span class="hljs-number">112</span>]: data[mask]
Out[<span class="hljs-number">112</span>]: 
array([[ <span class="hljs-number">0.0929</span>,  <span class="hljs-number">0.2817</span>,  <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [ <span class="hljs-number">1.3529</span>,  <span class="hljs-number">0.8864</span>, <span class="hljs-number">-2.0016</span>, <span class="hljs-number">-0.3718</span>],
       [ <span class="hljs-number">1.669</span> , <span class="hljs-number">-0.4386</span>, <span class="hljs-number">-0.5397</span>,  <span class="hljs-number">0.477</span> ],
       [ <span class="hljs-number">3.2489</span>, <span class="hljs-number">-1.0212</span>, <span class="hljs-number">-0.5771</span>,  <span class="hljs-number">0.1241</span>]])
</span></span></foreignObject></svg></code></pre>
<p>通过布尔型索引选取数组中的数据，将总是创建数据的副本，即使返回一模一样的数组也是如此。</p>
<blockquote>
<p>注意：Python关键字and和or在布尔型数组中无效。要使用&amp;与|。</p>
</blockquote>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="66" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="66" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通过布尔型数组设置值是一种经常用到的手段。为了将data中的所有负值都设置为0，我们只需：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">113</span>]: data[data &lt; <span class="hljs-number">0</span>] = <span class="hljs-number">0</span>

In [<span class="hljs-number">114</span>]: data
Out[<span class="hljs-number">114</span>]: 
array([[ <span class="hljs-number">0.0929</span>,  <span class="hljs-number">0.2817</span>,  <span class="hljs-number">0.769</span> ,  <span class="hljs-number">1.2464</span>],
       [ <span class="hljs-number">1.0072</span>,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.275</span> ,  <span class="hljs-number">0.2289</span>],
       [ <span class="hljs-number">1.3529</span>,  <span class="hljs-number">0.8864</span>,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ],
       [ <span class="hljs-number">1.669</span> ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.477</span> ],
       [ <span class="hljs-number">3.2489</span>,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.1241</span>],
       [ <span class="hljs-number">0.3026</span>,  <span class="hljs-number">0.5238</span>,  <span class="hljs-number">0.0009</span>,  <span class="hljs-number">1.3438</span>],
       [ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="67" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="67" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通过一维布尔数组设置整行或列的值也很简单：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">115</span>]: data[names != <span class="hljs-string">&#x27;Joe&#x27;</span>] = <span class="hljs-number">7</span>

In [<span class="hljs-number">116</span>]: data
Out[<span class="hljs-number">116</span>]: 
array([[ <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ],
       [ <span class="hljs-number">1.0072</span>,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.275</span> ,  <span class="hljs-number">0.2289</span>],
       [ <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ],
       [ <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ],
       [ <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ,  <span class="hljs-number">7.</span>    ],
       [ <span class="hljs-number">0.3026</span>,  <span class="hljs-number">0.5238</span>,  <span class="hljs-number">0.0009</span>,  <span class="hljs-number">1.3438</span>],
       [ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ]])
</span></span></foreignObject></svg></code></pre>
<p>后面会看到，这类二维数据的操作也可以用pandas方便的来做。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="68" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="68" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.6 花式索引</h3>
<p>花式索引（Fancy indexing）是一个NumPy术语，它指的是利用整数数组进行索引。假设我们有一个8×4数组：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="69" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="69" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">117</span>]: arr = np.empty((<span class="hljs-number">8</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">118</span>]: <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>):
   .....:     arr[i] = i

In [<span class="hljs-number">119</span>]: arr
Out[<span class="hljs-number">119</span>]: 
array([[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>],
       [ <span class="hljs-number">2.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">2.</span>],
       [ <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>],
       [ <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>],
       [ <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>],
       [ <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>],
       [ <span class="hljs-number">7.</span>,  <span class="hljs-number">7.</span>,  <span class="hljs-number">7.</span>,  <span class="hljs-number">7.</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="70" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="70" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>为了以特定顺序选取行子集，只需传入一个用于指定顺序的整数列表或ndarray即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">120</span>]: arr[[<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>]]
Out[<span class="hljs-number">120</span>]: 
array([[ <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>],
       [ <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>],
       [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>,  <span class="hljs-number">6.</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="71" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="71" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这段代码确实达到我们的要求了！使用负数索引将会从末尾开始选取行：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">121</span>]: arr[[<span class="hljs-number">-3</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">-7</span>]]
Out[<span class="hljs-number">121</span>]: 
array([[ <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">5.</span>],
       [ <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>],
       [ <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">1.</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="72" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="72" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>一次传入多个索引数组会有一点特别。它返回的是一个一维数组，其中的元素对应各个索引元组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">122</span>]: arr = np.arange(<span class="hljs-number">32</span>).reshape((<span class="hljs-number">8</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">123</span>]: arr
Out[<span class="hljs-number">123</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
       [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
       [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>],
       [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>],
       [<span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>],
       [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>],
       [<span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>],
       [<span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="73" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="73" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">124</span>]: arr[[<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]
Out[<span class="hljs-number">124</span>]: array([ <span class="hljs-number">4</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span>, <span class="hljs-number">10</span>])
</span></span></foreignObject></svg></code></pre>
<p>附录A中会详细介绍reshape方法。</p>
<p>最终选出的是元素(1,0)、(5,3)、(7,1)和(2,2)。无论数组是多少维的，花式索引总是一维的。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="74" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="74" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这个花式索引的行为可能会跟某些用户的预期不一样（包括我在内），选取矩阵的行列子集应该是矩形区域的形式才对。下面是得到该结果的一个办法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">125</span>]: arr[[<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>]][:, [<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]
Out[<span class="hljs-number">125</span>]: 
array([[ <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>],
       [<span class="hljs-number">20</span>, <span class="hljs-number">23</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>],
       [<span class="hljs-number">28</span>, <span class="hljs-number">31</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>],
       [ <span class="hljs-number">8</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]])
</span></span></foreignObject></svg></code></pre>
<p>记住，花式索引跟切片不一样，它总是将数据复制到新数组中。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="75" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="75" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.1.7 数组转置和轴对换</h3>
<p>转置是重塑的一种特殊形式，它返回的是源数据的视图（不会进行任何复制操作）。数组不仅有transpose方法，还有一个特殊的T属性：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="76" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="76" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">126</span>]: arr = np.arange(<span class="hljs-number">15</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">5</span>))

In [<span class="hljs-number">127</span>]: arr
Out[<span class="hljs-number">127</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>],
       [ <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],
       [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>]])

In [<span class="hljs-number">128</span>]: arr.T
Out[<span class="hljs-number">128</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">10</span>],
       [ <span class="hljs-number">1</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">11</span>],
       [ <span class="hljs-number">2</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">12</span>],
       [ <span class="hljs-number">3</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>],
       [ <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">14</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="77" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="77" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在进行矩阵计算时，经常需要用到该操作，比如利用np.dot计算矩阵内积：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">129</span>]: arr = np.random.randn(<span class="hljs-number">6</span>, <span class="hljs-number">3</span>)

In [<span class="hljs-number">130</span>]: arr
Out[<span class="hljs-number">130</span>]: 
array([[<span class="hljs-number">-0.8608</span>,  <span class="hljs-number">0.5601</span>, <span class="hljs-number">-1.2659</span>],
       [ <span class="hljs-number">0.1198</span>, <span class="hljs-number">-1.0635</span>,  <span class="hljs-number">0.3329</span>],
       [<span class="hljs-number">-2.3594</span>, <span class="hljs-number">-0.1995</span>, <span class="hljs-number">-1.542</span> ],
       [<span class="hljs-number">-0.9707</span>, <span class="hljs-number">-1.307</span> ,  <span class="hljs-number">0.2863</span>],
       [ <span class="hljs-number">0.378</span> , <span class="hljs-number">-0.7539</span>,  <span class="hljs-number">0.3313</span>],
       [ <span class="hljs-number">1.3497</span>,  <span class="hljs-number">0.0699</span>,  <span class="hljs-number">0.2467</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="78" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="78" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">131</span>]: np.dot(arr.T, arr)
Out[<span class="hljs-number">131</span>]:
array([[ <span class="hljs-number">9.2291</span>,  <span class="hljs-number">0.9394</span>,  <span class="hljs-number">4.948</span> ],
       [ <span class="hljs-number">0.9394</span>,  <span class="hljs-number">3.7662</span>, <span class="hljs-number">-1.3622</span>],
       [ <span class="hljs-number">4.948</span> , <span class="hljs-number">-1.3622</span>,  <span class="hljs-number">4.3437</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="79" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="79" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于高维数组，transpose需要得到一个由轴编号组成的元组才能对这些轴进行转置（拓展下思维）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">132</span>]: arr = np.arange(<span class="hljs-number">16</span>).reshape((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">133</span>]: arr
Out[<span class="hljs-number">133</span>]: 
array([[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
        [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>]],
       [[ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>],
        [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="80" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="80" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">134</span>]: arr.transpose((<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>))
Out[<span class="hljs-number">134</span>]: 
array([[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
        [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>]],
       [[ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
        [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]]])
</span></span></foreignObject></svg></code></pre>
<p>这里，第一个轴被换成了第二个，第二个轴被换成了第一个，最后一个轴不变。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="81" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="81" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>简单的转置可以使用.T，它其实就是进行轴对换而已。ndarray还有一个swapaxes方法，它需要接受一对轴编号：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="82" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="82" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">135</span>]: arr
Out[<span class="hljs-number">135</span>]: 
array([[[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
        [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>]],
       [[ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>],
        [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]]])
In [<span class="hljs-number">136</span>]: arr.swapaxes(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
Out[<span class="hljs-number">136</span>]: 
array([[[ <span class="hljs-number">0</span>,  <span class="hljs-number">4</span>],
        [ <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>],
        [ <span class="hljs-number">2</span>,  <span class="hljs-number">6</span>],
        [ <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>]],
       [[ <span class="hljs-number">8</span>, <span class="hljs-number">12</span>],
        [ <span class="hljs-number">9</span>, <span class="hljs-number">13</span>],
        [<span class="hljs-number">10</span>, <span class="hljs-number">14</span>],
        [<span class="hljs-number">11</span>, <span class="hljs-number">15</span>]]])
</span></span></foreignObject></svg></code></pre>
<p>swapaxes也是返回源数据的视图（不会进行任何复制操作）。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="83" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="83" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.2 通用函数：快速的元素级数组函数</h2>
<p>通用函数（即ufunc）是一种对ndarray中的数据执行元素级运算的函数。你可以将其看做简单函数（接受一个或多个标量值，并产生一个或多个标量值）的矢量化包装器。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="84" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="84" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>许多ufunc都是简单的元素级变体，如sqrt和exp：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">137</span>]: arr = np.arange(<span class="hljs-number">10</span>)

In [<span class="hljs-number">138</span>]: arr
Out[<span class="hljs-number">138</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])

In [<span class="hljs-number">139</span>]: np.sqrt(arr)
Out[<span class="hljs-number">139</span>]: 
array([ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">1.</span>    ,  <span class="hljs-number">1.4142</span>,  <span class="hljs-number">1.7321</span>,  <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.2361</span>,  <span class="hljs-number">2.4495</span>,
        <span class="hljs-number">2.6458</span>,  <span class="hljs-number">2.8284</span>,  <span class="hljs-number">3.</span>    ])

In [<span class="hljs-number">140</span>]: np.exp(arr)
Out[<span class="hljs-number">140</span>]: 
array([    <span class="hljs-number">1.</span>    ,     <span class="hljs-number">2.7183</span>,     <span class="hljs-number">7.3891</span>,    <span class="hljs-number">20.0855</span>,    <span class="hljs-number">54.5982</span>,
         <span class="hljs-number">148.4132</span>,   <span class="hljs-number">403.4288</span>,  <span class="hljs-number">1096.6332</span>,  <span class="hljs-number">2980.958</span> ,  <span class="hljs-number">8103.0839</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="85" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="85" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这些都是一元（unary）ufunc。另外一些（如add或maximum）接受2个数组（因此也叫二元（binary）ufunc），并返回一个结果数组：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="86" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="86" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">141</span>]: x = np.random.randn(<span class="hljs-number">8</span>)

In [<span class="hljs-number">142</span>]: y = np.random.randn(<span class="hljs-number">8</span>)

In [<span class="hljs-number">143</span>]: x
Out[<span class="hljs-number">143</span>]: 
array([<span class="hljs-number">-0.0119</span>,  <span class="hljs-number">1.0048</span>,  <span class="hljs-number">1.3272</span>, <span class="hljs-number">-0.9193</span>, <span class="hljs-number">-1.5491</span>,  <span class="hljs-number">0.0222</span>,  <span class="hljs-number">0.7584</span>,
       <span class="hljs-number">-0.6605</span>])

In [<span class="hljs-number">144</span>]: y
Out[<span class="hljs-number">144</span>]: 
array([ <span class="hljs-number">0.8626</span>, <span class="hljs-number">-0.01</span>  ,  <span class="hljs-number">0.05</span>  ,  <span class="hljs-number">0.6702</span>,  <span class="hljs-number">0.853</span> , <span class="hljs-number">-0.9559</span>, <span class="hljs-number">-0.0235</span>,
       <span class="hljs-number">-2.3042</span>])

In [<span class="hljs-number">145</span>]: np.maximum(x, y)
Out[<span class="hljs-number">145</span>]: 
array([ <span class="hljs-number">0.8626</span>,  <span class="hljs-number">1.0048</span>,  <span class="hljs-number">1.3272</span>,  <span class="hljs-number">0.6702</span>,  <span class="hljs-number">0.853</span> ,  <span class="hljs-number">0.0222</span>,  <span class="hljs-number">0.7584</span>,   
       <span class="hljs-number">-0.6605</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="87" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="87" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这里，numpy.maximum计算了x和y中元素级别最大的元素。</p>
<p>虽然并不常见，但有些ufunc的确可以返回多个数组。modf就是一个例子，它是Python内置函数divmod的矢量化版本，它会返回浮点数数组的小数和整数部分：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="88" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="88" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">146</span>]: arr = np.random.randn(<span class="hljs-number">7</span>) * <span class="hljs-number">5</span>

In [<span class="hljs-number">147</span>]: arr
Out[<span class="hljs-number">147</span>]: array([<span class="hljs-number">-3.2623</span>, <span class="hljs-number">-6.0915</span>, <span class="hljs-number">-6.663</span> ,  <span class="hljs-number">5.3731</span>,  <span class="hljs-number">3.6182</span>,  <span class="hljs-number">3.45</span>  ,  <span class="hljs-number">5.0077</span>])

In [<span class="hljs-number">148</span>]: remainder, whole_part = np.modf(arr)

In [<span class="hljs-number">149</span>]: remainder
Out[<span class="hljs-number">149</span>]: array([<span class="hljs-number">-0.2623</span>, <span class="hljs-number">-0.0915</span>, <span class="hljs-number">-0.663</span> ,  <span class="hljs-number">0.3731</span>,
<span class="hljs-number">0.6182</span>,  <span class="hljs-number">0.45</span>  ,  <span class="hljs-number">0.0077</span>])

In [<span class="hljs-number">150</span>]: whole_part
Out[<span class="hljs-number">150</span>]: array([<span class="hljs-number">-3.</span>, <span class="hljs-number">-6.</span>, <span class="hljs-number">-6.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">3.</span>,  <span class="hljs-number">5.</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="89" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="89" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通用函数可以接受一个out可选参数，这样就能在数组按位置进行操作：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">151</span>]: arr
Out[<span class="hljs-number">151</span>]: array([<span class="hljs-number">-3.2623</span>, <span class="hljs-number">-6.0915</span>, <span class="hljs-number">-6.663</span> ,  <span class="hljs-number">5.3731</span>,  <span class="hljs-number">3.6182</span>,  <span class="hljs-number">3.45</span>  ,  <span class="hljs-number">5.0077</span>])

In [<span class="hljs-number">152</span>]: np.sqrt(arr)
Out[<span class="hljs-number">152</span>]: array([    nan,     nan,     nan,  <span class="hljs-number">2.318</span> ,  <span class="hljs-number">1.9022</span>,  <span class="hljs-number">1.8574</span>,  <span class="hljs-number">2.2378</span>])

In [<span class="hljs-number">153</span>]: np.sqrt(arr, arr)
Out[<span class="hljs-number">153</span>]: array([    nan,     nan,     nan,  <span class="hljs-number">2.318</span> ,  <span class="hljs-number">1.9022</span>,  <span class="hljs-number">1.8574</span>,  <span class="hljs-number">2.2378</span>])

In [<span class="hljs-number">154</span>]: arr
Out[<span class="hljs-number">154</span>]: array([    nan,     nan,     nan,  <span class="hljs-number">2.318</span> ,  <span class="hljs-number">1.9022</span>,  <span class="hljs-number">1.8574</span>,  <span class="hljs-number">2.2378</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="90" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="90" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表4-3和表4-4分别列出了一些一元和二元通用函数。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-1d494e73b61c7ced.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="91" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="91" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-2be79faf68ab6ff8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-4e38d02a66481530.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="92" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="92" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-eff1e61e5464159f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-236dba83b6a420cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="93" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="93" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.3 利用数组进行数据处理</h2>
<p>NumPy数组使你可以将许多种数据处理任务表述为简洁的数组表达式（否则需要编写循环）。用数组表达式代替循环的做法，通常被称为矢量化。一般来说，矢量化数组运算要比等价的纯Python方式快上一两个数量级（甚至更多），尤其是各种数值计算。在后面内容中（见附录A）我将介绍广播，这是一种针对矢量化计算的强大手段。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="94" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="94" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>作为简单的例子，假设我们想要在一组值（网格型）上计算函数<code>sqrt(x^2+y^2)</code>。np.meshgrid函数接受两个一维数组，并产生两个二维矩阵（对应于两个数组中所有的(x,y)对）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">155</span>]: points = np.arange(<span class="hljs-number">-5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0.01</span>) <span class="hljs-comment"># 1000 equally spaced points</span>

In [<span class="hljs-number">156</span>]: xs, ys = np.meshgrid(points, points)
In [<span class="hljs-number">157</span>]: ys
Out[<span class="hljs-number">157</span>]: 
array([[<span class="hljs-number">-5.</span>  , <span class="hljs-number">-5.</span>  , <span class="hljs-number">-5.</span>  , ..., <span class="hljs-number">-5.</span>  , <span class="hljs-number">-5.</span>  , <span class="hljs-number">-5.</span>  ],
       [<span class="hljs-number">-4.99</span>, <span class="hljs-number">-4.99</span>, <span class="hljs-number">-4.99</span>, ..., <span class="hljs-number">-4.99</span>, <span class="hljs-number">-4.99</span>, <span class="hljs-number">-4.99</span>],
       [<span class="hljs-number">-4.98</span>, <span class="hljs-number">-4.98</span>, <span class="hljs-number">-4.98</span>, ..., <span class="hljs-number">-4.98</span>, <span class="hljs-number">-4.98</span>, <span class="hljs-number">-4.98</span>],
       ..., 
       [ <span class="hljs-number">4.97</span>,  <span class="hljs-number">4.97</span>,  <span class="hljs-number">4.97</span>, ...,  <span class="hljs-number">4.97</span>,  <span class="hljs-number">4.97</span>,  <span class="hljs-number">4.97</span>],
       [ <span class="hljs-number">4.98</span>,  <span class="hljs-number">4.98</span>,  <span class="hljs-number">4.98</span>, ...,  <span class="hljs-number">4.98</span>,  <span class="hljs-number">4.98</span>,  <span class="hljs-number">4.98</span>],
       [ <span class="hljs-number">4.99</span>,  <span class="hljs-number">4.99</span>,  <span class="hljs-number">4.99</span>, ...,  <span class="hljs-number">4.99</span>,  <span class="hljs-number">4.99</span>,  <span class="hljs-number">4.99</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="95" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="95" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>现在，对该函数的求值运算就好办了，把这两个数组当做两个浮点数那样编写表达式即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">158</span>]: z = np.sqrt(xs ** <span class="hljs-number">2</span> + ys ** <span class="hljs-number">2</span>)

In [<span class="hljs-number">159</span>]: z
Out[<span class="hljs-number">159</span>]: 
array([[ <span class="hljs-number">7.0711</span>,  <span class="hljs-number">7.064</span> ,  <span class="hljs-number">7.0569</span>, ...,  <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0569</span>,  <span class="hljs-number">7.064</span> ],
       [ <span class="hljs-number">7.064</span> ,  <span class="hljs-number">7.0569</span>,  <span class="hljs-number">7.0499</span>, ...,  <span class="hljs-number">7.0428</span>,  <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0569</span>],
       [ <span class="hljs-number">7.0569</span>,  <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0428</span>, ...,  <span class="hljs-number">7.0357</span>,  <span class="hljs-number">7.0428</span>, <span class="hljs-number">7.0499</span>],
       ..., 
       [ <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0428</span>,  <span class="hljs-number">7.0357</span>, ...,  <span class="hljs-number">7.0286</span>,  <span class="hljs-number">7.0357</span>,  <span class="hljs-number">7.0428</span>],
       [ <span class="hljs-number">7.0569</span>,  <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0428</span>, ...,  <span class="hljs-number">7.0357</span>,  <span class="hljs-number">7.0428</span>,  <span class="hljs-number">7.0499</span>],
       [ <span class="hljs-number">7.064</span> ,  <span class="hljs-number">7.0569</span>,  <span class="hljs-number">7.0499</span>, ...,  <span class="hljs-number">7.0428</span>,  <span class="hljs-number">7.0499</span>,  <span class="hljs-number">7.0569</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="96" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="96" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>作为第9章的先导，我用matplotlib创建了这个二维数组的可视化：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">160</span>]: <span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

In [<span class="hljs-number">161</span>]: plt.imshow(z, cmap=plt.cm.gray); plt.colorbar()
Out[<span class="hljs-number">161</span>]: &lt;matplotlib.colorbar.Colorbar at <span class="hljs-number">0x7f715e3fa630</span>&gt;

In [<span class="hljs-number">162</span>]: plt.title(<span class="hljs-string">&quot;Image plot of $\sqrt{x^2 + y^2}$ for a grid of values&quot;</span>)
Out[<span class="hljs-number">162</span>]: &lt;matplotlib.text.Text at <span class="hljs-number">0x7f715d2de748</span>&gt;
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="97" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="97" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>见图4-3。这张图是用matplotlib的imshow函数创建的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-3b22000d4cd38650.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图4-3 根据网格对函数求值的结果 w:600" style="width:600px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="98" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="98" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.3.1 将条件逻辑表述为数组运算</h3>
<p>numpy.where函数是三元表达式x if condition else y的矢量化版本。假设我们有一个布尔数组和两个值数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">165</span>]: xarr = np.array([<span class="hljs-number">1.1</span>, <span class="hljs-number">1.2</span>, <span class="hljs-number">1.3</span>, <span class="hljs-number">1.4</span>, <span class="hljs-number">1.5</span>])

In [<span class="hljs-number">166</span>]: yarr = np.array([<span class="hljs-number">2.1</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">2.3</span>, <span class="hljs-number">2.4</span>, <span class="hljs-number">2.5</span>])

In [<span class="hljs-number">167</span>]: cond = np.array([<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>])
</span></span></foreignObject></svg></code></pre>
<p>假设我们想要根据cond中的值选取xarr和yarr的值：当cond中的值为True时，选取xarr的值，否则从yarr中选取。列表推导式的写法应该如下所示：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="99" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="99" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">168</span>]: result = [(x <span class="hljs-keyword">if</span> c <span class="hljs-keyword">else</span> y)
   .....:           <span class="hljs-keyword">for</span> x, y, c <span class="hljs-keyword">in</span> zip(xarr, yarr, cond)]

In [<span class="hljs-number">169</span>]: result
Out[<span class="hljs-number">169</span>]: [<span class="hljs-number">1.1000000000000001</span>, <span class="hljs-number">2.2000000000000002</span>, <span class="hljs-number">1.3</span>, <span class="hljs-number">1.3999999999999999</span>, <span class="hljs-number">2.5</span>]
</span></span></foreignObject></svg></code></pre>
<p>这有几个问题。第一，它对大数组的处理速度不是很快（因为所有工作都是由纯Python完成的）。第二，无法用于多维数组。若使用np.where，则可以将该功能写得非常简洁：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">170</span>]: result = np.where(cond, xarr, yarr)

In [<span class="hljs-number">171</span>]: result
Out[<span class="hljs-number">171</span>]: array([ <span class="hljs-number">1.1</span>,  <span class="hljs-number">2.2</span>,  <span class="hljs-number">1.3</span>,  <span class="hljs-number">1.4</span>,  <span class="hljs-number">2.5</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="100" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="100" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>np.where的第二个和第三个参数不必是数组，它们都可以是标量值。在数据分析工作中，where通常用于根据另一个数组而产生一个新的数组。假设有一个由随机数据组成的矩阵，你希望将所有正值替换为2，将所有负值替换为－2。若利用np.where，则会非常简单：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">172</span>]: arr = np.random.randn(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>)

In [<span class="hljs-number">173</span>]: arr
Out[<span class="hljs-number">173</span>]: 
array([[<span class="hljs-number">-0.5031</span>, <span class="hljs-number">-0.6223</span>, <span class="hljs-number">-0.9212</span>, <span class="hljs-number">-0.7262</span>],
       [ <span class="hljs-number">0.2229</span>,  <span class="hljs-number">0.0513</span>, <span class="hljs-number">-1.1577</span>,  <span class="hljs-number">0.8167</span>],
       [ <span class="hljs-number">0.4336</span>,  <span class="hljs-number">1.0107</span>,  <span class="hljs-number">1.8249</span>, <span class="hljs-number">-0.9975</span>],
       [ <span class="hljs-number">0.8506</span>, <span class="hljs-number">-0.1316</span>,  <span class="hljs-number">0.9124</span>,  <span class="hljs-number">0.1882</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="101" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="101" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">174</span>]: arr &gt; <span class="hljs-number">0</span>
Out[<span class="hljs-number">174</span>]: 
array([[<span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>],
       [ <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>],
       [ <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>],
       [ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>]], dtype=bool)

In [<span class="hljs-number">175</span>]: np.where(arr &gt; <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">-2</span>)
Out[<span class="hljs-number">175</span>]: 
array([[<span class="hljs-number">-2</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-2</span>],
       [ <span class="hljs-number">2</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">-2</span>,  <span class="hljs-number">2</span>],
       [ <span class="hljs-number">2</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">-2</span>],
       [ <span class="hljs-number">2</span>, <span class="hljs-number">-2</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">2</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="102" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="102" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>使用np.where，可以将标量和数组结合起来。例如，我可用常数2替换arr中所有正的值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">176</span>]: np.where(arr &gt; <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, arr) <span class="hljs-comment"># set only positive values to 2</span>
Out[<span class="hljs-number">176</span>]: 
array([[<span class="hljs-number">-0.5031</span>, <span class="hljs-number">-0.6223</span>, <span class="hljs-number">-0.9212</span>, <span class="hljs-number">-0.7262</span>],
       [ <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.</span>    , <span class="hljs-number">-1.1577</span>,  <span class="hljs-number">2.</span>    ],
       [ <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.</span>    , <span class="hljs-number">-0.9975</span>],
       [ <span class="hljs-number">2.</span>    , <span class="hljs-number">-0.1316</span>,  <span class="hljs-number">2.</span>    ,  <span class="hljs-number">2.</span>    ]])
</span></span></foreignObject></svg></code></pre>
<p>传递给where的数组大小可以不相等，甚至可以是标量值。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="103" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="103" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.3.2 数学和统计方法</h3>
<p>可以通过数组上的一组数学函数对整个数组或某个轴向的数据进行统计计算。sum、mean以及标准差std等聚合计算（aggregation，通常叫做约简（reduction））既可以当做数组的实例方法调用，也可以当做顶级NumPy函数使用。</p>
<p>这里，我生成了一些正态分布随机数据，然后做了聚类统计：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="104" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="104" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">177</span>]: arr = np.random.randn(<span class="hljs-number">5</span>, <span class="hljs-number">4</span>)

In [<span class="hljs-number">178</span>]: arr
Out[<span class="hljs-number">178</span>]: 
array([[ <span class="hljs-number">2.1695</span>, <span class="hljs-number">-0.1149</span>,  <span class="hljs-number">2.0037</span>,  <span class="hljs-number">0.0296</span>],
       [ <span class="hljs-number">0.7953</span>,  <span class="hljs-number">0.1181</span>, <span class="hljs-number">-0.7485</span>,  <span class="hljs-number">0.585</span> ],
       [ <span class="hljs-number">0.1527</span>, <span class="hljs-number">-1.5657</span>, <span class="hljs-number">-0.5625</span>, <span class="hljs-number">-0.0327</span>],
       [<span class="hljs-number">-0.929</span> , <span class="hljs-number">-0.4826</span>, <span class="hljs-number">-0.0363</span>,  <span class="hljs-number">1.0954</span>],
       [ <span class="hljs-number">0.9809</span>, <span class="hljs-number">-0.5895</span>,  <span class="hljs-number">1.5817</span>, <span class="hljs-number">-0.5287</span>]])

In [<span class="hljs-number">179</span>]: arr.mean()
Out[<span class="hljs-number">179</span>]: <span class="hljs-number">0.19607051119998253</span>

In [<span class="hljs-number">180</span>]: np.mean(arr)
Out[<span class="hljs-number">180</span>]: <span class="hljs-number">0.19607051119998253</span>

In [<span class="hljs-number">181</span>]: arr.sum()
Out[<span class="hljs-number">181</span>]: <span class="hljs-number">3.9214102239996507</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="105" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="105" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>mean和sum这类的函数可以接受一个axis选项参数，用于计算该轴向上的统计值，最终结果是一个少一维的数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">182</span>]: arr.mean(axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">182</span>]: array([ <span class="hljs-number">1.022</span> ,  <span class="hljs-number">0.1875</span>, <span class="hljs-number">-0.502</span> , <span class="hljs-number">-0.0881</span>,  <span class="hljs-number">0.3611</span>])

In [<span class="hljs-number">183</span>]: arr.sum(axis=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">183</span>]: array([ <span class="hljs-number">3.1693</span>, <span class="hljs-number">-2.6345</span>,  <span class="hljs-number">2.2381</span>,  <span class="hljs-number">1.1486</span>])
</span></span></foreignObject></svg></code></pre>
<p>这里，arr.mean(1)是“计算行的平均值”，arr.sum(0)是“计算每列的和”。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="106" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="106" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>其他如cumsum和cumprod之类的方法则不聚合，而是产生一个由中间结果组成的数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">184</span>]: arr = np.array([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>])

In [<span class="hljs-number">185</span>]: arr.cumsum()
Out[<span class="hljs-number">185</span>]: array([ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">21</span>, <span class="hljs-number">28</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="107" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="107" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在多维数组中，累加函数（如cumsum）返回的是同样大小的数组，但是会根据每个低维的切片沿着标记轴计算部分聚类：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="108" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="108" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">186</span>]: arr = np.array([[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]])

In [<span class="hljs-number">187</span>]: arr
Out[<span class="hljs-number">187</span>]: 
array([[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
       [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],
       [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]])

In [<span class="hljs-number">188</span>]: arr.cumsum(axis=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">188</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>],
       [ <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">7</span>],
       [ <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>]])

In [<span class="hljs-number">189</span>]: arr.cumprod(axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">189</span>]: 
array([[  <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>],
       [  <span class="hljs-number">3</span>,  <span class="hljs-number">12</span>,  <span class="hljs-number">60</span>],
       [  <span class="hljs-number">6</span>,  <span class="hljs-number">42</span>, <span class="hljs-number">336</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="109" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="109" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表4-5列出了全部的基本数组统计方法。后续章节中有很多例子都会用到这些方法。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-a6c6df3ca8e0b98e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="110" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="110" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-866fcde885b1d357.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="111" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="111" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.3.3 用于布尔型数组的方法</h3>
<p>在上面这些方法中，布尔值会被强制转换为1（True）和0（False）。因此，sum经常被用来对布尔型数组中的True值计数：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">190</span>]: arr = np.random.randn(<span class="hljs-number">100</span>)

In [<span class="hljs-number">191</span>]: (arr &gt; <span class="hljs-number">0</span>).sum() <span class="hljs-comment"># Number of positive values</span>
Out[<span class="hljs-number">191</span>]: <span class="hljs-number">42</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="112" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="112" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另外还有两个方法any和all，它们对布尔型数组非常有用。any用于测试数组中是否存在一个或多个True，而all则检查数组中所有值是否都是True：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">192</span>]: bools = np.array([<span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>])

In [<span class="hljs-number">193</span>]: bools.any()
Out[<span class="hljs-number">193</span>]: <span class="hljs-literal">True</span>

In [<span class="hljs-number">194</span>]: bools.all()
Out[<span class="hljs-number">194</span>]: <span class="hljs-literal">False</span>
</span></span></foreignObject></svg></code></pre>
<p>这两个方法也能用于非布尔型数组，所有非0元素将会被当做True。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="113" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="113" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.3.4 排序</h3>
<p>跟Python内置的列表类型一样，NumPy数组也可以通过sort方法就地排序：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">195</span>]: arr = np.random.randn(<span class="hljs-number">6</span>)

In [<span class="hljs-number">196</span>]: arr
Out[<span class="hljs-number">196</span>]: array([ <span class="hljs-number">0.6095</span>, <span class="hljs-number">-0.4938</span>,  <span class="hljs-number">1.24</span>  , <span class="hljs-number">-0.1357</span>,  <span class="hljs-number">1.43</span>  , <span class="hljs-number">-0.8469</span>])

In [<span class="hljs-number">197</span>]: arr.sort()

In [<span class="hljs-number">198</span>]: arr
Out[<span class="hljs-number">198</span>]: array([<span class="hljs-number">-0.8469</span>, <span class="hljs-number">-0.4938</span>, <span class="hljs-number">-0.1357</span>,  <span class="hljs-number">0.6095</span>,  <span class="hljs-number">1.24</span>  ,  <span class="hljs-number">1.43</span>  ])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="114" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="114" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>多维数组可以在任何一个轴向上进行排序，只需将轴编号传给sort即可：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="115" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="115" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">199</span>]: arr = np.random.randn(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)

In [<span class="hljs-number">200</span>]: arr
Out[<span class="hljs-number">200</span>]: 
array([[ <span class="hljs-number">0.6033</span>,  <span class="hljs-number">1.2636</span>, <span class="hljs-number">-0.2555</span>],
       [<span class="hljs-number">-0.4457</span>,  <span class="hljs-number">0.4684</span>, <span class="hljs-number">-0.9616</span>],
       [<span class="hljs-number">-1.8245</span>,  <span class="hljs-number">0.6254</span>,  <span class="hljs-number">1.0229</span>],
       [ <span class="hljs-number">1.1074</span>,  <span class="hljs-number">0.0909</span>, <span class="hljs-number">-0.3501</span>],
       [ <span class="hljs-number">0.218</span> , <span class="hljs-number">-0.8948</span>, <span class="hljs-number">-1.7415</span>]])

In [<span class="hljs-number">201</span>]: arr.sort(<span class="hljs-number">1</span>)

In [<span class="hljs-number">202</span>]: arr
Out[<span class="hljs-number">202</span>]: 
array([[<span class="hljs-number">-0.2555</span>,  <span class="hljs-number">0.6033</span>,  <span class="hljs-number">1.2636</span>],
       [<span class="hljs-number">-0.9616</span>, <span class="hljs-number">-0.4457</span>,  <span class="hljs-number">0.4684</span>],
       [<span class="hljs-number">-1.8245</span>,  <span class="hljs-number">0.6254</span>,  <span class="hljs-number">1.0229</span>],
       [<span class="hljs-number">-0.3501</span>,  <span class="hljs-number">0.0909</span>,  <span class="hljs-number">1.1074</span>],
       [<span class="hljs-number">-1.7415</span>, <span class="hljs-number">-0.8948</span>,  <span class="hljs-number">0.218</span> ]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="116" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="116" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>顶级方法np.sort返回的是数组的已排序副本，而就地排序则会修改数组本身。计算数组分位数最简单的办法是对其进行排序，然后选取特定位置的值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">203</span>]: large_arr = np.random.randn(<span class="hljs-number">1000</span>)

In [<span class="hljs-number">204</span>]: large_arr.sort()

In [<span class="hljs-number">205</span>]: large_arr[int(<span class="hljs-number">0.05</span> * len(large_arr))] <span class="hljs-comment"># 5% quantile</span>
Out[<span class="hljs-number">205</span>]: <span class="hljs-number">-1.5311513550102103</span>
</span></span></foreignObject></svg></code></pre>
<p>更多关于NumPy排序方法以及诸如间接排序之类的高级技术，请参阅附录A。在pandas中还可以找到一些其他跟排序有关的数据操作（比如根据一列或多列对表格型数据进行排序）。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="117" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="117" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.3.5 唯一化以及其它的集合逻辑</h3>
<p>NumPy提供了一些针对一维ndarray的基本集合运算。最常用的可能要数np.unique了，它用于找出数组中的唯一值并返回已排序的结果：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">206</span>]: names = np.array([<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>])

In [<span class="hljs-number">207</span>]: np.unique(names)
Out[<span class="hljs-number">207</span>]: 
array([<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>],
      dtype=<span class="hljs-string">&#x27;&lt;U4&#x27;</span>)

In [<span class="hljs-number">208</span>]: ints = np.array([<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>])

In [<span class="hljs-number">209</span>]: np.unique(ints)
Out[<span class="hljs-number">209</span>]: array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="118" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="118" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>拿跟np.unique等价的纯Python代码来对比一下：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">210</span>]: sorted(set(names))
Out[<span class="hljs-number">210</span>]: [<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Joe&#x27;</span>, <span class="hljs-string">&#x27;Will&#x27;</span>]
</span></span></foreignObject></svg></code></pre>
<p>另一个函数np.in1d用于测试一个数组中的值在另一个数组中的成员资格，返回一个布尔型数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">211</span>]: values = np.array([<span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])

In [<span class="hljs-number">212</span>]: np.in1d(values, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>])
Out[<span class="hljs-number">212</span>]: array([ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>], dtype=bool)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="119" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="119" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>NumPy中的集合函数请参见表4-6。<br />
<img src="http://upload-images.jianshu.io/upload_images/7178691-80e85ae6b9c89ada.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="120" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="120" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.4 用于数组的文件输入输出</h2>
<p>NumPy能够读写磁盘上的文本数据或二进制数据。这一小节只讨论NumPy的内置二进制格式，因为更多的用户会使用pandas或其它工具加载文本或表格数据（见第6章）。</p>
<p>np.save和np.load是读写磁盘数组数据的两个主要函数。默认情况下，数组是以未压缩的原始二进制格式保存在扩展名为.npy的文件中的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">213</span>]: arr = np.arange(<span class="hljs-number">10</span>)

In [<span class="hljs-number">214</span>]: np.save(<span class="hljs-string">&#x27;some_array&#x27;</span>, arr)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="121" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="121" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果文件路径末尾没有扩展名.npy，则该扩展名会被自动加上。然后就可以通过np.load读取磁盘上的数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">215</span>]: np.load(<span class="hljs-string">&#x27;some_array.npy&#x27;</span>)
Out[<span class="hljs-number">215</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<p>通过np.savez可以将多个数组保存到一个未压缩文件中，将数组以关键字参数的形式传入即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">216</span>]: np.savez(<span class="hljs-string">&#x27;array_archive.npz&#x27;</span>, a=arr, b=arr)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="122" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="122" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>加载.npz文件时，你会得到一个类似字典的对象，该对象会对各个数组进行延迟加载：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">217</span>]: arch = np.load(<span class="hljs-string">&#x27;array_archive.npz&#x27;</span>)

In [<span class="hljs-number">218</span>]: arch[<span class="hljs-string">&#x27;b&#x27;</span>]
Out[<span class="hljs-number">218</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])
</span></span></foreignObject></svg></code></pre>
<p>如果要将数据压缩，可以使用numpy.savez_compressed：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">219</span>]: np.savez_compressed(<span class="hljs-string">&#x27;arrays_compressed.npz&#x27;</span>, a=arr, b=arr)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="123" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="123" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.5 线性代数</h2>
<p>线性代数（如矩阵乘法、矩阵分解、行列式以及其他方阵数学等）是任何数组库的重要组成部分。不像某些语言（如MATLAB），通过*对两个二维数组相乘得到的是一个元素级的积，而不是一个矩阵点积。因此，NumPy提供了一个用于矩阵乘法的dot函数（既是一个数组方法也是numpy命名空间中的一个函数）：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="124" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="124" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">223</span>]: x = np.array([[<span class="hljs-number">1.</span>, <span class="hljs-number">2.</span>, <span class="hljs-number">3.</span>], [<span class="hljs-number">4.</span>, <span class="hljs-number">5.</span>, <span class="hljs-number">6.</span>]])

In [<span class="hljs-number">224</span>]: y = np.array([[<span class="hljs-number">6.</span>, <span class="hljs-number">23.</span>], [<span class="hljs-number">-1</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">9</span>]])

In [<span class="hljs-number">225</span>]: x
Out[<span class="hljs-number">225</span>]: 
array([[ <span class="hljs-number">1.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">3.</span>],
       [ <span class="hljs-number">4.</span>,  <span class="hljs-number">5.</span>,  <span class="hljs-number">6.</span>]])

In [<span class="hljs-number">226</span>]: y
Out[<span class="hljs-number">226</span>]: 
array([[  <span class="hljs-number">6.</span>,  <span class="hljs-number">23.</span>],
       [ <span class="hljs-number">-1.</span>,   <span class="hljs-number">7.</span>],
       [  <span class="hljs-number">8.</span>,   <span class="hljs-number">9.</span>]])

In [<span class="hljs-number">227</span>]: x.dot(y)
Out[<span class="hljs-number">227</span>]: 
array([[  <span class="hljs-number">28.</span>,   <span class="hljs-number">64.</span>],
       [  <span class="hljs-number">67.</span>,  <span class="hljs-number">181.</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="125" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="125" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>x.dot(y)等价于np.dot(x, y)：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">228</span>]: np.dot(x, y)
Out[<span class="hljs-number">228</span>]: 
array([[  <span class="hljs-number">28.</span>,   <span class="hljs-number">64.</span>],
       [  <span class="hljs-number">67.</span>,  <span class="hljs-number">181.</span>]])
</span></span></foreignObject></svg></code></pre>
<p>一个二维数组跟一个大小合适的一维数组的矩阵点积运算之后将会得到一个一维数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">229</span>]: np.dot(x, np.ones(<span class="hljs-number">3</span>))
Out[<span class="hljs-number">229</span>]: array([  <span class="hljs-number">6.</span>,  <span class="hljs-number">15.</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="126" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="126" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>@符（类似Python 3.5）也可以用作中缀运算符，进行矩阵乘法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">230</span>]: x @ np.ones(<span class="hljs-number">3</span>)
Out[<span class="hljs-number">230</span>]: array([  <span class="hljs-number">6.</span>,  <span class="hljs-number">15.</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="127" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="127" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>numpy.linalg中有一组标准的矩阵分解运算以及诸如求逆和行列式之类的东西。它们跟MATLAB和R等语言所使用的是相同的行业标准线性代数库，如BLAS、LAPACK、Intel MKL（Math Kernel Library，可能有，取决于你的NumPy版本）等：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="128" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="128" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">231</span>]: <span class="hljs-keyword">from</span> numpy.linalg <span class="hljs-keyword">import</span> inv, qr

In [<span class="hljs-number">232</span>]: X = np.random.randn(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)

In [<span class="hljs-number">233</span>]: mat = X.T.dot(X) <span class="hljs-comment"># 表达式X.T.dot(X)计算X和它的转置X.T的点积。</span>

In [<span class="hljs-number">234</span>]: inv(mat)
Out[<span class="hljs-number">234</span>]: 
array([[  <span class="hljs-number">933.1189</span>,   <span class="hljs-number">871.8258</span>, <span class="hljs-number">-1417.6902</span>, <span class="hljs-number">-1460.4005</span>,  <span class="hljs-number">1782.1391</span>],
       [  <span class="hljs-number">871.8258</span>,   <span class="hljs-number">815.3929</span>, <span class="hljs-number">-1325.9965</span>, <span class="hljs-number">-1365.9242</span>,  <span class="hljs-number">1666.9347</span>],
       [<span class="hljs-number">-1417.6902</span>, <span class="hljs-number">-1325.9965</span>,  <span class="hljs-number">2158.4424</span>,  <span class="hljs-number">2222.0191</span>, <span class="hljs-number">-2711.6822</span>],
       [<span class="hljs-number">-1460.4005</span>, <span class="hljs-number">-1365.9242</span>,  <span class="hljs-number">2222.0191</span>,  <span class="hljs-number">2289.0575</span>, <span class="hljs-number">-2793.422</span> ],
       [ <span class="hljs-number">1782.1391</span>,  <span class="hljs-number">1666.9347</span>, <span class="hljs-number">-2711.6822</span>, <span class="hljs-number">-2793.422</span> ,  <span class="hljs-number">3409.5128</span>]])

In [<span class="hljs-number">235</span>]: mat.dot(inv(mat))
Out[<span class="hljs-number">235</span>]: 
array([[ <span class="hljs-number">1.</span>,  <span class="hljs-number">0.</span>, <span class="hljs-number">-0.</span>, <span class="hljs-number">-0.</span>, <span class="hljs-number">-0.</span>],
       [<span class="hljs-number">-0.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [<span class="hljs-number">-0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">1.</span>, <span class="hljs-number">-0.</span>],
       [<span class="hljs-number">-0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">1.</span>]])

In [<span class="hljs-number">236</span>]: q, r = qr(mat)

In [<span class="hljs-number">237</span>]: r
Out[<span class="hljs-number">237</span>]: 
array([[<span class="hljs-number">-1.6914</span>,  <span class="hljs-number">4.38</span>  ,  <span class="hljs-number">0.1757</span>,  <span class="hljs-number">0.4075</span>, <span class="hljs-number">-0.7838</span>],
       [ <span class="hljs-number">0.</span>    , <span class="hljs-number">-2.6436</span>,  <span class="hljs-number">0.1939</span>, <span class="hljs-number">-3.072</span> , <span class="hljs-number">-1.0702</span>],
       [ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    , <span class="hljs-number">-0.8138</span>,  <span class="hljs-number">1.5414</span>,  <span class="hljs-number">0.6155</span>],
       [ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    , <span class="hljs-number">-2.6445</span>, <span class="hljs-number">-2.1669</span>],
       [ <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.</span>    ,  <span class="hljs-number">0.0002</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="129" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="129" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表4-7中列出了一些最常用的线性代数函数。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-dcdb66e49e5f70ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:700" style="width:700px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="130" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="130" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.6 伪随机数生成</h2>
<p>numpy.random模块对Python内置的random进行了补充，增加了一些用于高效生成多种概率分布的样本值的函数。例如，你可以用normal来得到一个标准正态分布的4×4样本数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">238</span>]: samples = np.random.normal(size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">239</span>]: samples
Out[<span class="hljs-number">239</span>]: 
array([[ <span class="hljs-number">0.5732</span>,  <span class="hljs-number">0.1933</span>,  <span class="hljs-number">0.4429</span>,  <span class="hljs-number">1.2796</span>],
       [ <span class="hljs-number">0.575</span> ,  <span class="hljs-number">0.4339</span>, <span class="hljs-number">-0.7658</span>, <span class="hljs-number">-1.237</span> ],
       [<span class="hljs-number">-0.5367</span>,  <span class="hljs-number">1.8545</span>, <span class="hljs-number">-0.92</span>  , <span class="hljs-number">-0.1082</span>],
       [ <span class="hljs-number">0.1525</span>,  <span class="hljs-number">0.9435</span>, <span class="hljs-number">-1.0953</span>, <span class="hljs-number">-0.144</span> ]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="131" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="131" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>而Python内置的random模块则只能一次生成一个样本值。从下面的测试结果中可以看出，如果需要产生大量样本值，numpy.random快了不止一个数量级：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">240</span>]: <span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> normalvariate

In [<span class="hljs-number">241</span>]: N = <span class="hljs-number">1000000</span>

In [<span class="hljs-number">242</span>]: %timeit samples = [normalvariate(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(N)]
<span class="hljs-number">1.77</span> s +- <span class="hljs-number">126</span> ms per loop (mean +- std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)

In [<span class="hljs-number">243</span>]: %timeit np.random.normal(size=N)
<span class="hljs-number">61.7</span> ms +- <span class="hljs-number">1.32</span> ms per loop (mean +- std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10</span> loops each)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="132" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="132" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>我们说这些都是伪随机数，是因为它们都是通过算法基于随机数生成器种子，在确定性的条件下生成的。你可以用NumPy的np.random.seed更改随机数生成种子：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">244</span>]: np.random.seed(<span class="hljs-number">1234</span>)
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="133" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="133" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>numpy.random的数据生成函数使用了全局的随机种子。要避免全局状态，你可以使用numpy.random.RandomState，创建一个与其它隔离的随机数生成器：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">245</span>]: rng = np.random.RandomState(<span class="hljs-number">1234</span>)

In [<span class="hljs-number">246</span>]: rng.randn(<span class="hljs-number">10</span>)
Out[<span class="hljs-number">246</span>]: 
array([ <span class="hljs-number">0.4714</span>, <span class="hljs-number">-1.191</span> ,  <span class="hljs-number">1.4327</span>, <span class="hljs-number">-0.3127</span>, <span class="hljs-number">-0.7206</span>,  <span class="hljs-number">0.8872</span>,  <span class="hljs-number">0.8596</span>,
       <span class="hljs-number">-0.6365</span>,  <span class="hljs-number">0.0157</span>, <span class="hljs-number">-2.2427</span>])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="134" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="134" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表4-8列出了numpy.random中的部分函数。在下一节中，我将给出一些利用这些函数一次性生成大量样本值的范例。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-97ba09c96dab93a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="135" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="135" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-6ed04fae3d1178e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="136" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="136" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.7 示例：随机漫步</h2>
<p>我们通过模拟随机漫步来说明如何运用数组运算。先来看一个简单的随机漫步的例子：从0开始，步长1和－1出现的概率相等。</p>
<p>下面是一个通过内置的random模块以纯Python的方式实现1000步的随机漫步：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="137" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="137" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">247</span>]: <span class="hljs-keyword">import</span> random
   .....: position = <span class="hljs-number">0</span>
   .....: walk = [position]
   .....: steps = <span class="hljs-number">1000</span>
   .....: <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(steps):
   .....:     step = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">-1</span>
   .....:     position += step
   .....:     walk.append(position)
   .....:
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="138" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="138" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>图4-4是根据前100个随机漫步值生成的折线图：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">249</span>]: plt.plot(walk[:<span class="hljs-number">100</span>])
</span></span></foreignObject></svg></code></pre>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-0833621694f6dda0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图4-4 简单的随机漫步 w:600" style="width:600px;" /></p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="139" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="139" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>不难看出，这其实就是随机漫步中各步的累计和，可以用一个数组运算来实现。因此，我用np.random模块一次性随机产生1000个“掷硬币”结果（即两个数中任选一个），将其分别设置为1或－1，然后计算累计和：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">251</span>]: nsteps = <span class="hljs-number">1000</span>

In [<span class="hljs-number">252</span>]: draws = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, size=nsteps)

In [<span class="hljs-number">253</span>]: steps = np.where(draws &gt; <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>)

In [<span class="hljs-number">254</span>]: walk = steps.cumsum()
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="140" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="140" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>有了这些数据之后，我们就可以沿着漫步路径做一些统计工作了，比如求取最大值和最小值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">255</span>]: walk.min()
Out[<span class="hljs-number">255</span>]: <span class="hljs-number">-3</span>

In [<span class="hljs-number">256</span>]: walk.max()
Out[<span class="hljs-number">256</span>]: <span class="hljs-number">31</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="141" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="141" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>现在来看一个复杂点的统计任务——首次穿越时间，即随机漫步过程中第一次到达某个特定值的时间。假设我们想要知道本次随机漫步需要多久才能距离初始0点至少10步远（任一方向均可）。<code>np.abs(walk)&gt;=10</code>可以得到一个布尔型数组，它表示的是距离是否达到或超过10，而我们想要知道的是第一个10或－10的索引。可以用argmax来解决这个问题，它返回的是该布尔型数组第一个最大值的索引（True就是最大值）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">257</span>]: (np.abs(walk) &gt;= <span class="hljs-number">10</span>).argmax()
Out[<span class="hljs-number">257</span>]: <span class="hljs-number">37</span>
</span></span></foreignObject></svg></code></pre>
<p>注意，这里使用argmax并不是很高效，因为它无论如何都会对数组进行完全扫描。在本例中，只要发现了一个True，那我们就知道它是个最大值了。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="142" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="142" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>4.7.1 一次模拟多个随机漫步</h3>
<p>如果你希望模拟多个随机漫步过程（比如5000个），只需对上面的代码做一点点修改即可生成所有的随机漫步过程。只要给numpy.random的函<br />
数传入一个二元元组就可以产生一个二维数组，然后我们就可以一次性计算5000个随机漫步过程（一行一个）的累计和了：</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="143" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="143" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">258</span>]: nwalks = <span class="hljs-number">5000</span>

In [<span class="hljs-number">259</span>]: nsteps = <span class="hljs-number">1000</span>

In [<span class="hljs-number">260</span>]: draws = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, size=(nwalks, nsteps)) <span class="hljs-comment"># 0 or 1</span>

In [<span class="hljs-number">261</span>]: steps = np.where(draws &gt; <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>)

In [<span class="hljs-number">262</span>]: walks = steps.cumsum(<span class="hljs-number">1</span>)

In [<span class="hljs-number">263</span>]: walks
Out[<span class="hljs-number">263</span>]: 
array([[  <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">1</span>, ...,   <span class="hljs-number">8</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">8</span>],
       [  <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,  <span class="hljs-number">-1</span>, ...,  <span class="hljs-number">34</span>,  <span class="hljs-number">33</span>,  <span class="hljs-number">32</span>],
       [  <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,  <span class="hljs-number">-1</span>, ...,   <span class="hljs-number">4</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">4</span>],
       ..., 
       [  <span class="hljs-number">1</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">1</span>, ...,  <span class="hljs-number">24</span>,  <span class="hljs-number">25</span>,  <span class="hljs-number">26</span>],
       [  <span class="hljs-number">1</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">3</span>, ...,  <span class="hljs-number">14</span>,  <span class="hljs-number">13</span>,  <span class="hljs-number">14</span>],
       [ <span class="hljs-number">-1</span>,  <span class="hljs-number">-2</span>,  <span class="hljs-number">-3</span>, ..., <span class="hljs-number">-24</span>, <span class="hljs-number">-23</span>, <span class="hljs-number">-22</span>]])
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="144" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="144" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>现在，我们来计算所有随机漫步过程的最大值和最小值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">264</span>]: walks.max()
Out[<span class="hljs-number">264</span>]: <span class="hljs-number">138</span>

In [<span class="hljs-number">265</span>]: walks.min()
Out[<span class="hljs-number">265</span>]: <span class="hljs-number">-133</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="145" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="145" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>得到这些数据之后，我们来计算30或－30的最小穿越时间。这里稍微复杂些，因为不是5000个过程都到达了30。我们可以用any方法来对此进行检查：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">266</span>]: hits30 = (np.abs(walks) &gt;= <span class="hljs-number">30</span>).any(<span class="hljs-number">1</span>)

In [<span class="hljs-number">267</span>]: hits30
Out[<span class="hljs-number">267</span>]: array([<span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, ..., <span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>], dtype=bool)

In [<span class="hljs-number">268</span>]: hits30.sum() <span class="hljs-comment"># Number that hit 30 or -30</span>
Out[<span class="hljs-number">268</span>]: <span class="hljs-number">3410</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="146" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="146" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>然后我们利用这个布尔型数组选出那些穿越了30（绝对值）的随机漫步（行），并调用argmax在轴1上获取穿越时间：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">269</span>]: crossing_times = (np.abs(walks[hits30]) &gt;= <span class="hljs-number">30</span>).argmax(<span class="hljs-number">1</span>)

In [<span class="hljs-number">270</span>]: crossing_times.mean()
Out[<span class="hljs-number">270</span>]: <span class="hljs-number">498.88973607038122</span>
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="147" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="147" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>请尝试用其他分布方式得到漫步数据。只需使用不同的随机数生成函数即可，如normal用于生成指定均值和标准差的正态分布数据：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">271</span>]: steps = np.random.normal(loc=<span class="hljs-number">0</span>, scale=<span class="hljs-number">0.25</span>,
   .....:                          size=(nwalks, nsteps))
</span></span></foreignObject></svg></code></pre>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="148" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-footer="林肯叔叔 @ www.shujudaka.com" data-theme="gaia" data-marpit-pagination="148" data-marpit-pagination-total="148" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--footer:林肯叔叔 @ www.shujudaka.com;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>4.8 结论</h2>
<p>虽然本书剩下的章节大部分是用pandas规整数据，我们还是会用到相似的基于数组的计算。在附录A中，我们会深入挖掘NumPy的特点，进一步学习数组的技巧。</p>
<footer>林肯叔叔 @ <a href="http://www.shujudaka.com">www.shujudaka.com</a></footer>
</section>
<script>!function(){"use strict";const t="marpitSVGPolyfill:setZoomFactor,",e=Symbol();let o,r;function n(n){const i="object"==typeof n&&n.target||document,a="object"==typeof n?n.zoom:n;window[e]||(Object.defineProperty(window,e,{configurable:!0,value:!0}),window.addEventListener("message",({data:e,origin:o})=>{if(o===window.origin)try{if(e&&"string"==typeof e&&e.startsWith(t)){const[,t]=e.split(","),o=Number.parseFloat(t);Number.isNaN(o)||(r=o)}}catch(t){console.error(t)}}));let l=!1;Array.from(i.querySelectorAll("svg[data-marpit-svg]"),t=>{var e,n,i,s;t.style.transform||(t.style.transform="translateZ(0)");const c=a||r||t.currentScale||1;o!==c&&(o=c,l=c);const d=t.getBoundingClientRect(),{length:u}=t.children;for(let o=0;o<u;o+=1){const r=t.children[o],a=r.getScreenCTM();if(a){const t=null!==(n=null===(e=r.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==n?n:0,o=null!==(s=null===(i=r.y)||void 0===i?void 0:i.baseVal.value)&&void 0!==s?s:0,l=r.firstChild,{style:u}=l;u.transformOrigin||(u.transformOrigin=`${-t}px ${-o}px`),u.transform=`scale(${c}) matrix(${a.a}, ${a.b}, ${a.c}, ${a.d}, ${a.e-d.left}, ${a.f-d.top}) translateZ(0.0001px)`}}}),!1!==l&&Array.from(i.querySelectorAll("iframe"),({contentWindow:e})=>{null==e||e.postMessage(`${t}${l}`,"null"===window.origin?"*":window.origin)})}o=1,r=void 0;const i=(t,e,o)=>{if(t.getAttribute(e)!==o)return t.setAttribute(e,o),!0};function a(t={}){const e="boolean"==typeof t?(t=>{const e=!t;return console.warn(`[DEPRECATION WARNING] Usage of observer() with boolean option has been deprecated. Please replace with the usage of option object: observer({ once: ${e?"true":"false"} }).`),{once:e}})(t):t,{once:o=!1,target:r=document}=e,a="Apple Computer, Inc."===navigator.vendor?[n]:[];let l=!o;const s=()=>{for(const t of a)t({target:r});!function(t=document){Array.from(t.querySelectorAll('svg[data-marp-fitting="svg"]'),t=>{var e;const o=t.firstChild,r=o.firstChild,{scrollWidth:n,scrollHeight:a}=r;let l,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(l=null===(e=t.parentElement)||void 0===e?void 0:e.parentElement),t.hasAttribute("data-marp-fitting-math")&&(l=t.parentElement),l){const t=getComputedStyle(l),e=Math.ceil(l.clientWidth-parseFloat(t.paddingLeft||"0")-parseFloat(t.paddingRight||"0"));e&&(s=e)}const c=Math.max(n,s),d=Math.max(a,1),u=`0 0 ${c} ${d}`;i(o,"width",""+c),i(o,"height",""+d),i(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),i(t,"viewBox",u)&&t.classList.toggle("__reflow__")})}(r),l&&window.requestAnimationFrame(s)};return s(),()=>{l=!1}}const l=Symbol(),s=document.currentScript;((t=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(t[l])return t[l];const e=a({target:t}),o=()=>{e(),delete t[l]};Object.defineProperty(t,l,{configurable:!0,value:o})})(s?s.getRootNode():document)}();
</script></foreignObject></svg></div><script>!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),a=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),s={},i=function(e,t){return(t=t||{}).index=a.indexOf(e),t.slide=e,t},o=function(e,t){s[e]=(s[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(s[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){a[e]&&(n&&l("deactivate",i(n,t)),n=a[e],l("activate",i(n,t)))},d=function(e,t){var r=a.indexOf(n)+e;l(e>0?"next":"prev",i(n,t))&&c(r,t)},u={off:o,on:function(e,t){return(s[e]||(s[e]=[])).push(t),o.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return a.indexOf(n);l("slide",i(a[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:a,destroy:function(e){l("destroy",i(n,e)),s={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach(e=>e.classList.add("bespoke-marp-slide")),e.on("activate",t=>{const n=t.slide,r=!n.classList.contains("bespoke-marp-active");e.slides.forEach(e=>{e.classList.remove("bespoke-marp-active"),e.setAttribute("aria-hidden","true")}),n.classList.add("bespoke-marp-active"),n.removeAttribute("aria-hidden"),r&&(n.classList.add("bespoke-marp-active-ready"),document.body.clientHeight,n.classList.remove("bespoke-marp-active-ready"))})}function n(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map(e=>[null,...e.querySelectorAll("[data-marpit-fragment]")])});const r=r=>void 0!==e.fragments[t][n+r],a=(r,a)=>{t=r,n=a,e.fragments.forEach((e,t)=>{e.forEach((e,n)=>{if(null==e)return;const s=t<r||t===r&&n<=a;e.setAttribute("data-bespoke-marp-fragment",s?"active":"inactive"),t===r&&n===a?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")})}),e.fragmentIndex=a;const s={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:a};e.fire("fragment",s)};e.on("next",({fragment:s=!0})=>{if(s){if(r(1))return a(t,n+1),!1;const s=t+1;e.fragments[s]&&a(s,0)}else{const r=e.fragments[t].length;if(n+1<r)return a(t,r-1),!1;const s=e.fragments[t+1];s&&a(t+1,s.length-1)}}),e.on("prev",({fragment:s=!0})=>{if(r(-1)&&s)return a(t,n-1),!1;const i=t-1;e.fragments[i]&&a(i,e.fragments[i].length-1)}),e.on("slide",({index:t,fragment:n})=>{let r=0;if(void 0!==n){const a=e.fragments[t];if(a){const{length:e}=a;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}a(t,r)}),a(0,0)}var r,a,s=(function(e){
/*!
* screenfull
* v5.0.2 - 2020-02-13
* (c) Sindre Sorhus; MIT License
*/
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,a=n.length,s={};r<a;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)s[n[0][r]]=e[r];return s}return!1}(),a={change:r.fullscreenchange,error:r.fullscreenerror},s={request:function(e){return new Promise(function(n,a){var s=function(){this.off("change",s),n()}.bind(this);this.on("change",s);var i=(e=e||t.documentElement)[r.requestFullscreen]();i instanceof Promise&&i.then(s).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var a=function(){this.off("change",a),e()}.bind(this);this.on("change",a);var s=t[r.exitFullscreen]();s instanceof Promise&&s.then(a).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=a[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=a[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=s:window.screenfull=s):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}(a={path:r,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports);function i(e){e.fullscreen=()=>{s.isEnabled&&s.toggle(document.body)},document.addEventListener("keydown",t=>{70!==t.which&&122!==t.which||t.altKey||t.ctrlKey||t.metaKey||!s.isEnabled||(e.fullscreen(),t.preventDefault())})}function o(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout(()=>{t.parent.classList.add("bespoke-marp-inactive"),t.fire("marp-inactive")},e),t.parent.classList.contains("bespoke-marp-inactive")&&(t.parent.classList.remove("bespoke-marp-inactive"),t.fire("marp-active"))}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const l=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function c(e){e.parent.addEventListener("keydown",e=>{if(!e.target)return;const t=e.target;(l.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()})}function d(e){window.addEventListener("load",()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}})}var u;function f({interval:e=200}={}){return t=>{document.addEventListener("keydown",e=>{if(32===e.which&&e.shiftKey)t.prev();else if(33===e.which||37===e.which||38===e.which)t.prev({fragment:!e.shiftKey});else if(32!==e.which||e.shiftKey)if(34===e.which||39===e.which||40===e.which)t.next({fragment:!e.shiftKey});else if(35===e.which)t.slide(t.slides.length-1,{fragment:-1});else{if(36!==e.which)return;t.slide(0)}else t.next();e.preventDefault()});let n,r,a=0;t.parent.addEventListener("wheel",s=>{let i=!1;const o=(e,t)=>{e&&(i=i||function(e,t){return function(e,t){const n=t===u.X?"Width":"Height";return e["client"+n]<e["scroll"+n]}(e,t)&&function(e,t){const{overflow:n}=e,r=e["overflow"+t];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&o(e.parentElement,t)};if(0!==s.deltaX&&o(s.target,u.X),0!==s.deltaY&&o(s.target,u.Y),i)return;s.preventDefault(),r&&clearTimeout(r),r=setTimeout(()=>{n=0},e);const l=Date.now()-a<e,c=Math.sqrt(Math.pow(s.deltaX,2)+Math.pow(s.deltaY,2)),d=c<=n;if(n=c,l||d)return;let f;(s.deltaX>0||s.deltaY>0)&&(f="next"),(s.deltaX<0||s.deltaY<0)&&(f="prev"),f&&(t[f](),a=Date.now())})}}!function(e){e.X="X",e.Y="Y"}(u||(u={}));const m=(...e)=>history.replaceState(...e),p="data-bespoke-view";var h;!function(e){e.Normal="",e.Presenter="presenter",e.Next="next"}(h||(h={}));const g=(e,{protocol:t,host:n,pathname:r,hash:a}=location)=>{const s=e.toString();return`${t}//${n}${r}${s?"?":""}${s}${a}`},v=()=>{switch(document.body.getAttribute(p)){case h.Normal:return h.Normal;case h.Presenter:return h.Presenter;case h.Next:return h.Next;default:throw new Error("View mode is not assigned.")}},b=e=>new URLSearchParams(location.search).get(e),w=(e,t={})=>{const n=Object.assign({location:location,setter:m},t),r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter(null,document.title,g(r,n.location))}catch(e){console.error(e)}},y={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function x(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return s.isEnabled||n("fullscreen",e=>e.style.display="none"),y.available||n("presenter",e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."}),e=>{t.addEventListener("click",t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next({fragment:!t.shiftKey});break;case"prev":e.prev({fragment:!t.shiftKey});break;case"fullscreen":"function"==typeof e.fullscreen&&s.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}}),e.parent.appendChild(t),e.on("activate",({index:t})=>{n("page",n=>n.textContent=`Page ${t+1} of ${e.slides.length}`)}),e.on("fragment",({index:t,fragments:r,fragmentIndex:a})=>{n("prev",e=>e.disabled=0===t&&0===a),n("next",n=>n.disabled=t===e.slides.length-1&&a===r.length-1)}),e.on("marp-active",()=>t.removeAttribute("aria-hidden")),e.on("marp-inactive",()=>t.setAttribute("aria-hidden","true")),s.isEnabled&&s.onchange(()=>n("fullscreen",e=>e.classList.toggle("exit",s.isEnabled&&s.isFullscreen)))}}function E(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,"bespoke-marp-presenter-"+this.syncKey,`width=${e},height=${t},menubar=no,toolbar=no`)}function k(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),g(e)}var L=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let S=e=>String(e).replace(/[&<>"']/g,e=>`&${I[e]};`),I={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},P="dangerouslySetInnerHTML",M={className:"class",htmlFor:"for"},N={};function F(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==P&&(r+=` ${M[e]?M[e]:S(e)}="${S(t[e])}"`);r+=">"}if(-1===L.indexOf(e)){if(t[P])r+=t[P].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===N[e]?e:S(e)}r+=e?`</${e}>`:""}return N[r]=!0,r}const O=({children:e})=>F(null,null,...e),q="bespoke-marp-presenter-container",C="bespoke-marp-presenter-next",T="bespoke-marp-presenter-next-container",A="bespoke-marp-presenter-note-container",K="bespoke-marp-presenter-info-container",$="bespoke-marp-presenter-info-page",j="bespoke-marp-presenter-info-page-text",D="bespoke-marp-presenter-info-page-prev",R="bespoke-marp-presenter-info-page-next",U="bespoke-marp-presenter-info-time",V="bespoke-marp-presenter-info-timer";function X(e){const{title:t}=document;document.title="[Presenter view]"+(t?" - "+t:"");const n={},r=e=>(n[e]=n[e]||document.querySelector("."+e),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=q,t.appendChild(e),t.insertAdjacentHTML("beforeend",F(O,null,F("div",{class:T},F("iframe",{class:C,src:"?view=next"})),F("div",{class:A}),F("div",{class:K},F("div",{class:$},F("button",{class:D,tabindex:"-1",title:"Previous"},"Previous"),F("span",{class:j}),F("button",{class:R,tabindex:"-1",title:"Next"},"Next")),F("time",{class:U,title:"Current time"}),F("div",{class:V})))),t})(e.parent)),(e=>{r(T).addEventListener("click",()=>e.next());const t=r(C),n=(a=t,(e,t)=>{var n;return null===(n=a.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var a;t.addEventListener("load",()=>{r(T).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",({index:e,fragmentIndex:t})=>n(e,t))});const s=document.querySelectorAll(".bespoke-marp-note");s.forEach(e=>{e.addEventListener("keydown",e=>e.stopPropagation()),r(A).appendChild(e)}),e.on("activate",()=>s.forEach(t=>t.classList.toggle("active",t.dataset.index==e.slide()))),e.on("activate",({index:t})=>{r(j).textContent=`${t+1} / ${e.slides.length}`});const i=r(D),o=r(R);i.addEventListener("click",t=>{i.blur(),e.prev({fragment:!t.shiftKey})}),o.addEventListener("click",t=>{o.blur(),e.next({fragment:!t.shiftKey})}),e.on("fragment",({index:t,fragments:n,fragmentIndex:r})=>{i.disabled=0===t&&0===r,o.disabled=t===e.slides.length-1&&r===n.length-1});const l=()=>r(U).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function Y(e){const t=v();return t===h.Next&&e.appendChild(document.createElement("span")),e=>{t===h.Normal&&function(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:E},presenterUrl:{enumerable:!0,get:k}}),y.available&&document.addEventListener("keydown",t=>{80!==t.which||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())})}(e),t===h.Presenter&&X(e),t===h.Next&&function(e){const t=t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let a=Number.parseInt(t,10),s=Number.parseInt(n,10)+1;s>=e.fragments[a].length&&(a+=1,s=0),e.slide(a,{fragment:s})}};window.addEventListener("message",t),e.on("destroy",()=>window.removeEventListener("message",t))}(e)}}function B(e){e.on("activate",t=>{document.querySelectorAll(".bespoke-progress-bar").forEach(n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"})})}const z=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function H(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},a=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:a}=e,s=Math.max(0,Math.min(t,a.length-1)),i=Math.max(0,Math.min(n||0,r[s].length-1));s===e.slide()&&i===e.fragmentIndex||e.slide(s,{fragment:i})})((z(location.hash.slice(1))||1)-1,t.fragment?z(b("f")||""):null)};e.on("fragment",({index:e,fragmentIndex:r})=>{n||w({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:"#"+(e+1)}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})}),setTimeout(()=>{a(),window.addEventListener("hashchange",()=>r(()=>{a({fragment:!1}),w({f:void 0})})),window.addEventListener("popstate",()=>{n||r(()=>a())}),n=!1},0)}}function W(e={}){const t=e.key||((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t})(),n="bespoke-marp-sync-"+t,r=()=>{const e=y.get(n);return e?JSON.parse(e):Object.create(null)},a=e=>{const t=r(),a=Object.assign(Object.assign({},t),e(t));return y.set(n,JSON.stringify(a)),a};return a(e=>({reference:(e.reference||0)+1})),e=>{Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let s=!0;setTimeout(()=>{e.on("fragment",e=>{s&&a(()=>({index:e.index,fragmentIndex:e.fragmentIndex}))})},0),window.addEventListener("storage",t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),r=JSON.parse(t.newValue);if(n.index!==r.index||n.fragmentIndex!==r.fragmentIndex)try{s=!1,e.slide(r.index,{fragment:r.fragmentIndex})}finally{s=!0}}}),e.on("destroy",()=>{const{reference:e}=r();void 0===e||e<=1?y.remove(n):a(()=>({reference:e-1}))})}}function J({slope:e=Math.tan(-35*Math.PI/180),swipeThreshold:t=30}={}){return n=>{let r;const a=n.parent,s=e=>{const t=a.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};a.addEventListener("touchstart",e=>{r=1===e.touches.length?s(e.touches[0]):void 0},{passive:!0}),a.addEventListener("touchmove",e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),n=t.x-r.x,a=t.y-r.y;r.delta=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(a),2)),r.radian=Math.atan2(n,a)}else r=void 0}),a.addEventListener("touchend",a=>{if(r){if(r.delta&&r.delta>=t&&r.radian){let t=r.radian-e;t=(t+Math.PI)%(2*Math.PI)-Math.PI,n[t<0?"next":"prev"](),a.stopPropagation()}r=void 0}},{passive:!0})}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function _(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))}let G=void 0;const Q=()=>(void 0===G&&(G="wakeLock"in navigator&&navigator.wakeLock),G),Z=()=>_(void 0,void 0,void 0,(function*(){const e=Q();if(e)try{const t=yield e.request("screen");return t.addEventListener("release",()=>{console.debug("[Marp CLI] Wake Lock was released")}),console.debug("[Marp CLI] Wake Lock is active"),t}catch(e){console.warn(e)}return null}));function ee(){return _(this,void 0,void 0,(function*(){if(!Q())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&Z()};return document.addEventListener("visibilitychange",t),document.addEventListener("fullscreenchange",t),e=yield Z(),e}))}const te=[h.Normal,h.Presenter,h.Next];!function(r=document.getElementById("p")){document.body.setAttribute(p,(()=>{switch(b("view")){case"next":return h.Next;case"presenter":return h.Presenter;default:return h.Normal}})());const a=(e=>{const t=b(e);return w({[e]:void 0}),t})("sync")||void 0,s=!1,l=!0,u=e(r,((...e)=>{const t=te.findIndex(e=>v()===e);if(t<0)throw new Error("Invalid view");return e.map(([e,n])=>e[t]&&n).filter(e=>e)})([[l,l,s],W({key:a})],[[l,l,l],Y(r)],[[l,l,s],c],[[l,l,l],t],[[l,s,s],o()],[[l,l,l],d],[[l,l,l],H({history:!1})],[[l,l,s],f()],[[l,l,s],i],[[l,s,s],B],[[l,l,s],J()],[[l,s,s],x()],[[l,l,l],n],[[l,l,s],ee]));window.addEventListener("beforeunload",()=>w({sync:u.syncKey})),window.addEventListener("unload",()=>u.destroy())}()}();</script><script>window.__marpCliWatchWS="ws://localhost:37717/7340615ce4ad5327537da761027edf0d15ee9928e71f96ffa79fe10d214595e1";!function(){"use strict";const e=(n,o=!1)=>{const t=new WebSocket(n);return t.addEventListener("open",()=>{console.info("[Marp CLI] Observing the change of file..."),o&&location.reload()}),t.addEventListener("close",()=>{console.warn("[Marp CLI] WebSocket for file watcher was disconnected. Try re-connecting in 5000ms..."),setTimeout(()=>e(n,!0),5e3)}),t.addEventListener("message",e=>{"reload"===e.data&&location.reload()}),t};!function(){const n=window.__marpCliWatchWS;if(n)e(n)}()}();</script></body></html>