<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;z-index:-1;pointer-events:none;opacity:0}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;z-index:0;pointer-events:auto;opacity:1}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{font-family:Helvetica,Arial,sans-serif;height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;font-size:1.1em;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,93.3%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93.3%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>@charset "UTF-8";@import url("https://fonts.googleapis.com/css?family=Lato:400,900|Roboto+Mono:400,700&display=swap");div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp / Marpit Gaia theme.
 *
 * @theme gaia
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .hljs{display:block;overflow-x:auto;padding:.5em;background:#000;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-quote{color:#aeaeae;font-style:italic}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#e28964}div#p>svg>foreignObject>section .hljs-string{color:#65b042}div#p>svg>foreignObject>section .hljs-subst{color:#daefa3}div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-regexp{color:#e9c062}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-tag,div#p>svg>foreignObject>section .hljs-title{color:#89bdff}div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-doctag{text-decoration:underline}div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol{color:#3387cc}div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#3e87e3}div#p>svg>foreignObject>section .hljs-attribute{color:#cda869}div#p>svg>foreignObject>section .hljs-meta{color:#8996a8}div#p>svg>foreignObject>section .hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}div#p>svg>foreignObject>section .hljs-addition{background-color:#253b22;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-deletion{background-color:#420e09;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-selector-class{color:#9b703f}div#p>svg>foreignObject>section .hljs-selector-id{color:#8b98ab}div#p>svg>foreignObject>section .hljs-emphasis{font-style:italic}div#p>svg>foreignObject>section .hljs-strong{font-weight:700}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:580px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin:.5em 0 0}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{font-weight:inherit}div#p>svg>foreignObject>section h1{font-size:1.8em}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.3em}div#p>svg>foreignObject>section h4{font-size:1.1em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section p{margin:1em 0 0}div#p>svg>foreignObject>section ol>li,div#p>svg>foreignObject>section ul>li{margin:.3em 0 0}div#p>svg>foreignObject>section ol>li>p,div#p>svg>foreignObject>section ul>li>p{margin:.6em 0 0}div#p>svg>foreignObject>section code{display:inline-block;font-family:Roboto Mono,monospace;font-size:.8em;letter-spacing:0;margin:-.1em .15em;padding:.1em .2em;vertical-align:baseline}div#p>svg>foreignObject>section pre{display:block;margin:1em 0 0;min-height:1em;overflow:visible}div#p>svg>foreignObject>section pre code{box-sizing:border-box;margin:0;min-width:100%;padding:.5em;font-size:.7em}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:calc(580px - 1em)}div#p>svg>foreignObject>section blockquote{margin:1em 0 0;padding:0 1em;position:relative}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before{content:"“";display:block;font-family:Times New Roman,serif;font-weight:700;position:absolute}div#p>svg>foreignObject>section blockquote:before{top:0;left:0}div#p>svg>foreignObject>section blockquote:after{right:0;bottom:0;transform:rotate(180deg)}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section mark{background:transparent}div#p>svg>foreignObject>section table{border-spacing:0;border-collapse:collapse;margin:1em 0 0}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{padding:.2em .4em;border-width:1px;border-style:solid}div#p>svg>foreignObject>section{background-image:linear-gradient(135deg,hsla(0,0%,53.3%,0),hsla(0,0%,53.3%,.02) 50%,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.05));font-size:35px;font-family:Lato,Avenir Next,Avenir,Trebuchet MS,Segoe UI,sans-serif;height:720px;line-height:1.35;letter-spacing:1.25px;padding:70px;width:1280px;word-wrap:break-word;color:#455a64;background-color:#fff8e1}div#p>svg>foreignObject>section{--marpit-root-font-size:35px}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section a,div#p>svg>foreignObject>section mark{color:#0288d1}div#p>svg>foreignObject>section code{background:#6a7a7d;color:#fff8e1}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{color:#0288d1}div#p>svg>foreignObject>section pre>code{background:#455a64}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header,div#p>svg>foreignObject>section section:after{color:#6a7a7d}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border-color:#455a64}div#p>svg>foreignObject>section table thead th{background:#455a64;color:#fff8e1}div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) th{background:rgba(69,90,100,.1)}div#p>svg>foreignObject>section.invert{color:#fff8e1;background-color:#455a64}div#p>svg>foreignObject>section.invert a,div#p>svg>foreignObject>section.invert mark{color:#81d4fa}div#p>svg>foreignObject>section.invert code{background:#dad8c8;color:#455a64}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.invert pre>code{background:#fff8e1}div#p>svg>foreignObject>section.invert blockquote:after,div#p>svg>foreignObject>section.invert blockquote:before,div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header,div#p>svg>foreignObject>section.invert section:after{color:#dad8c8}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#fff8e1}div#p>svg>foreignObject>section.invert table thead th{background:#fff8e1;color:#455a64}div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.gaia{color:#fff8e1;background-color:#0288d1}div#p>svg>foreignObject>section.gaia a,div#p>svg>foreignObject>section.gaia mark{color:#81d4fa}div#p>svg>foreignObject>section.gaia code{background:#cce2de;color:#0288d1}div#p>svg>foreignObject>section.gaia h1 strong,div#p>svg>foreignObject>section.gaia h2 strong,div#p>svg>foreignObject>section.gaia h3 strong,div#p>svg>foreignObject>section.gaia h4 strong,div#p>svg>foreignObject>section.gaia h5 strong,div#p>svg>foreignObject>section.gaia h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.gaia pre>code{background:#fff8e1}div#p>svg>foreignObject>section.gaia blockquote:after,div#p>svg>foreignObject>section.gaia blockquote:before,div#p>svg>foreignObject>section.gaia footer,div#p>svg>foreignObject>section.gaia header,div#p>svg>foreignObject>section.gaia section:after{color:#cce2de}div#p>svg>foreignObject>section.gaia table td,div#p>svg>foreignObject>section.gaia table th{border-color:#fff8e1}div#p>svg>foreignObject>section.gaia table thead th{background:#fff8e1;color:#0288d1}div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.lead{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center}div#p>svg>foreignObject>section.lead h1,div#p>svg>foreignObject>section.lead h2,div#p>svg>foreignObject>section.lead h3,div#p>svg>foreignObject>section.lead h4,div#p>svg>foreignObject>section.lead h5,div#p>svg>foreignObject>section.lead h6{text-align:center}div#p>svg>foreignObject>section.lead h1 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h2 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h3 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h4 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h5 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h6 svg[data-marp-fitting=svg]{--preserve-aspect-ratio:xMidYMid meet}div#p>svg>foreignObject>section.lead p{text-align:center}div#p>svg>foreignObject>section.lead blockquote>h1,div#p>svg>foreignObject>section.lead blockquote>h2,div#p>svg>foreignObject>section.lead blockquote>h3,div#p>svg>foreignObject>section.lead blockquote>h4,div#p>svg>foreignObject>section.lead blockquote>h5,div#p>svg>foreignObject>section.lead blockquote>h6,div#p>svg>foreignObject>section.lead blockquote>p{text-align:left}div#p>svg>foreignObject>section.lead blockquote svg[data-marp-fitting=svg]:not([data-marp-fitting-math]){--preserve-aspect-ratio:xMinYMin meet}div#p>svg>foreignObject>section.lead ol>li>p,div#p>svg>foreignObject>section.lead ul>li>p{text-align:left}div#p>svg>foreignObject>section.lead table{margin-left:auto;margin-right:auto}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{box-sizing:border-box;font-size:66%;height:70px;line-height:50px;overflow:hidden;padding:10px 25px;position:absolute}div#p>svg>foreignObject>section:after{--marpit-root-font-size:66%}div#p>svg>foreignObject>section header{top:0}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{left:0;right:0}div#p>svg>foreignObject>section footer{bottom:0}div#p>svg>foreignObject>section:after{right:0;bottom:0;font-size:80%}div#p>svg>foreignObject>section:after{--marpit-root-font-size:80%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-class="lead" data-theme="gaia" class="lead" data-marpit-pagination="1" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--class:lead;--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>第 5 章 pandas 入门</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="2" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>pandas 是贯穿本书后续部分的主要工具。它含有使数据清洗和分析工作变得更快更简单的数据结构和操作工具。pandas经常和其它工具一同使用，如数值计算工具NumPy和SciPy，分析库statsmodels和scikit-learn，和数据可视化库matplotlib。pandas是基于NumPy数组构建的，特别是基于数组的函数和不使用for循环的数据处理。</p>
<p>虽然pandas采用了大量的NumPy编码风格，但二者最大的不同是<code>pandas是专门为处理表格和混杂数据设计的</code>。而<code>NumPy更适合处理统一的数值数组数据。</code></p>
<p>自从2010年pandas开源以来，pandas逐渐成长为一个非常大的库，应用于许多真实案例。开发者社区已经有了800个独立的贡献者，他们在解决日常数据问题的同时为这个项目提供贡献。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="3" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在本书后续部分中，我将使用下面这样的pandas引入约定：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
</span></span></foreignObject></svg></code></pre>
<p>因此，只要你在代码中看到pd.，就得想到这是pandas。因为Series和DataFrame用的次数非常多，所以将其引入本地命名空间中会更方便：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">2</span>]: <span class="hljs-keyword">from</span> pandas <span class="hljs-keyword">import</span> Series, DataFrame
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="4" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>5.1 pandas的数据结构介绍</h2>
<p>要使用pandas，你首先就得熟悉它的两个主要数据结构：Series和DataFrame。虽然它们并不能解决所有问题，但它们为大多数应用提供了一种可靠的、易于使用的基础。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="5" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.1.1 Series</h3>
<p>Series是一种类似于一维数组的对象，它由一组数据（各种NumPy数据类型）以及一组与之相关的数据标签（即索引）组成。仅由一组数据即可产生最简单的Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">11</span>]: obj = pd.Series([<span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">3</span>])

In [<span class="hljs-number">12</span>]: obj
Out[<span class="hljs-number">12</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">4</span>
<span class="hljs-number">1</span>    <span class="hljs-number">7</span>
<span class="hljs-number">2</span>   <span class="hljs-number">-5</span>
<span class="hljs-number">3</span>    <span class="hljs-number">3</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="6" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Series的字符串表现形式为：索引在左边，值在右边。由于我们没有为数据指定索引，于是会自动创建一个0到N-1（N为数据的长度）的整数型索引。你可以通过Series 的values和index属性获取其数组表示形式和索引对象：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">13</span>]: obj.values
Out[<span class="hljs-number">13</span>]: array([ <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">-5</span>,  <span class="hljs-number">3</span>])

In [<span class="hljs-number">14</span>]: obj.index  <span class="hljs-comment"># like range(4)</span>
Out[<span class="hljs-number">14</span>]: RangeIndex(start=<span class="hljs-number">0</span>, stop=<span class="hljs-number">4</span>, step=<span class="hljs-number">1</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="7" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通常，我们希望所创建的Series带有一个可以对各个数据点进行标记的索引：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">15</span>]: obj2 = pd.Series([<span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">3</span>], index=[<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">16</span>]: obj2
Out[<span class="hljs-number">16</span>]: 
d    <span class="hljs-number">4</span>
b    <span class="hljs-number">7</span>
a   <span class="hljs-number">-5</span>
c    <span class="hljs-number">3</span>
dtype: int64

In [<span class="hljs-number">17</span>]: obj2.index
Out[<span class="hljs-number">17</span>]: Index([<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="8" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>与普通NumPy数组相比，你可以通过索引的方式选取Series中的单个或一组值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">18</span>]: obj2[<span class="hljs-string">&#x27;a&#x27;</span>]
Out[<span class="hljs-number">18</span>]: <span class="hljs-number">-5</span>

In [<span class="hljs-number">19</span>]: obj2[<span class="hljs-string">&#x27;d&#x27;</span>] = <span class="hljs-number">6</span>

In [<span class="hljs-number">20</span>]: obj2[[<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>]]
Out[<span class="hljs-number">20</span>]: 
c    <span class="hljs-number">3</span>
a   <span class="hljs-number">-5</span>
d    <span class="hljs-number">6</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
<p>['c', 'a', 'd']是索引列表，即使它包含的是字符串而不是整数。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="9" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>使用NumPy函数或类似NumPy的运算（如根据布尔型数组进行过滤、标量乘法、应用数学函数等）都会保留索引值的链接：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">21</span>]: obj2[obj2 &gt; <span class="hljs-number">0</span>]
Out[<span class="hljs-number">21</span>]: 
d    <span class="hljs-number">6</span>
b    <span class="hljs-number">7</span>
c    <span class="hljs-number">3</span>
dtype: int64

In [<span class="hljs-number">22</span>]: obj2 * <span class="hljs-number">2</span>
Out[<span class="hljs-number">22</span>]:
d    <span class="hljs-number">12</span>
b    <span class="hljs-number">14</span>
a   <span class="hljs-number">-10</span>
c     <span class="hljs-number">6</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="10" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">23</span>]: np.exp(obj2)
Out[<span class="hljs-number">23</span>]: 
d     <span class="hljs-number">403.428793</span>
b    <span class="hljs-number">1096.633158</span>
a       <span class="hljs-number">0.006738</span>
c      <span class="hljs-number">20.085537</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>还可以将Series看成是一个定长的有序字典，因为它是索引值到数据值的一个映射。它可以用在许多原本需要字典参数的函数中：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">24</span>]: <span class="hljs-string">&#x27;b&#x27;</span> <span class="hljs-keyword">in</span> obj2
Out[<span class="hljs-number">24</span>]: <span class="hljs-literal">True</span>

In [<span class="hljs-number">25</span>]: <span class="hljs-string">&#x27;e&#x27;</span> <span class="hljs-keyword">in</span> obj2
Out[<span class="hljs-number">25</span>]: <span class="hljs-literal">False</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="11" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果数据被存放在一个Python字典中，也可以直接通过这个字典来创建Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">26</span>]: sdata = {<span class="hljs-string">&#x27;Ohio&#x27;</span>: <span class="hljs-number">35000</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>: <span class="hljs-number">71000</span>, <span class="hljs-string">&#x27;Oregon&#x27;</span>: <span class="hljs-number">16000</span>, <span class="hljs-string">&#x27;Utah&#x27;</span>: <span class="hljs-number">5000</span>}

In [<span class="hljs-number">27</span>]: obj3 = pd.Series(sdata)

In [<span class="hljs-number">28</span>]: obj3
Out[<span class="hljs-number">28</span>]: 
Ohio      <span class="hljs-number">35000</span>
Oregon    <span class="hljs-number">16000</span>
Texas     <span class="hljs-number">71000</span>
Utah       <span class="hljs-number">5000</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="12" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果只传入一个字典，则结果Series中的索引就是原字典的键（有序排列）。你可以传入排好序的字典的键以改变顺序：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">29</span>]: states = [<span class="hljs-string">&#x27;California&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Oregon&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>]

In [<span class="hljs-number">30</span>]: obj4 = pd.Series(sdata, index=states)

In [<span class="hljs-number">31</span>]: obj4
Out[<span class="hljs-number">31</span>]: 
California        NaN
Ohio          <span class="hljs-number">35000.0</span>
Oregon        <span class="hljs-number">16000.0</span>
Texas         <span class="hljs-number">71000.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="13" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在这个例子中，sdata中跟states索引相匹配的那3个值会被找出来并放到相应的位置上，但由于&quot;California&quot;所对应的sdata值找不到，所以其结果就为NaN（即“非数字”（not a number），在pandas中，它用于表示缺失或NA值）。因为‘Utah’不在states中，它被从结果中除去。</p>
<p>我将使用缺失（missing）或NA表示缺失数据。pandas的isnull和notnull函数可用于检测缺失数据：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="14" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">32</span>]: pd.isnull(obj4)
Out[<span class="hljs-number">32</span>]: 
California     <span class="hljs-literal">True</span>
Ohio          <span class="hljs-literal">False</span>
Oregon        <span class="hljs-literal">False</span>
Texas         <span class="hljs-literal">False</span>
dtype: bool

In [<span class="hljs-number">33</span>]: pd.notnull(obj4)
Out[<span class="hljs-number">33</span>]: 
California    <span class="hljs-literal">False</span>
Ohio           <span class="hljs-literal">True</span>
Oregon         <span class="hljs-literal">True</span>
Texas          <span class="hljs-literal">True</span>
dtype: bool
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="15" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Series也有类似的实例方法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">34</span>]: obj4.isnull()
Out[<span class="hljs-number">34</span>]: 
California     <span class="hljs-literal">True</span>
Ohio          <span class="hljs-literal">False</span>
Oregon        <span class="hljs-literal">False</span>
Texas         <span class="hljs-literal">False</span>
dtype: bool
</span></span></foreignObject></svg></code></pre>
<p>我将在第7章详细讲解如何处理缺失数据。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="16" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于许多应用而言，Series最重要的一个功能是，它会根据运算的索引标签自动对齐数据：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">35</span>]: obj3
Out[<span class="hljs-number">35</span>]: 
Ohio      <span class="hljs-number">35000</span>
Oregon    <span class="hljs-number">16000</span>
Texas     <span class="hljs-number">71000</span>
Utah       <span class="hljs-number">5000</span>
dtype: int64

In [<span class="hljs-number">36</span>]: obj4
Out[<span class="hljs-number">36</span>]: 
California        NaN
Ohio          <span class="hljs-number">35000.0</span>
Oregon        <span class="hljs-number">16000.0</span>
Texas         <span class="hljs-number">71000.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="17" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">37</span>]: obj3 + obj4
Out[<span class="hljs-number">37</span>]: 
California         NaN
Ohio           <span class="hljs-number">70000.0</span>
Oregon         <span class="hljs-number">32000.0</span>
Texas         <span class="hljs-number">142000.0</span>
Utah               NaN
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>数据对齐功能将在后面详细讲解。如果你使用过数据库，你可以认为是类似join的操作。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="18" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Series对象本身及其索引都有一个name属性，该属性跟pandas其他的关键功能关系非常密切：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">38</span>]: obj4.name = <span class="hljs-string">&#x27;population&#x27;</span>

In [<span class="hljs-number">39</span>]: obj4.index.name = <span class="hljs-string">&#x27;state&#x27;</span>

In [<span class="hljs-number">40</span>]: obj4
Out[<span class="hljs-number">40</span>]: 
state
California        NaN
Ohio          <span class="hljs-number">35000.0</span>
Oregon        <span class="hljs-number">16000.0</span>
Texas         <span class="hljs-number">71000.0</span>
Name: population, dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="19" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Series的索引可以通过赋值的方式就地修改：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">41</span>]: obj
Out[<span class="hljs-number">41</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">4</span>
<span class="hljs-number">1</span>    <span class="hljs-number">7</span>
<span class="hljs-number">2</span>   <span class="hljs-number">-5</span>
<span class="hljs-number">3</span>    <span class="hljs-number">3</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="20" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">42</span>]: obj.index = [<span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-string">&#x27;Steve&#x27;</span>, <span class="hljs-string">&#x27;Jeff&#x27;</span>, <span class="hljs-string">&#x27;Ryan&#x27;</span>]

In [<span class="hljs-number">43</span>]: obj
Out[<span class="hljs-number">43</span>]: 
Bob      <span class="hljs-number">4</span>
Steve    <span class="hljs-number">7</span>
Jeff    <span class="hljs-number">-5</span>
Ryan     <span class="hljs-number">3</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="21" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.1.2 DataFrame</h3>
<p>DataFrame是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔值等）。DataFrame既有行索引也有列索引，它可以被看做由Series组成的字典（共用同一个索引）。DataFrame中的数据是以一个或多个二维块存放的（而不是列表、字典或别的一维数据结构）。有关DataFrame内部的技术细节远远超出了本书所讨论的范围。</p>
<blockquote>
<p>笔记：虽然DataFrame是以二维结构保存数据的，但你仍然可以轻松地将其表示为更高维度的数据（层次化索引的表格型结构，这是pandas中许多高级数据处理功能的关键要素，我们会在第8章讨论这个问题）。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="22" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>创建DataFrame的办法有很多，最常用的一种是直接传入一个由等长列表或NumPy数组组成的字典：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>data = {<span class="hljs-string">&#x27;state&#x27;</span>: [<span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>],
        <span class="hljs-string">&#x27;year&#x27;</span>: [<span class="hljs-number">2000</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">2003</span>],
        <span class="hljs-string">&#x27;pop&#x27;</span>: [<span class="hljs-number">1.5</span>, <span class="hljs-number">1.7</span>, <span class="hljs-number">3.6</span>, <span class="hljs-number">2.4</span>, <span class="hljs-number">2.9</span>, <span class="hljs-number">3.2</span>]}
frame = pd.DataFrame(data)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="23" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>结果DataFrame会自动加上索引（跟Series一样），且全部列会被有序排列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">45</span>]: frame
Out[<span class="hljs-number">45</span>]: 
   pop   state  year
<span class="hljs-number">0</span>  <span class="hljs-number">1.5</span>    Ohio  <span class="hljs-number">2000</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1.7</span>    Ohio  <span class="hljs-number">2001</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3.6</span>    Ohio  <span class="hljs-number">2002</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2.4</span>  Nevada  <span class="hljs-number">2001</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2.9</span>  Nevada  <span class="hljs-number">2002</span>
<span class="hljs-number">5</span>  <span class="hljs-number">3.2</span>  Nevada  <span class="hljs-number">2003</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="24" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果你使用的是Jupyter notebook，pandas DataFrame对象会以对浏览器友好的HTML表格的方式呈现。</p>
<p>对于特别大的DataFrame，head方法会选取前五行：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">46</span>]: frame.head()
Out[<span class="hljs-number">46</span>]: 
   pop   state  year
<span class="hljs-number">0</span>  <span class="hljs-number">1.5</span>    Ohio  <span class="hljs-number">2000</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1.7</span>    Ohio  <span class="hljs-number">2001</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3.6</span>    Ohio  <span class="hljs-number">2002</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2.4</span>  Nevada  <span class="hljs-number">2001</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2.9</span>  Nevada  <span class="hljs-number">2002</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="25" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果指定了列序列，则DataFrame的列就会按照指定顺序进行排列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">47</span>]: pd.DataFrame(data, columns=[<span class="hljs-string">&#x27;year&#x27;</span>, <span class="hljs-string">&#x27;state&#x27;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>])
Out[<span class="hljs-number">47</span>]: 
   year   state  pop
<span class="hljs-number">0</span>  <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="26" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果传入的列在数据中找不到，就会在结果中产生缺失值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">48</span>]: frame2 = pd.DataFrame(data, columns=[<span class="hljs-string">&#x27;year&#x27;</span>, <span class="hljs-string">&#x27;state&#x27;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>, <span class="hljs-string">&#x27;debt&#x27;</span>],
   ....:                       index=[<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>,
   ....:                              <span class="hljs-string">&#x27;five&#x27;</span>, <span class="hljs-string">&#x27;six&#x27;</span>])

In [<span class="hljs-number">49</span>]: frame2
Out[<span class="hljs-number">49</span>]: 
       year   state  pop debt
one    <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>  NaN
two    <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>  NaN
three  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>  NaN
four   <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>  NaN
five   <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>  NaN
six    <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>  NaN

In [<span class="hljs-number">50</span>]: frame2.columns
Out[<span class="hljs-number">50</span>]: Index([<span class="hljs-string">&#x27;year&#x27;</span>, <span class="hljs-string">&#x27;state&#x27;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>, <span class="hljs-string">&#x27;debt&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="27" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通过类似字典标记的方式或属性的方式，可以将DataFrame的列获取为一个Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">51</span>]: frame2[<span class="hljs-string">&#x27;state&#x27;</span>]
Out[<span class="hljs-number">51</span>]: 
one        Ohio
two        Ohio
three      Ohio
four     Nevada
five     Nevada
six      Nevada
Name: state, dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="28" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">52</span>]: frame2.year
Out[<span class="hljs-number">52</span>]: 
one      <span class="hljs-number">2000</span>
two      <span class="hljs-number">2001</span>
three    <span class="hljs-number">2002</span>
four     <span class="hljs-number">2001</span>
five     <span class="hljs-number">2002</span>
six      <span class="hljs-number">2003</span>
Name: year, dtype: int64
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>笔记：IPython提供了类似属性的访问（即frame2.year）和tab补全。<br />
frame2[column]适用于任何列的名，但是frame2.column只有在列名是一个合理的Python变量名时才适用。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="29" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>注意，返回的Series拥有原DataFrame相同的索引，且其name属性也已经被相应地设置好了。</p>
<p>行也可以通过位置或名称的方式进行获取，比如用<code>loc</code>属性（稍后将对此进行详细讲解）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">53</span>]: frame2.loc[<span class="hljs-string">&#x27;three&#x27;</span>]
Out[<span class="hljs-number">53</span>]: 
year     <span class="hljs-number">2002</span>
state    Ohio
pop       <span class="hljs-number">3.6</span>
debt      NaN
Name: three, dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="30" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>列可以通过赋值的方式进行修改。例如，我们可以给那个空的&quot;debt&quot;列赋上一个标量值或一组值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">54</span>]: frame2[<span class="hljs-string">&#x27;debt&#x27;</span>] = <span class="hljs-number">16.5</span>

In [<span class="hljs-number">55</span>]: frame2
Out[<span class="hljs-number">55</span>]: 
       year   state  pop  debt
one    <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>  <span class="hljs-number">16.5</span>
two    <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>  <span class="hljs-number">16.5</span>
three  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>  <span class="hljs-number">16.5</span>
four   <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>  <span class="hljs-number">16.5</span>
five   <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>  <span class="hljs-number">16.5</span>
six    <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>  <span class="hljs-number">16.5</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="31" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">56</span>]: frame2[<span class="hljs-string">&#x27;debt&#x27;</span>] = np.arange(<span class="hljs-number">6.</span>)

In [<span class="hljs-number">57</span>]: frame2
Out[<span class="hljs-number">57</span>]: 
       year   state  pop  debt
one    <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>   <span class="hljs-number">0.0</span>
two    <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>   <span class="hljs-number">1.0</span>
three  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>   <span class="hljs-number">2.0</span>
four   <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>   <span class="hljs-number">3.0</span>
five   <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>   <span class="hljs-number">4.0</span>
six    <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>   <span class="hljs-number">5.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="32" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>将列表或数组赋值给某个列时，其长度必须跟DataFrame的长度相匹配。如果赋值的是一个Series，就会精确匹配DataFrame的索引，所有的空位都将被填上缺失值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">58</span>]: val = pd.Series([<span class="hljs-number">-1.2</span>, <span class="hljs-number">-1.5</span>, <span class="hljs-number">-1.7</span>], index=[<span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>, <span class="hljs-string">&#x27;five&#x27;</span>])

In [<span class="hljs-number">59</span>]: frame2[<span class="hljs-string">&#x27;debt&#x27;</span>] = val

In [<span class="hljs-number">60</span>]: frame2
Out[<span class="hljs-number">60</span>]: 
       year   state  pop  debt
one    <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>   NaN
two    <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>  <span class="hljs-number">-1.2</span>
three  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>   NaN
four   <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>  <span class="hljs-number">-1.5</span>
five   <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>  <span class="hljs-number">-1.7</span>
six    <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>   NaN
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="33" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>为不存在的列赋值会创建出一个新列。关键字del用于删除列。</p>
<p>作为del的例子，我先添加一个新的布尔值的列，state是否为'Ohio'：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">61</span>]: frame2[<span class="hljs-string">&#x27;eastern&#x27;</span>] = frame2.state == <span class="hljs-string">&#x27;Ohio&#x27;</span>

In [<span class="hljs-number">62</span>]: frame2
Out[<span class="hljs-number">62</span>]: 
       year   state  pop  debt  eastern
one    <span class="hljs-number">2000</span>    Ohio  <span class="hljs-number">1.5</span>   NaN     <span class="hljs-literal">True</span>
two    <span class="hljs-number">2001</span>    Ohio  <span class="hljs-number">1.7</span>  <span class="hljs-number">-1.2</span>     <span class="hljs-literal">True</span>
three  <span class="hljs-number">2002</span>    Ohio  <span class="hljs-number">3.6</span>   NaN     <span class="hljs-literal">True</span>
four   <span class="hljs-number">2001</span>  Nevada  <span class="hljs-number">2.4</span>  <span class="hljs-number">-1.5</span>    <span class="hljs-literal">False</span>
five   <span class="hljs-number">2002</span>  Nevada  <span class="hljs-number">2.9</span>  <span class="hljs-number">-1.7</span>    <span class="hljs-literal">False</span>
six    <span class="hljs-number">2003</span>  Nevada  <span class="hljs-number">3.2</span>   NaN    <span class="hljs-literal">False</span>
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>注意：不能用frame2.eastern创建新的列。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="34" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>del方法可以用来删除这列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">63</span>]: <span class="hljs-keyword">del</span> frame2[<span class="hljs-string">&#x27;eastern&#x27;</span>]

In [<span class="hljs-number">64</span>]: frame2.columns
Out[<span class="hljs-number">64</span>]: Index([<span class="hljs-string">&#x27;year&#x27;</span>, <span class="hljs-string">&#x27;state&#x27;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>, <span class="hljs-string">&#x27;debt&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>注意：通过索引方式返回的列只是相应数据的视图而已，并不是副本。因此，对返回的Series所做的任何就地修改全都会反映到源DataFrame上。通过Series的copy方法即可指定复制列。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="35" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另一种常见的数据形式是嵌套字典：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">65</span>]: pop = {<span class="hljs-string">&#x27;Nevada&#x27;</span>: {<span class="hljs-number">2001</span>: <span class="hljs-number">2.4</span>, <span class="hljs-number">2002</span>: <span class="hljs-number">2.9</span>},
....:        <span class="hljs-string">&#x27;Ohio&#x27;</span>: {<span class="hljs-number">2000</span>: <span class="hljs-number">1.5</span>, <span class="hljs-number">2001</span>: <span class="hljs-number">1.7</span>, <span class="hljs-number">2002</span>: <span class="hljs-number">3.6</span>}}
</span></span></foreignObject></svg></code></pre>
<p>如果嵌套字典传给DataFrame，pandas就会被解释为：外层字典的键作为列，内层键则作为行索引：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">66</span>]: frame3 = pd.DataFrame(pop)

In [<span class="hljs-number">67</span>]: frame3
Out[<span class="hljs-number">67</span>]: 
      Nevada  Ohio
<span class="hljs-number">2000</span>     NaN   <span class="hljs-number">1.5</span>
<span class="hljs-number">2001</span>     <span class="hljs-number">2.4</span>   <span class="hljs-number">1.7</span>
<span class="hljs-number">2002</span>     <span class="hljs-number">2.9</span>   <span class="hljs-number">3.6</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="36" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>你也可以使用类似NumPy数组的方法，对DataFrame进行转置（交换行和列）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">68</span>]: frame3.T
Out[<span class="hljs-number">68</span>]: 
        <span class="hljs-number">2000</span>  <span class="hljs-number">2001</span>  <span class="hljs-number">2002</span>
Nevada   NaN   <span class="hljs-number">2.4</span>   <span class="hljs-number">2.9</span>
Ohio     <span class="hljs-number">1.5</span>   <span class="hljs-number">1.7</span>   <span class="hljs-number">3.6</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="37" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>内层字典的键会被合并、排序以形成最终的索引。如果明确指定了索引，则不会这样：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">69</span>]: pd.DataFrame(pop, index=[<span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">2003</span>])
Out[<span class="hljs-number">69</span>]: 
      Nevada  Ohio
<span class="hljs-number">2001</span>     <span class="hljs-number">2.4</span>   <span class="hljs-number">1.7</span>
<span class="hljs-number">2002</span>     <span class="hljs-number">2.9</span>   <span class="hljs-number">3.6</span>
<span class="hljs-number">2003</span>     NaN   NaN
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="38" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="38" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>由Series组成的字典差不多也是一样的用法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">70</span>]: pdata = {<span class="hljs-string">&#x27;Ohio&#x27;</span>: frame3[<span class="hljs-string">&#x27;Ohio&#x27;</span>][:<span class="hljs-number">-1</span>],
....:          <span class="hljs-string">&#x27;Nevada&#x27;</span>: frame3[<span class="hljs-string">&#x27;Nevada&#x27;</span>][:<span class="hljs-number">2</span>]}

In [<span class="hljs-number">71</span>]: pd.DataFrame(pdata)
Out[<span class="hljs-number">71</span>]: 
      Nevada  Ohio
<span class="hljs-number">2000</span>     NaN   <span class="hljs-number">1.5</span>
<span class="hljs-number">2001</span>     <span class="hljs-number">2.4</span>   <span class="hljs-number">1.7</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="39" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="39" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-1列出了DataFrame构造函数所能接受的各种数据。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-106835b28c0cea5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:700" style="width:700px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="40" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="40" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果设置了DataFrame的index和columns的name属性，则这些信息也会被显示出来：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">72</span>]: frame3.index.name = <span class="hljs-string">&#x27;year&#x27;</span>; frame3.columns.name = <span class="hljs-string">&#x27;state&#x27;</span>

In [<span class="hljs-number">73</span>]: frame3
Out[<span class="hljs-number">73</span>]: 
state  Nevada  Ohio
year
<span class="hljs-number">2000</span>      NaN   <span class="hljs-number">1.5</span>
<span class="hljs-number">2001</span>      <span class="hljs-number">2.4</span>   <span class="hljs-number">1.7</span>
<span class="hljs-number">2002</span>      <span class="hljs-number">2.9</span>   <span class="hljs-number">3.6</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="41" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="41" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>跟Series一样，values属性也会以二维ndarray的形式返回DataFrame中的数据：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">74</span>]: frame3.values
Out[<span class="hljs-number">74</span>]: 
array([[ nan,  <span class="hljs-number">1.5</span>],
       [ <span class="hljs-number">2.4</span>,  <span class="hljs-number">1.7</span>],
       [ <span class="hljs-number">2.9</span>,  <span class="hljs-number">3.6</span>]])
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="42" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="42" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果DataFrame各列的数据类型不同，则值数组的dtype就会选用能兼容所有列的数据类型：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">75</span>]: frame2.values
Out[<span class="hljs-number">75</span>]:
array([[<span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-number">1.5</span>, nan],
       [<span class="hljs-number">2001</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-number">1.7</span>, <span class="hljs-number">-1.2</span>],
       [<span class="hljs-number">2002</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-number">3.6</span>, nan],
       [<span class="hljs-number">2001</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-number">2.4</span>, <span class="hljs-number">-1.5</span>],
       [<span class="hljs-number">2002</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-number">2.9</span>, <span class="hljs-number">-1.7</span>],
       [<span class="hljs-number">2003</span>, <span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-number">3.2</span>, nan]], dtype=object)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="43" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="43" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>5.1.3 索引对象</h2>
<p>pandas的索引对象负责管理轴标签和其他元数据（比如轴名称等）。构建Series或DataFrame时，所用到的任何数组或其他序列的标签都会被转换成一个Index：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">76</span>]: obj = pd.Series(range(<span class="hljs-number">3</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">77</span>]: index = obj.index

In [<span class="hljs-number">78</span>]: index
Out[<span class="hljs-number">78</span>]: Index([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)

In [<span class="hljs-number">79</span>]: index[<span class="hljs-number">1</span>:]
Out[<span class="hljs-number">79</span>]: Index([<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="44" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="44" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Index对象是不可变的，因此用户不能对其进行修改：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>index[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;d&#x27;</span>  <span class="hljs-comment"># TypeError</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="45" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="45" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>不可变可以使Index对象在多个数据结构之间安全共享：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">80</span>]: labels = pd.Index(np.arange(<span class="hljs-number">3</span>))

In [<span class="hljs-number">81</span>]: labels
Out[<span class="hljs-number">81</span>]: Int64Index([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], dtype=<span class="hljs-string">&#x27;int64&#x27;</span>)

In [<span class="hljs-number">82</span>]: obj2 = pd.Series([<span class="hljs-number">1.5</span>, <span class="hljs-number">-2.5</span>, <span class="hljs-number">0</span>], index=labels)

In [<span class="hljs-number">83</span>]: obj2
Out[<span class="hljs-number">83</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">1.5</span>
<span class="hljs-number">1</span>   <span class="hljs-number">-2.5</span>
<span class="hljs-number">2</span>    <span class="hljs-number">0.0</span>
dtype: float64

In [<span class="hljs-number">84</span>]: obj2.index <span class="hljs-keyword">is</span> labels
Out[<span class="hljs-number">84</span>]: <span class="hljs-literal">True</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="46" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="46" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<blockquote>
<p>注意：虽然用户不需要经常使用Index的功能，但是因为一些操作会生成包含被索引化的数据，理解它们的工作原理是很重要的。</p>
</blockquote>
<p>除了类似于数组，Index的功能也类似一个固定大小的集合：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="47" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="47" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">85</span>]: frame3
Out[<span class="hljs-number">85</span>]: 
state  Nevada  Ohio
year               
<span class="hljs-number">2000</span>      NaN   <span class="hljs-number">1.5</span>
<span class="hljs-number">2001</span>      <span class="hljs-number">2.4</span>   <span class="hljs-number">1.7</span>
<span class="hljs-number">2002</span>      <span class="hljs-number">2.9</span>   <span class="hljs-number">3.6</span>
In [<span class="hljs-number">86</span>]: frame3.columns
Out[<span class="hljs-number">86</span>]: Index([<span class="hljs-string">&#x27;Nevada&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>, name=<span class="hljs-string">&#x27;state&#x27;</span>)

In [<span class="hljs-number">87</span>]: <span class="hljs-string">&#x27;Ohio&#x27;</span> <span class="hljs-keyword">in</span> frame3.columns
Out[<span class="hljs-number">87</span>]: <span class="hljs-literal">True</span>

In [<span class="hljs-number">88</span>]: <span class="hljs-number">2003</span> <span class="hljs-keyword">in</span> frame3.index
Out[<span class="hljs-number">88</span>]: <span class="hljs-literal">False</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="48" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="48" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>与python的集合不同，pandas的Index可以包含重复的标签：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">89</span>]: dup_labels = pd.Index([<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>])

In [<span class="hljs-number">90</span>]: dup_labels
Out[<span class="hljs-number">90</span>]: Index([<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<p>选择重复的标签，会显示所有的结果。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="49" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="49" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>每个索引都有一些方法和属性，它们可用于设置逻辑并回答有关该索引所包含的数据的常见问题。表5-2列出了这些函数。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-5499d14f0e2cd639.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:800" style="width:800px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="50" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="50" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>5.2 基本功能</h2>
<p>本节中，我将介绍操作Series和DataFrame中的数据的基本手段。后续章节将更加深入地挖掘pandas在数据分析和处理方面的功能。本书不是pandas库的详尽文档，主要关注的是最重要的功能，那些不大常用的内容（也就是那些更深奥的内容）就交给你自己去摸索吧。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="51" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="51" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.1 重新索引</h3>
<p>pandas对象的一个重要方法是reindex，其作用是创建一个新对象，它的数据符合新的索引。看下面的例子：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">91</span>]: obj = pd.Series([<span class="hljs-number">4.5</span>, <span class="hljs-number">7.2</span>, <span class="hljs-number">-5.3</span>, <span class="hljs-number">3.6</span>], index=[<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">92</span>]: obj
Out[<span class="hljs-number">92</span>]: 
d    <span class="hljs-number">4.5</span>
b    <span class="hljs-number">7.2</span>
a   <span class="hljs-number">-5.3</span>
c    <span class="hljs-number">3.6</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="52" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="52" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>用该Series的reindex将会根据新索引进行重排。如果某个索引值当前不存在，就引入缺失值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">93</span>]: obj2 = obj.reindex([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>])

In [<span class="hljs-number">94</span>]: obj2
Out[<span class="hljs-number">94</span>]: 
a   <span class="hljs-number">-5.3</span>
b    <span class="hljs-number">7.2</span>
c    <span class="hljs-number">3.6</span>
d    <span class="hljs-number">4.5</span>
e    NaN
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="53" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="53" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于时间序列这样的有序数据，重新索引时可能需要做一些插值处理。method选项即可达到此目的，例如，使用ffill可以实现前向值填充：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">95</span>]: obj3 = pd.Series([<span class="hljs-string">&#x27;blue&#x27;</span>, <span class="hljs-string">&#x27;purple&#x27;</span>, <span class="hljs-string">&#x27;yellow&#x27;</span>], index=[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>])

In [<span class="hljs-number">96</span>]: obj3
Out[<span class="hljs-number">96</span>]: 
<span class="hljs-number">0</span>      blue
<span class="hljs-number">2</span>    purple
<span class="hljs-number">4</span>    yellow
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="54" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="54" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">97</span>]: obj3.reindex(range(<span class="hljs-number">6</span>), method=<span class="hljs-string">&#x27;ffill&#x27;</span>)
Out[<span class="hljs-number">97</span>]: 
<span class="hljs-number">0</span>      blue
<span class="hljs-number">1</span>      blue
<span class="hljs-number">2</span>    purple
<span class="hljs-number">3</span>    purple
<span class="hljs-number">4</span>    yellow
<span class="hljs-number">5</span>    yellow
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="55" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="55" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>借助DataFrame，reindex可以修改（行）索引和列。只传递一个序列时，会重新索引结果的行：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">98</span>]: frame = pd.DataFrame(np.arange(<span class="hljs-number">9</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">3</span>)),
   ....:                      index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>],
   ....:                      columns=[<span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;California&#x27;</span>])

In [<span class="hljs-number">99</span>]: frame
Out[<span class="hljs-number">99</span>]: 
   Ohio  Texas  California
a     <span class="hljs-number">0</span>      <span class="hljs-number">1</span>           <span class="hljs-number">2</span>
c     <span class="hljs-number">3</span>      <span class="hljs-number">4</span>           <span class="hljs-number">5</span>
d     <span class="hljs-number">6</span>      <span class="hljs-number">7</span>           <span class="hljs-number">8</span>

In [<span class="hljs-number">100</span>]: frame2 = frame.reindex([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>])
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="56" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="56" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">101</span>]: frame2
Out[<span class="hljs-number">101</span>]: 
   Ohio  Texas  California
a   <span class="hljs-number">0.0</span>    <span class="hljs-number">1.0</span>         <span class="hljs-number">2.0</span>
b   NaN    NaN         NaN
c   <span class="hljs-number">3.0</span>    <span class="hljs-number">4.0</span>         <span class="hljs-number">5.0</span>
d   <span class="hljs-number">6.0</span>    <span class="hljs-number">7.0</span>         <span class="hljs-number">8.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="57" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="57" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>列可以用columns关键字重新索引：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">102</span>]: states = [<span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;California&#x27;</span>]

In [<span class="hljs-number">103</span>]: frame.reindex(columns=states)
Out[<span class="hljs-number">103</span>]: 
   Texas  Utah  California
a      <span class="hljs-number">1</span>   NaN           <span class="hljs-number">2</span>
c      <span class="hljs-number">4</span>   NaN           <span class="hljs-number">5</span>
d      <span class="hljs-number">7</span>   NaN           <span class="hljs-number">8</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="58" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="58" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-3列出了reindex函数的各参数及说明。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-efa3dbd4b83c61ec.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:1000" style="width:1000px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="59" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="59" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.2 丢弃指定轴上的项</h3>
<p>丢弃某条轴上的一个或多个项很简单，只要有一个索引数组或列表即可。由于需要执行一些数据整理和集合逻辑，所以drop方法返回的是一个在指定轴上删除了指定值的新对象：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="60" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="60" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">105</span>]: obj = pd.Series(np.arange(<span class="hljs-number">5.</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>])

In [<span class="hljs-number">106</span>]: obj
Out[<span class="hljs-number">106</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
c    <span class="hljs-number">2.0</span>
d    <span class="hljs-number">3.0</span>
e    <span class="hljs-number">4.0</span>
dtype: float64

In [<span class="hljs-number">107</span>]: new_obj = obj.drop(<span class="hljs-string">&#x27;c&#x27;</span>)

In [<span class="hljs-number">108</span>]: new_obj
Out[<span class="hljs-number">108</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
d    <span class="hljs-number">3.0</span>
e    <span class="hljs-number">4.0</span>
dtype: float64

In [<span class="hljs-number">109</span>]: obj.drop([<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])
Out[<span class="hljs-number">109</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
e    <span class="hljs-number">4.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="61" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="61" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于DataFrame，可以删除任意轴上的索引值。为了演示，先新建一个DataFrame例子：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">110</span>]: data = pd.DataFrame(np.arange(<span class="hljs-number">16</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">4</span>)),
   .....:                     index=[<span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Colorado&#x27;</span>, <span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;New York&#x27;</span>],
   .....:                     columns=[<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>])

In [<span class="hljs-number">111</span>]: data
Out[<span class="hljs-number">111</span>]: 
          one  two  three  four
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>     <span class="hljs-number">3</span>
Colorado    <span class="hljs-number">4</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="62" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="62" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>用标签序列调用drop会从行标签（axis 0）删除值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">112</span>]: data.drop([<span class="hljs-string">&#x27;Colorado&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>])
Out[<span class="hljs-number">112</span>]: 
          one  two  three  four
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="63" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="63" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>通过传递axis=1或axis='columns'可以删除列的值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">113</span>]: data.drop(<span class="hljs-string">&#x27;two&#x27;</span>, axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">113</span>]: 
          one  three  four
Ohio        <span class="hljs-number">0</span>      <span class="hljs-number">2</span>     <span class="hljs-number">3</span>
Colorado    <span class="hljs-number">4</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
Utah        <span class="hljs-number">8</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>

In [<span class="hljs-number">114</span>]: data.drop([<span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>], axis=<span class="hljs-string">&#x27;columns&#x27;</span>)
Out[<span class="hljs-number">114</span>]: 
          one  three
Ohio        <span class="hljs-number">0</span>      <span class="hljs-number">2</span>
Colorado    <span class="hljs-number">4</span>      <span class="hljs-number">6</span>
Utah        <span class="hljs-number">8</span>     <span class="hljs-number">10</span>
New York   <span class="hljs-number">12</span>     <span class="hljs-number">14</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="64" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="64" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>许多函数，如drop，会修改Series或DataFrame的大小或形状，可以就地修改对象，不会返回新的对象：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">115</span>]: obj.drop(<span class="hljs-string">&#x27;c&#x27;</span>, inplace=<span class="hljs-literal">True</span>)

In [<span class="hljs-number">116</span>]: obj
Out[<span class="hljs-number">116</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
d    <span class="hljs-number">3.0</span>
e    <span class="hljs-number">4.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>小心使用inplace，它会销毁所有被删除的数据。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="65" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="65" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.3 索引、选取和过滤</h3>
<p>Series索引（obj[...]）的工作方式类似于NumPy数组的索引，只不过Series的索引值不只是整数。下面是几个例子：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">117</span>]: obj = pd.Series(np.arange(<span class="hljs-number">4.</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>])

In [<span class="hljs-number">118</span>]: obj
Out[<span class="hljs-number">118</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
c    <span class="hljs-number">2.0</span>
d    <span class="hljs-number">3.0</span>
dtype: float64

In [<span class="hljs-number">119</span>]: obj[<span class="hljs-string">&#x27;b&#x27;</span>]
Out[<span class="hljs-number">119</span>]: <span class="hljs-number">1.0</span>

In [<span class="hljs-number">120</span>]: obj[<span class="hljs-number">1</span>]
Out[<span class="hljs-number">120</span>]: <span class="hljs-number">1.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="66" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="66" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">121</span>]: obj[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]
Out[<span class="hljs-number">121</span>]: 
c    <span class="hljs-number">2.0</span>
d    <span class="hljs-number">3.0</span>
dtype: float64

In [<span class="hljs-number">122</span>]: obj[[<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>]]
Out[<span class="hljs-number">122</span>]:
b    <span class="hljs-number">1.0</span>
a    <span class="hljs-number">0.0</span>
d    <span class="hljs-number">3.0</span>
dtype: float64

In [<span class="hljs-number">123</span>]: obj[[<span class="hljs-number">1</span>, <span class="hljs-number">3</span>]]
Out[<span class="hljs-number">123</span>]: 
b    <span class="hljs-number">1.0</span>
d    <span class="hljs-number">3.0</span>
dtype: float64

In [<span class="hljs-number">124</span>]: obj[obj &lt; <span class="hljs-number">2</span>]
Out[<span class="hljs-number">124</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">1.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="67" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="67" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>利用标签的切片运算与普通的Python切片运算不同，其末端是包含的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">125</span>]: obj[<span class="hljs-string">&#x27;b&#x27;</span>:<span class="hljs-string">&#x27;c&#x27;</span>]
Out[<span class="hljs-number">125</span>]:
b    <span class="hljs-number">1.0</span>
c    <span class="hljs-number">2.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="68" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="68" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>用切片可以对Series的相应部分进行设置：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">126</span>]: obj[<span class="hljs-string">&#x27;b&#x27;</span>:<span class="hljs-string">&#x27;c&#x27;</span>] = <span class="hljs-number">5</span>

In [<span class="hljs-number">127</span>]: obj
Out[<span class="hljs-number">127</span>]: 
a    <span class="hljs-number">0.0</span>
b    <span class="hljs-number">5.0</span>
c    <span class="hljs-number">5.0</span>
d    <span class="hljs-number">3.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="69" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="69" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>用一个值或序列对DataFrame进行索引其实就是获取一个或多个列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">128</span>]: data = pd.DataFrame(np.arange(<span class="hljs-number">16</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">4</span>)),
   .....:                     index=[<span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Colorado&#x27;</span>, <span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;New York&#x27;</span>],
   .....:                     columns=[<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>])

In [<span class="hljs-number">129</span>]: data
Out[<span class="hljs-number">129</span>]: 
          one  two  three  four
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>     <span class="hljs-number">3</span>
Colorado    <span class="hljs-number">4</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="70" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="70" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">130</span>]: data[<span class="hljs-string">&#x27;two&#x27;</span>]
Out[<span class="hljs-number">130</span>]: 
Ohio         <span class="hljs-number">1</span>
Colorado     <span class="hljs-number">5</span>
Utah         <span class="hljs-number">9</span>
New York    <span class="hljs-number">13</span>
Name: two, dtype: int64

In [<span class="hljs-number">131</span>]: data[[<span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>]]
Out[<span class="hljs-number">131</span>]: 
          three  one
Ohio          <span class="hljs-number">2</span>    <span class="hljs-number">0</span>
Colorado      <span class="hljs-number">6</span>    <span class="hljs-number">4</span>
Utah         <span class="hljs-number">10</span>    <span class="hljs-number">8</span>
New York     <span class="hljs-number">14</span>   <span class="hljs-number">12</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="71" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="71" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这种索引方式有几个特殊的情况。首先通过切片或布尔型数组选取数据：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">132</span>]: data[:<span class="hljs-number">2</span>]
Out[<span class="hljs-number">132</span>]: 
          one  two  three  four
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>     <span class="hljs-number">3</span>
Colorado    <span class="hljs-number">4</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
In [<span class="hljs-number">133</span>]: data[data[<span class="hljs-string">&#x27;three&#x27;</span>] &gt; <span class="hljs-number">5</span>]
Out[<span class="hljs-number">133</span>]: 
          one  two  three  four
Colorado    <span class="hljs-number">4</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>
</span></span></foreignObject></svg></code></pre>
<p>选取行的语法data[:2]十分方便。向[ ]传递单一的元素或列表，就可选择列。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="72" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="72" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另一种用法是通过布尔型DataFrame（比如下面这个由标量比较运算得出的）进行索引：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">134</span>]: data &lt; <span class="hljs-number">5</span>
Out[<span class="hljs-number">134</span>]:one    two  three   four
Ohio       <span class="hljs-literal">True</span>   <span class="hljs-literal">True</span>   <span class="hljs-literal">True</span>   <span class="hljs-literal">True</span>
Colorado   <span class="hljs-literal">True</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
Utah      <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
New York  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
In [<span class="hljs-number">135</span>]: data[data &lt; <span class="hljs-number">5</span>] = <span class="hljs-number">0</span>
In [<span class="hljs-number">136</span>]: data
Out[<span class="hljs-number">136</span>]:one  two  three  four
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>     <span class="hljs-number">0</span>
Colorado    <span class="hljs-number">0</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>     <span class="hljs-number">7</span>
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>    <span class="hljs-number">11</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>    <span class="hljs-number">15</span>
</span></span></foreignObject></svg></code></pre>
<p>这使得DataFrame的语法与NumPy二维数组的语法很像。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="73" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="73" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.3.1 用loc和iloc进行选取</h3>
<p>对于DataFrame的行的标签索引，我引入了特殊的标签运算符loc和iloc。它们可以让你用类似NumPy的标记，使用轴标签（loc）或整数索引（iloc），从DataFrame选择行和列的子集。</p>
<p>作为一个初步示例，让我们通过标签选择一行和多列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">137</span>]: data.loc[<span class="hljs-string">&#x27;Colorado&#x27;</span>, [<span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>]]
Out[<span class="hljs-number">137</span>]: 
two      <span class="hljs-number">5</span>
three    <span class="hljs-number">6</span>
Name: Colorado, dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="74" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="74" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>然后用iloc和整数进行选取：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">138</span>]: data.iloc[<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]
Out[<span class="hljs-number">138</span>]: 
four    <span class="hljs-number">11</span>
one      <span class="hljs-number">8</span>
two      <span class="hljs-number">9</span>
Name: Utah, dtype: int64

In [<span class="hljs-number">139</span>]: data.iloc[<span class="hljs-number">2</span>]
Out[<span class="hljs-number">139</span>]: 
one       <span class="hljs-number">8</span>
two       <span class="hljs-number">9</span>
three    <span class="hljs-number">10</span>
four     <span class="hljs-number">11</span>
Name: Utah, dtype: int64

In [<span class="hljs-number">140</span>]: data.iloc[[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]
Out[<span class="hljs-number">140</span>]: 
          four  one  two
Colorado     <span class="hljs-number">7</span>    <span class="hljs-number">0</span>    <span class="hljs-number">5</span>
Utah        <span class="hljs-number">11</span>    <span class="hljs-number">8</span>    <span class="hljs-number">9</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="75" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="75" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这两个索引函数也适用于一个标签或多个标签的切片：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">141</span>]: data.loc[:<span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>]
Out[<span class="hljs-number">141</span>]: 
Ohio        <span class="hljs-number">0</span>
Colorado    <span class="hljs-number">5</span>
Utah        <span class="hljs-number">9</span>
Name: two, dtype: int64

In [<span class="hljs-number">142</span>]: data.iloc[:, :<span class="hljs-number">3</span>][data.three &gt; <span class="hljs-number">5</span>]
Out[<span class="hljs-number">142</span>]: 
          one  two  three
Colorado    <span class="hljs-number">0</span>    <span class="hljs-number">5</span>      <span class="hljs-number">6</span>
Utah        <span class="hljs-number">8</span>    <span class="hljs-number">9</span>     <span class="hljs-number">10</span>
New York   <span class="hljs-number">12</span>   <span class="hljs-number">13</span>     <span class="hljs-number">14</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="76" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="76" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>所以，在pandas中，有多个方法可以选取和重新组合数据。对于DataFrame，表5-4进行了总结。后面会看到，还有更多的方法进行层级化索引。</p>
<blockquote>
<p>笔记：在一开始设计pandas时，我觉得用frame[:, col]选取列过于繁琐（也容易出错），因为列的选择是非常常见的操作。我做了些取舍，将花式索引的功能（标签和整数）放到了ix运算符中。在实践中，这会导致许多边缘情况，数据的轴标签是整数，所以pandas团队决定创造loc和iloc运算符分别处理严格基于标签和整数的索引。<br />
ix运算符仍然可用，但并不推荐。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="77" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="77" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-64354f2ab777bd8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表5-4 DataFrame的索引选项" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="78" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="78" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.4 整数索引</h3>
<p>处理整数索引的pandas对象常常难住新手，因为它与Python内置的列表和元组的索引语法不同。例如，你可能不认为下面的代码会出错：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>ser = pd.Series(np.arange(<span class="hljs-number">3.</span>))
ser
ser[<span class="hljs-number">-1</span>]
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="79" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="79" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>这里，pandas可以勉强进行整数索引，但是会导致小bug。我们有包含0,1,2的索引，但是引入用户想要的东西（基于标签或位置的索引）很难：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">144</span>]: ser
Out[<span class="hljs-number">144</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">0.0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">2.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="80" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="80" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另外，对于非整数索引，不会产生歧义：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">145</span>]: ser2 = pd.Series(np.arange(<span class="hljs-number">3.</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">146</span>]: ser2[<span class="hljs-number">-1</span>]
Out[<span class="hljs-number">146</span>]: <span class="hljs-number">2.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="81" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="81" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>为了进行统一，如果轴索引含有整数，数据选取总会使用标签。为了更准确，请使用loc（标签）或iloc（整数）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">147</span>]: ser[:<span class="hljs-number">1</span>]
Out[<span class="hljs-number">147</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">0.0</span>
dtype: float64

In [<span class="hljs-number">148</span>]: ser.loc[:<span class="hljs-number">1</span>]
Out[<span class="hljs-number">148</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">0.0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1.0</span>
dtype: float64

In [<span class="hljs-number">149</span>]: ser.iloc[:<span class="hljs-number">1</span>]
Out[<span class="hljs-number">149</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">0.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="82" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="82" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.5 算术运算和数据对齐</h3>
<p>pandas最重要的一个功能是，它可以对不同索引的对象进行算术运算。在将对象相加时，如果存在不同的索引对，则结果的索引就是该索引对的并集。对于有数据库经验的用户，这就像在索引标签上进行自动外连接。看一个简单的例子：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="83" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="83" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">150</span>]: s1 = pd.Series([<span class="hljs-number">7.3</span>, <span class="hljs-number">-2.5</span>, <span class="hljs-number">3.4</span>, <span class="hljs-number">1.5</span>], index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>])

In [<span class="hljs-number">151</span>]: s2 = pd.Series([<span class="hljs-number">-2.1</span>, <span class="hljs-number">3.6</span>, <span class="hljs-number">-1.5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3.1</span>],
   .....:                index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>])

In [<span class="hljs-number">152</span>]: s1
Out[<span class="hljs-number">152</span>]: 
a    <span class="hljs-number">7.3</span>
c   <span class="hljs-number">-2.5</span>
d    <span class="hljs-number">3.4</span>
e    <span class="hljs-number">1.5</span>
dtype: float64

In [<span class="hljs-number">153</span>]: s2
Out[<span class="hljs-number">153</span>]: 
a   <span class="hljs-number">-2.1</span>
c    <span class="hljs-number">3.6</span>
e   <span class="hljs-number">-1.5</span>
f    <span class="hljs-number">4.0</span>
g    <span class="hljs-number">3.1</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="84" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="84" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>将它们相加就会产生：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">154</span>]: s1 + s2
Out[<span class="hljs-number">154</span>]: 
a    <span class="hljs-number">5.2</span>
c    <span class="hljs-number">1.1</span>
d    NaN
e    <span class="hljs-number">0.0</span>
f    NaN
g    NaN
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>自动的数据对齐操作在不重叠的索引处引入了NA值。缺失值会在算术运算过程中传播。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="85" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="85" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于DataFrame，对齐操作会同时发生在行和列上：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">155</span>]: df1 = pd.DataFrame(np.arange(<span class="hljs-number">9.</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">3</span>)), columns=list(<span class="hljs-string">&#x27;bcd&#x27;</span>),
   .....:                    index=[<span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;Colorado&#x27;</span>])

In [<span class="hljs-number">156</span>]: df2 = pd.DataFrame(np.arange(<span class="hljs-number">12.</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">3</span>)), columns=list(<span class="hljs-string">&#x27;bde&#x27;</span>),
   .....:                    index=[<span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;Oregon&#x27;</span>])

In [<span class="hljs-number">157</span>]: df1
Out[<span class="hljs-number">157</span>]: 
            b    c    d
Ohio      <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>
Texas     <span class="hljs-number">3.0</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">5.0</span>
Colorado  <span class="hljs-number">6.0</span>  <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>

In [<span class="hljs-number">158</span>]: df2
Out[<span class="hljs-number">158</span>]: 
          b     d     e
Utah    <span class="hljs-number">0.0</span>   <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>
Ohio    <span class="hljs-number">3.0</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">5.0</span>
Texas   <span class="hljs-number">6.0</span>   <span class="hljs-number">7.0</span>   <span class="hljs-number">8.0</span>
Oregon  <span class="hljs-number">9.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="86" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="86" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>把它们相加后将会返回一个新的DataFrame，其索引和列为原来那两个DataFrame的并集：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">159</span>]: df1 + df2
Out[<span class="hljs-number">159</span>]: 
            b   c     d   e
Colorado  NaN NaN   NaN NaN
Ohio      <span class="hljs-number">3.0</span> NaN   <span class="hljs-number">6.0</span> NaN
Oregon    NaN NaN   NaN NaN
Texas     <span class="hljs-number">9.0</span> NaN  <span class="hljs-number">12.0</span> NaN
Utah      NaN NaN   NaN NaN
</span></span></foreignObject></svg></code></pre>
<p>因为'c'和'e'列均不在两个DataFrame对象中，在结果中以缺省值呈现。行也是同样。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="87" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="87" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果DataFrame对象相加，没有共用的列或行标签，结果都会是空：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">160</span>]: df1 = pd.DataFrame({<span class="hljs-string">&#x27;A&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]})

In [<span class="hljs-number">161</span>]: df2 = pd.DataFrame({<span class="hljs-string">&#x27;B&#x27;</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]})

In [<span class="hljs-number">162</span>]: df1
Out[<span class="hljs-number">162</span>]: 
   A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>

In [<span class="hljs-number">163</span>]: df2
Out[<span class="hljs-number">163</span>]: 
   B
<span class="hljs-number">0</span>  <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4</span>

In [<span class="hljs-number">164</span>]: df1 - df2
Out[<span class="hljs-number">164</span>]: 
    A   B
<span class="hljs-number">0</span> NaN NaN
<span class="hljs-number">1</span> NaN NaN
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="88" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="88" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h4>5.2.5.1 在算术方法中填充值</h4>
<p>在对不同索引的对象进行算术运算时，你可能希望当一个对象中某个轴标签在另一个对象中找不到时填充一个特殊值（比如0）：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="89" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="89" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">165</span>]: df1 = pd.DataFrame(np.arange(<span class="hljs-number">12.</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)),
   .....:                    columns=list(<span class="hljs-string">&#x27;abcd&#x27;</span>))

In [<span class="hljs-number">166</span>]: df2 = pd.DataFrame(np.arange(<span class="hljs-number">20.</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)),
   .....:                    columns=list(<span class="hljs-string">&#x27;abcde&#x27;</span>))

In [<span class="hljs-number">167</span>]: df2.loc[<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>] = np.nan

In [<span class="hljs-number">168</span>]: df1
Out[<span class="hljs-number">168</span>]: 
     a    b     c     d
<span class="hljs-number">0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">3.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">5.0</span>   <span class="hljs-number">6.0</span>   <span class="hljs-number">7.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>

In [<span class="hljs-number">169</span>]: df2
Out[<span class="hljs-number">169</span>]: 
      a     b     c     d     e
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>   <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">3.0</span>   <span class="hljs-number">4.0</span>
<span class="hljs-number">1</span>   <span class="hljs-number">5.0</span>   NaN   <span class="hljs-number">7.0</span>   <span class="hljs-number">8.0</span>   <span class="hljs-number">9.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>  <span class="hljs-number">12.0</span>  <span class="hljs-number">13.0</span>  <span class="hljs-number">14.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">15.0</span>  <span class="hljs-number">16.0</span>  <span class="hljs-number">17.0</span>  <span class="hljs-number">18.0</span>  <span class="hljs-number">19.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="90" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="90" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>将它们相加时，没有重叠的位置就会产生NA值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">170</span>]: df1 + df2
Out[<span class="hljs-number">170</span>]: 
      a     b     c     d   e
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">6.0</span> NaN
<span class="hljs-number">1</span>   <span class="hljs-number">9.0</span>   NaN  <span class="hljs-number">13.0</span>  <span class="hljs-number">15.0</span> NaN
<span class="hljs-number">2</span>  <span class="hljs-number">18.0</span>  <span class="hljs-number">20.0</span>  <span class="hljs-number">22.0</span>  <span class="hljs-number">24.0</span> NaN
<span class="hljs-number">3</span>   NaN   NaN   NaN   NaN NaN
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="91" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="91" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>使用df1的add方法，传入df2以及一个fill_value参数：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">171</span>]: df1.add(df2, fill_value=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">171</span>]: 
      a     b     c     d     e
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">6.0</span>   <span class="hljs-number">4.0</span>
<span class="hljs-number">1</span>   <span class="hljs-number">9.0</span>   <span class="hljs-number">5.0</span>  <span class="hljs-number">13.0</span>  <span class="hljs-number">15.0</span>   <span class="hljs-number">9.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">18.0</span>  <span class="hljs-number">20.0</span>  <span class="hljs-number">22.0</span>  <span class="hljs-number">24.0</span>  <span class="hljs-number">14.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">15.0</span>  <span class="hljs-number">16.0</span>  <span class="hljs-number">17.0</span>  <span class="hljs-number">18.0</span>  <span class="hljs-number">19.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="92" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="92" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-5列出了Series和DataFrame的算术方法。它们每个都有一个副本，以字母r开头，它会翻转参数。因此这两个语句是等价的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">172</span>]: <span class="hljs-number">1</span> / df1
Out[<span class="hljs-number">172</span>]: 
          a         b         c         d
<span class="hljs-number">0</span>       inf  <span class="hljs-number">1.000000</span>  <span class="hljs-number">0.500000</span>  <span class="hljs-number">0.333333</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.250000</span>  <span class="hljs-number">0.200000</span>  <span class="hljs-number">0.166667</span>  <span class="hljs-number">0.142857</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.125000</span>  <span class="hljs-number">0.111111</span>  <span class="hljs-number">0.100000</span>  <span class="hljs-number">0.090909</span>

In [<span class="hljs-number">173</span>]: df1.rdiv(<span class="hljs-number">1</span>)
Out[<span class="hljs-number">173</span>]: 
          a         b         c         d
<span class="hljs-number">0</span>       inf  <span class="hljs-number">1.000000</span>  <span class="hljs-number">0.500000</span>  <span class="hljs-number">0.333333</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.250000</span>  <span class="hljs-number">0.200000</span>  <span class="hljs-number">0.166667</span>  <span class="hljs-number">0.142857</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.125000</span>  <span class="hljs-number">0.111111</span>  <span class="hljs-number">0.100000</span>  <span class="hljs-number">0.090909</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="93" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="93" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-16857a1021f98d1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表5-5 灵活的算术方法" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="94" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="94" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>与此类似，在对Series或DataFrame重新索引时，也可以指定一个填充值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">174</span>]: df1.reindex(columns=df2.columns, fill_value=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">174</span>]: 
     a    b     c     d  e
<span class="hljs-number">0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">3.0</span>  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">5.0</span>   <span class="hljs-number">6.0</span>   <span class="hljs-number">7.0</span>  <span class="hljs-number">0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>  <span class="hljs-number">0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="95" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="95" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h4>5.2.5.2 DataFrame和Series之间的运算</h4>
<p>跟不同维度的NumPy数组一样，DataFrame和Series之间算术运算也是有明确规定的。先来看一个具有启发性的例子，计算一个二维数组与其某行之间的差：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="96" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="96" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">175</span>]: arr = np.arange(<span class="hljs-number">12.</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">176</span>]: arr
Out[<span class="hljs-number">176</span>]: 
array([[  <span class="hljs-number">0.</span>,   <span class="hljs-number">1.</span>,   <span class="hljs-number">2.</span>,   <span class="hljs-number">3.</span>],
       [  <span class="hljs-number">4.</span>,   <span class="hljs-number">5.</span>,   <span class="hljs-number">6.</span>,   <span class="hljs-number">7.</span>],
       [  <span class="hljs-number">8.</span>,   <span class="hljs-number">9.</span>,  <span class="hljs-number">10.</span>,  <span class="hljs-number">11.</span>]])

In [<span class="hljs-number">177</span>]: arr[<span class="hljs-number">0</span>]
Out[<span class="hljs-number">177</span>]: array([ <span class="hljs-number">0.</span>,  <span class="hljs-number">1.</span>,  <span class="hljs-number">2.</span>,  <span class="hljs-number">3.</span>])

In [<span class="hljs-number">178</span>]: arr - arr[<span class="hljs-number">0</span>]
Out[<span class="hljs-number">178</span>]: 
array([[ <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>,  <span class="hljs-number">0.</span>],
       [ <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>,  <span class="hljs-number">4.</span>],
       [ <span class="hljs-number">8.</span>,  <span class="hljs-number">8.</span>,  <span class="hljs-number">8.</span>,  <span class="hljs-number">8.</span>]])
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="97" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="97" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>当我们从arr减去arr[0]，每一行都会执行这个操作。这就叫做广播（broadcasting），附录A将对此进行详细讲解。DataFrame和Series之间的运算差不多也是如此：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="98" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="98" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">179</span>]: frame = pd.DataFrame(np.arange(<span class="hljs-number">12.</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">3</span>)),
   .....:                      columns=list(<span class="hljs-string">&#x27;bde&#x27;</span>),
   .....:                      index=[<span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;Oregon&#x27;</span>])

In [<span class="hljs-number">180</span>]: series = frame.iloc[<span class="hljs-number">0</span>]

In [<span class="hljs-number">181</span>]: frame
Out[<span class="hljs-number">181</span>]: 
          b     d     e
Utah    <span class="hljs-number">0.0</span>   <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>
Ohio    <span class="hljs-number">3.0</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">5.0</span>
Texas   <span class="hljs-number">6.0</span>   <span class="hljs-number">7.0</span>   <span class="hljs-number">8.0</span>
Oregon  <span class="hljs-number">9.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>

In [<span class="hljs-number">182</span>]: series
Out[<span class="hljs-number">182</span>]: 
b    <span class="hljs-number">0.0</span>
d    <span class="hljs-number">1.0</span>
e    <span class="hljs-number">2.0</span>
Name: Utah, dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="99" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="99" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>默认情况下，DataFrame和Series之间的算术运算会将Series的索引匹配到DataFrame的列，然后沿着行一直向下广播：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">183</span>]: frame - series
Out[<span class="hljs-number">183</span>]: 
          b    d    e
Utah    <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>
Ohio    <span class="hljs-number">3.0</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">3.0</span>
Texas   <span class="hljs-number">6.0</span>  <span class="hljs-number">6.0</span>  <span class="hljs-number">6.0</span>
Oregon  <span class="hljs-number">9.0</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">9.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="100" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="100" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果某个索引值在DataFrame的列或Series的索引中找不到，则参与运算的两个对象就会被重新索引以形成并集：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">184</span>]: series2 = pd.Series(range(<span class="hljs-number">3</span>), index=[<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>])

In [<span class="hljs-number">185</span>]: frame + series2
Out[<span class="hljs-number">185</span>]: 
          b   d     e   f
Utah    <span class="hljs-number">0.0</span> NaN   <span class="hljs-number">3.0</span> NaN
Ohio    <span class="hljs-number">3.0</span> NaN   <span class="hljs-number">6.0</span> NaN
Texas   <span class="hljs-number">6.0</span> NaN   <span class="hljs-number">9.0</span> NaN
Oregon  <span class="hljs-number">9.0</span> NaN  <span class="hljs-number">12.0</span> NaN
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="101" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="101" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果你希望匹配行且在列上广播，则必须使用算术运算方法。例如：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">186</span>]: series3 = frame[<span class="hljs-string">&#x27;d&#x27;</span>]

In [<span class="hljs-number">187</span>]: frame
Out[<span class="hljs-number">187</span>]: 
          b     d     e
Utah    <span class="hljs-number">0.0</span>   <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>
Ohio    <span class="hljs-number">3.0</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">5.0</span>
Texas   <span class="hljs-number">6.0</span>   <span class="hljs-number">7.0</span>   <span class="hljs-number">8.0</span>
Oregon  <span class="hljs-number">9.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">11.0</span>

In [<span class="hljs-number">188</span>]: series3
Out[<span class="hljs-number">188</span>]: 
Utah       <span class="hljs-number">1.0</span>
Ohio       <span class="hljs-number">4.0</span>
Texas      <span class="hljs-number">7.0</span>
Oregon    <span class="hljs-number">10.0</span>
Name: d, dtype: float64

In [<span class="hljs-number">189</span>]: frame.sub(series3, axis=<span class="hljs-string">&#x27;index&#x27;</span>)
Out[<span class="hljs-number">189</span>]: 
          b    d    e
Utah   <span class="hljs-number">-1.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>
Ohio   <span class="hljs-number">-1.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>
Texas  <span class="hljs-number">-1.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>
Oregon <span class="hljs-number">-1.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="102" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="102" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>传入的轴号就是希望匹配的轴。在本例中，我们的目的是匹配DataFrame的行索引（axis='index' or axis=0）并进行广播。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="103" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="103" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.6 函数应用和映射</h3>
<p>NumPy的ufuncs（元素级数组方法）也可用于操作pandas对象：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="104" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="104" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">190</span>]: frame = pd.DataFrame(np.random.randn(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>), columns=list(<span class="hljs-string">&#x27;bde&#x27;</span>),
   .....:                      index=[<span class="hljs-string">&#x27;Utah&#x27;</span>, <span class="hljs-string">&#x27;Ohio&#x27;</span>, <span class="hljs-string">&#x27;Texas&#x27;</span>, <span class="hljs-string">&#x27;Oregon&#x27;</span>])

In [<span class="hljs-number">191</span>]: frame
Out[<span class="hljs-number">191</span>]: 
               b         d         e
Utah   <span class="hljs-number">-0.204708</span>  <span class="hljs-number">0.478943</span> <span class="hljs-number">-0.519439</span>
Ohio   <span class="hljs-number">-0.555730</span>  <span class="hljs-number">1.965781</span>  <span class="hljs-number">1.393406</span>
Texas   <span class="hljs-number">0.092908</span>  <span class="hljs-number">0.281746</span>  <span class="hljs-number">0.769023</span>
Oregon  <span class="hljs-number">1.246435</span>  <span class="hljs-number">1.007189</span> <span class="hljs-number">-1.296221</span>

In [<span class="hljs-number">192</span>]: np.abs(frame)
Out[<span class="hljs-number">192</span>]: 
               b         d         e
Utah    <span class="hljs-number">0.204708</span>  <span class="hljs-number">0.478943</span>  <span class="hljs-number">0.519439</span>
Ohio    <span class="hljs-number">0.555730</span>  <span class="hljs-number">1.965781</span>  <span class="hljs-number">1.393406</span>
Texas   <span class="hljs-number">0.092908</span>  <span class="hljs-number">0.281746</span>  <span class="hljs-number">0.769023</span>
Oregon  <span class="hljs-number">1.246435</span>  <span class="hljs-number">1.007189</span>  <span class="hljs-number">1.296221</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="105" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="105" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另一个常见的操作是，将函数应用到由各列或行所形成的一维数组上。DataFrame的apply方法即可实现此功能：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">193</span>]: f = <span class="hljs-keyword">lambda</span> x: x.max() - x.min()

In [<span class="hljs-number">194</span>]: frame.apply(f)
Out[<span class="hljs-number">194</span>]: 
b    <span class="hljs-number">1.802165</span>
d    <span class="hljs-number">1.684034</span>
e    <span class="hljs-number">2.689627</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>这里的函数f，计算了一个Series的最大值和最小值的差，在frame的每列都执行了一次。结果是一个Series，使用frame的列作为索引。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="106" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="106" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>如果传递axis='columns'到apply，这个函数会在每行执行：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">195</span>]: frame.apply(f, axis=<span class="hljs-string">&#x27;columns&#x27;</span>)
Out[<span class="hljs-number">195</span>]:
Utah      <span class="hljs-number">0.998382</span>
Ohio      <span class="hljs-number">2.521511</span>
Texas     <span class="hljs-number">0.676115</span>
Oregon    <span class="hljs-number">2.542656</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>许多最为常见的数组统计功能都被实现成DataFrame的方法（如sum和mean），因此无需使用apply方法。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="107" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="107" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>传递到apply的函数不是必须返回一个标量，还可以返回由多个值组成的Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">196</span>]: <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">x</span>):</span>
   .....:     <span class="hljs-keyword">return</span> pd.Series([x.min(), x.max()], index=[<span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>])

In [<span class="hljs-number">197</span>]: frame.apply(f)
Out[<span class="hljs-number">197</span>]: 
            b         d         e
min <span class="hljs-number">-0.555730</span>  <span class="hljs-number">0.281746</span> <span class="hljs-number">-1.296221</span>
max  <span class="hljs-number">1.246435</span>  <span class="hljs-number">1.965781</span>  <span class="hljs-number">1.393406</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="108" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="108" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>元素级的Python函数也是可以用的。假如你想得到frame中各个浮点值的格式化字符串，使用applymap即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">198</span>]: format = <span class="hljs-keyword">lambda</span> x: <span class="hljs-string">&#x27;%.2f&#x27;</span> % x

In [<span class="hljs-number">199</span>]: frame.applymap(format)
Out[<span class="hljs-number">199</span>]: 
            b     d      e
Utah    <span class="hljs-number">-0.20</span>  <span class="hljs-number">0.48</span>  <span class="hljs-number">-0.52</span>
Ohio    <span class="hljs-number">-0.56</span>  <span class="hljs-number">1.97</span>   <span class="hljs-number">1.39</span>
Texas    <span class="hljs-number">0.09</span>  <span class="hljs-number">0.28</span>   <span class="hljs-number">0.77</span>
Oregon   <span class="hljs-number">1.25</span>  <span class="hljs-number">1.01</span>  <span class="hljs-number">-1.30</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="109" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="109" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>之所以叫做applymap，是因为Series有一个用于应用元素级函数的map方法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">200</span>]: frame[<span class="hljs-string">&#x27;e&#x27;</span>].map(format)
Out[<span class="hljs-number">200</span>]: 
Utah      <span class="hljs-number">-0.52</span>
Ohio       <span class="hljs-number">1.39</span>
Texas      <span class="hljs-number">0.77</span>
Oregon    <span class="hljs-number">-1.30</span>
Name: e, dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="110" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="110" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.7 排序和排名</h3>
<p>根据条件对数据集排序（sorting）也是一种重要的内置运算。要对行或列索引进行排序（按字典顺序），可使用sort_index方法，它将返回一个已排序的新对象：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">201</span>]: obj = pd.Series(range(<span class="hljs-number">4</span>), index=[<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">202</span>]: obj.sort_index()
Out[<span class="hljs-number">202</span>]:
a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">0</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="111" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="111" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于DataFrame，则可以根据任意一个轴上的索引进行排序：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">203</span>]: frame = pd.DataFrame(np.arange(<span class="hljs-number">8</span>).reshape((<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)),
   .....:                      index=[<span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>],
   .....:                      columns=[<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">204</span>]: frame.sort_index()
Out[<span class="hljs-number">204</span>]: 
       d  a  b  c
one    <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>
three  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>

In [<span class="hljs-number">205</span>]: frame.sort_index(axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">205</span>]:
       a  b  c  d
three  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">0</span>
one    <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">4</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="112" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="112" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>数据默认是按升序排序的，但也可以降序排序：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">206</span>]: frame.sort_index(axis=<span class="hljs-number">1</span>, ascending=<span class="hljs-literal">False</span>)
Out[<span class="hljs-number">206</span>]: 
       d  c  b  a
three  <span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
one    <span class="hljs-number">4</span>  <span class="hljs-number">7</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="113" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="113" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>若要按值对Series进行排序，可使用其sort_values方法：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">207</span>]: obj = pd.Series([<span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">-3</span>, <span class="hljs-number">2</span>])

In [<span class="hljs-number">208</span>]: obj.sort_values()
Out[<span class="hljs-number">208</span>]: 
<span class="hljs-number">2</span>   <span class="hljs-number">-3</span>
<span class="hljs-number">3</span>    <span class="hljs-number">2</span>
<span class="hljs-number">0</span>    <span class="hljs-number">4</span>
<span class="hljs-number">1</span>    <span class="hljs-number">7</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="114" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="114" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>在排序时，任何缺失值默认都会被放到Series的末尾：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">209</span>]: obj = pd.Series([<span class="hljs-number">4</span>, np.nan, <span class="hljs-number">7</span>, np.nan, <span class="hljs-number">-3</span>, <span class="hljs-number">2</span>])

In [<span class="hljs-number">210</span>]: obj.sort_values()
Out[<span class="hljs-number">210</span>]: 
<span class="hljs-number">4</span>   <span class="hljs-number">-3.0</span>
<span class="hljs-number">5</span>    <span class="hljs-number">2.0</span>
<span class="hljs-number">0</span>    <span class="hljs-number">4.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">7.0</span>
<span class="hljs-number">1</span>    NaN
<span class="hljs-number">3</span>    NaN
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="115" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="115" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>当排序一个DataFrame时，你可能希望根据一个或多个列中的值进行排序。将一个或多个列的名字传递给sort_values的by选项即可达到该目的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">211</span>]: frame = pd.DataFrame({<span class="hljs-string">&#x27;b&#x27;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">-3</span>, <span class="hljs-number">2</span>], <span class="hljs-string">&#x27;a&#x27;</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]})

In [<span class="hljs-number">212</span>]: frame
Out[<span class="hljs-number">212</span>]: 
   a  b
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">4</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">7</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0</span> <span class="hljs-number">-3</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="116" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="116" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">213</span>]: frame.sort_values(by=<span class="hljs-string">&#x27;b&#x27;</span>)
Out[<span class="hljs-number">213</span>]: 
   a  b
<span class="hljs-number">2</span>  <span class="hljs-number">0</span> <span class="hljs-number">-3</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">4</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">7</span>
</span></span></foreignObject></svg></code></pre>
<p>要根据多个列进行排序，传入名称的列表即可：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">214</span>]: frame.sort_values(by=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>])
Out[<span class="hljs-number">214</span>]: 
   a  b
<span class="hljs-number">2</span>  <span class="hljs-number">0</span> <span class="hljs-number">-3</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">4</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">7</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="117" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="117" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>排名会从1开始一直到数组中有效数据的数量。接下来介绍Series和DataFrame的rank方法。默认情况下，rank是通过“为各组分配一个平均排名”的方式破坏平级关系的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">215</span>]: obj = pd.Series([<span class="hljs-number">7</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>])
In [<span class="hljs-number">216</span>]: obj.rank()
Out[<span class="hljs-number">216</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">6.5</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">6.5</span>
<span class="hljs-number">3</span>    <span class="hljs-number">4.5</span>
<span class="hljs-number">4</span>    <span class="hljs-number">3.0</span>
<span class="hljs-number">5</span>    <span class="hljs-number">2.0</span>
<span class="hljs-number">6</span>    <span class="hljs-number">4.5</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="118" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="118" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>也可以根据值在原数据中出现的顺序给出排名：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">217</span>]: obj.rank(method=<span class="hljs-string">&#x27;first&#x27;</span>)
Out[<span class="hljs-number">217</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">6.0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">7.0</span>
<span class="hljs-number">3</span>    <span class="hljs-number">4.0</span>
<span class="hljs-number">4</span>    <span class="hljs-number">3.0</span>
<span class="hljs-number">5</span>    <span class="hljs-number">2.0</span>
<span class="hljs-number">6</span>    <span class="hljs-number">5.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>这里，条目0和2没有使用平均排名6.5，它们被设成了6和7，因为数据中标签0位于标签2的前面。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="119" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="119" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>你也可以按降序进行排名：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment"># Assign tie values the maximum rank in the group</span>
In [<span class="hljs-number">218</span>]: obj.rank(ascending=<span class="hljs-literal">False</span>, method=<span class="hljs-string">&#x27;max&#x27;</span>)
Out[<span class="hljs-number">218</span>]: 
<span class="hljs-number">0</span>    <span class="hljs-number">2.0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">7.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">2.0</span>
<span class="hljs-number">3</span>    <span class="hljs-number">4.0</span>
<span class="hljs-number">4</span>    <span class="hljs-number">5.0</span>
<span class="hljs-number">5</span>    <span class="hljs-number">6.0</span>
<span class="hljs-number">6</span>    <span class="hljs-number">4.0</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="120" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="120" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-6列出了所有用于破坏平级关系的method选项。DataFrame可以在行或列上计算排名：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="121" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="121" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">219</span>]: frame = pd.DataFrame({<span class="hljs-string">&#x27;b&#x27;</span>: [<span class="hljs-number">4.3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">-3</span>, <span class="hljs-number">2</span>], <span class="hljs-string">&#x27;a&#x27;</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
   .....:                       <span class="hljs-string">&#x27;c&#x27;</span>: [<span class="hljs-number">-2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">-2.5</span>]})

In [<span class="hljs-number">220</span>]: frame
Out[<span class="hljs-number">220</span>]: 
   a    b    c
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">4.3</span> <span class="hljs-number">-2.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">7.0</span>  <span class="hljs-number">5.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0</span> <span class="hljs-number">-3.0</span>  <span class="hljs-number">8.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2.0</span> <span class="hljs-number">-2.5</span>

In [<span class="hljs-number">221</span>]: frame.rank(axis=<span class="hljs-string">&#x27;columns&#x27;</span>)
Out[<span class="hljs-number">221</span>]: 
     a    b    c
<span class="hljs-number">0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">1.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">2.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">3.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">1.0</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="122" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="122" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-7edfab5b4a147581.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表5-6 排名时用于破坏平级关系的方法 w:1000" style="width:1000px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="123" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="123" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.2.8 带有重复标签的轴索引</h3>
<p>直到目前为止，我所介绍的所有范例都有着唯一的轴标签（索引值）。虽然许多pandas函数（如reindex）都要求标签唯一，但这并不是强制性的。我们来看看下面这个简单的带有重复索引值的Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">222</span>]: obj = pd.Series(range(<span class="hljs-number">5</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">223</span>]: obj
Out[<span class="hljs-number">223</span>]: 
a    <span class="hljs-number">0</span>
a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
b    <span class="hljs-number">3</span>
c    <span class="hljs-number">4</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="124" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="124" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>索引的is_unique属性可以告诉你它的值是否是唯一的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">224</span>]: obj.index.is_unique
Out[<span class="hljs-number">224</span>]: <span class="hljs-literal">False</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="125" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="125" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于带有重复值的索引，数据选取的行为将会有些不同。如果某个索引对应多个值，则返回一个Series；而对应单个值的，则返回一个标量值：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">225</span>]: obj[<span class="hljs-string">&#x27;a&#x27;</span>]
Out[<span class="hljs-number">225</span>]: 
a    <span class="hljs-number">0</span>
a    <span class="hljs-number">1</span>
dtype: int64

In [<span class="hljs-number">226</span>]: obj[<span class="hljs-string">&#x27;c&#x27;</span>]
Out[<span class="hljs-number">226</span>]: <span class="hljs-number">4</span>
</span></span></foreignObject></svg></code></pre>
<p>这样会使代码变复杂，因为索引的输出类型会根据标签是否有重复发生变化。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="126" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="126" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对DataFrame的行进行索引时也是如此：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">227</span>]: df = pd.DataFrame(np.random.randn(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>), index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>])

In [<span class="hljs-number">228</span>]: df
Out[<span class="hljs-number">228</span>]: 
          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>
a  <span class="hljs-number">0.274992</span>  <span class="hljs-number">0.228913</span>  <span class="hljs-number">1.352917</span>
a  <span class="hljs-number">0.886429</span> <span class="hljs-number">-2.001637</span> <span class="hljs-number">-0.371843</span>
b  <span class="hljs-number">1.669025</span> <span class="hljs-number">-0.438570</span> <span class="hljs-number">-0.539741</span>
b  <span class="hljs-number">0.476985</span>  <span class="hljs-number">3.248944</span> <span class="hljs-number">-1.021228</span>

In [<span class="hljs-number">229</span>]: df.loc[<span class="hljs-string">&#x27;b&#x27;</span>]
Out[<span class="hljs-number">229</span>]: 
          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>
b  <span class="hljs-number">1.669025</span> <span class="hljs-number">-0.438570</span> <span class="hljs-number">-0.539741</span>
b  <span class="hljs-number">0.476985</span>  <span class="hljs-number">3.248944</span> <span class="hljs-number">-1.021228</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="127" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="127" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>5.3 汇总和计算描述统计</h2>
<p>pandas对象拥有一组常用的数学和统计方法。它们大部分都属于约简和汇总统计，用于从Series中提取单个值（如sum或mean）或从DataFrame的行或列中提取一个Series。跟对应的NumPy数组方法相比，它们都是基于没有缺失数据的假设而构建的。看一个简单的DataFrame：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="128" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="128" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">230</span>]: df = pd.DataFrame([[<span class="hljs-number">1.4</span>, np.nan], [<span class="hljs-number">7.1</span>, <span class="hljs-number">-4.5</span>],
   .....:                    [np.nan, np.nan], [<span class="hljs-number">0.75</span>, <span class="hljs-number">-1.3</span>]],
   .....:                   index=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>],
   .....:                   columns=[<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>])

In [<span class="hljs-number">231</span>]: df
Out[<span class="hljs-number">231</span>]: 
    one  two
a  <span class="hljs-number">1.40</span>  NaN
b  <span class="hljs-number">7.10</span> <span class="hljs-number">-4.5</span>
c   NaN  NaN
d  <span class="hljs-number">0.75</span> <span class="hljs-number">-1.3</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="129" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="129" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>调用DataFrame的sum方法将会返回一个含有列的和的Series：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">232</span>]: df.sum()
Out[<span class="hljs-number">232</span>]: 
one    <span class="hljs-number">9.25</span>
two   <span class="hljs-number">-5.80</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="130" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="130" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>传入axis='columns'或axis=1将会按行进行求和运算：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">233</span>]: df.sum(axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">233</span>]:
a    <span class="hljs-number">1.40</span>
b    <span class="hljs-number">2.60</span>
c     NaN
d   <span class="hljs-number">-0.55</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="131" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="131" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>NA值会自动被排除，除非整个切片（这里指的是行或列）都是NA。通过skipna选项可以禁用该功能：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">234</span>]: df.mean(axis=<span class="hljs-string">&#x27;columns&#x27;</span>, skipna=<span class="hljs-literal">False</span>)
Out[<span class="hljs-number">234</span>]: 
a      NaN
b    <span class="hljs-number">1.300</span>
c      NaN
d   <span class="hljs-number">-0.275</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="132" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="132" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-7列出了这些约简方法的常用选项。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-af35e3809278410e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="133" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="133" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>有些方法（如idxmin和idxmax）返回的是间接统计（比如达到最小值或最大值的索引）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">235</span>]: df.idxmax()
Out[<span class="hljs-number">235</span>]: 
one    b
two    d
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="134" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="134" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另一些方法则是累计型的：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">236</span>]: df.cumsum()
Out[<span class="hljs-number">236</span>]: 
    one  two
a  <span class="hljs-number">1.40</span>  NaN
b  <span class="hljs-number">8.50</span> <span class="hljs-number">-4.5</span>
c   NaN  NaN
d  <span class="hljs-number">9.25</span> <span class="hljs-number">-5.8</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="135" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="135" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>还有一种方法，它既不是约简型也不是累计型。describe就是一个例子，它用于一次性产生多个汇总统计：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">237</span>]: df.describe()
Out[<span class="hljs-number">237</span>]: 
            one       two
count  <span class="hljs-number">3.000000</span>  <span class="hljs-number">2.000000</span>
mean   <span class="hljs-number">3.083333</span> <span class="hljs-number">-2.900000</span>
std    <span class="hljs-number">3.493685</span>  <span class="hljs-number">2.262742</span>
min    <span class="hljs-number">0.750000</span> <span class="hljs-number">-4.500000</span>
<span class="hljs-number">25</span>%    <span class="hljs-number">1.075000</span> <span class="hljs-number">-3.700000</span>
<span class="hljs-number">50</span>%    <span class="hljs-number">1.400000</span> <span class="hljs-number">-2.900000</span>
<span class="hljs-number">75</span>%    <span class="hljs-number">4.250000</span> <span class="hljs-number">-2.100000</span>
max    <span class="hljs-number">7.100000</span> <span class="hljs-number">-1.300000</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="136" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="136" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>对于非数值型数据，describe会产生另外一种汇总统计：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">238</span>]: obj = pd.Series([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>] * <span class="hljs-number">4</span>)

In [<span class="hljs-number">239</span>]: obj.describe()
Out[<span class="hljs-number">239</span>]: 
count     <span class="hljs-number">16</span>
unique     <span class="hljs-number">3</span>
top        a
freq       <span class="hljs-number">8</span>
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="137" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="137" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-8列出了所有与描述统计相关的方法。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-11fa967f658ac314.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w:600" style="width:600px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="138" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="138" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.3.1 相关系数与协方差</h3>
<p>有些汇总统计（如相关系数和协方差）是通过参数对计算出来的。我们来看几个DataFrame，它们的数据来自Yahoo!Finance的股票价格和成交量，使用的是pandas-datareader包（可以用conda或pip安装）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>conda install pandas-datareader
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="139" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="139" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>我使用pandas_datareader模块下载了一些股票数据：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> pandas_datareader.data <span class="hljs-keyword">as</span> web
all_data = {ticker: web.get_data_yahoo(ticker)
            <span class="hljs-keyword">for</span> ticker <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;AAPL&#x27;</span>, <span class="hljs-string">&#x27;IBM&#x27;</span>, <span class="hljs-string">&#x27;MSFT&#x27;</span>, <span class="hljs-string">&#x27;GOOG&#x27;</span>]}

price = pd.DataFrame({ticker: data[<span class="hljs-string">&#x27;Adj Close&#x27;</span>]
                     <span class="hljs-keyword">for</span> ticker, data <span class="hljs-keyword">in</span> all_data.items()})
volume = pd.DataFrame({ticker: data[<span class="hljs-string">&#x27;Volume&#x27;</span>]
                      <span class="hljs-keyword">for</span> ticker, data <span class="hljs-keyword">in</span> all_data.items()})
</span></span></foreignObject></svg></code></pre>
<blockquote>
<p>注意：此时Yahoo! Finance已经不存在了，因为2017年Yahoo!被Verizon收购了。参阅pandas-datareader文档，可以学习最新的功能。</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="140" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="140" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>现在计算价格的百分数变化，时间序列的操作会在第11章介绍：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">242</span>]: returns = price.pct_change()

In [<span class="hljs-number">243</span>]: returns.tail()
Out[<span class="hljs-number">243</span>]: 
                AAPL      GOOG       IBM      MSFT
Date                                              
<span class="hljs-number">2016</span><span class="hljs-number">-10</span><span class="hljs-number">-17</span> <span class="hljs-number">-0.000680</span>  <span class="hljs-number">0.001837</span>  <span class="hljs-number">0.002072</span> <span class="hljs-number">-0.003483</span>
<span class="hljs-number">2016</span><span class="hljs-number">-10</span><span class="hljs-number">-18</span> <span class="hljs-number">-0.000681</span>  <span class="hljs-number">0.019616</span> <span class="hljs-number">-0.026168</span>  <span class="hljs-number">0.007690</span>
<span class="hljs-number">2016</span><span class="hljs-number">-10</span><span class="hljs-number">-19</span> <span class="hljs-number">-0.002979</span>  <span class="hljs-number">0.007846</span>  <span class="hljs-number">0.003583</span> <span class="hljs-number">-0.002255</span>
<span class="hljs-number">2016</span><span class="hljs-number">-10</span><span class="hljs-number">-20</span> <span class="hljs-number">-0.000512</span> <span class="hljs-number">-0.005652</span>  <span class="hljs-number">0.001719</span> <span class="hljs-number">-0.004867</span>
<span class="hljs-number">2016</span><span class="hljs-number">-10</span><span class="hljs-number">-21</span> <span class="hljs-number">-0.003930</span>  <span class="hljs-number">0.003011</span> <span class="hljs-number">-0.012474</span>  <span class="hljs-number">0.042096</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="141" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="141" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>Series的corr方法用于计算两个Series中重叠的、非NA的、按索引对齐的值的相关系数。与此类似，cov用于计算协方差：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">244</span>]: returns[<span class="hljs-string">&#x27;MSFT&#x27;</span>].corr(returns[<span class="hljs-string">&#x27;IBM&#x27;</span>])
Out[<span class="hljs-number">244</span>]: <span class="hljs-number">0.49976361144151144</span>

In [<span class="hljs-number">245</span>]: returns[<span class="hljs-string">&#x27;MSFT&#x27;</span>].cov(returns[<span class="hljs-string">&#x27;IBM&#x27;</span>])
Out[<span class="hljs-number">245</span>]: <span class="hljs-number">8.8706554797035462e-05</span>
</span></span></foreignObject></svg></code></pre>
<p>因为MSTF是一个合理的Python属性，我们还可以用更简洁的语法选择列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">246</span>]: returns.MSFT.corr(returns.IBM)
Out[<span class="hljs-number">246</span>]: <span class="hljs-number">0.49976361144151144</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="142" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="142" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>另一方面，DataFrame的corr和cov方法将以DataFrame的形式分别返回完整的相关系数或协方差矩阵：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">247</span>]: returns.corr()
Out[<span class="hljs-number">247</span>]: 
          AAPL      GOOG       IBM      MSFT
AAPL  <span class="hljs-number">1.000000</span>  <span class="hljs-number">0.407919</span>  <span class="hljs-number">0.386817</span>  <span class="hljs-number">0.389695</span>
GOOG  <span class="hljs-number">0.407919</span>  <span class="hljs-number">1.000000</span>  <span class="hljs-number">0.405099</span>  <span class="hljs-number">0.465919</span>
IBM   <span class="hljs-number">0.386817</span>  <span class="hljs-number">0.405099</span>  <span class="hljs-number">1.000000</span>  <span class="hljs-number">0.499764</span>
MSFT  <span class="hljs-number">0.389695</span>  <span class="hljs-number">0.465919</span>  <span class="hljs-number">0.499764</span>  <span class="hljs-number">1.000000</span>

In [<span class="hljs-number">248</span>]: returns.cov()
Out[<span class="hljs-number">248</span>]: 
          AAPL      GOOG       IBM      MSFT
AAPL  <span class="hljs-number">0.000277</span>  <span class="hljs-number">0.000107</span>  <span class="hljs-number">0.000078</span>  <span class="hljs-number">0.000095</span>
GOOG  <span class="hljs-number">0.000107</span>  <span class="hljs-number">0.000251</span>  <span class="hljs-number">0.000078</span>  <span class="hljs-number">0.000108</span>
IBM   <span class="hljs-number">0.000078</span>  <span class="hljs-number">0.000078</span>  <span class="hljs-number">0.000146</span>  <span class="hljs-number">0.000089</span>
MSFT  <span class="hljs-number">0.000095</span>  <span class="hljs-number">0.000108</span>  <span class="hljs-number">0.000089</span>  <span class="hljs-number">0.000215</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="143" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="143" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>利用DataFrame的corrwith方法，你可以计算其列或行跟另一个Series或DataFrame之间的相关系数。传入一个Series将会返回一个相关系数值Series（针对各列进行计算）：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">249</span>]: returns.corrwith(returns.IBM)
Out[<span class="hljs-number">249</span>]: 
AAPL    <span class="hljs-number">0.386817</span>
GOOG    <span class="hljs-number">0.405099</span>
IBM     <span class="hljs-number">1.000000</span>
MSFT    <span class="hljs-number">0.499764</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="144" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="144" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>传入一个DataFrame则会计算按列名配对的相关系数。这里，我计算百分比变化与成交量的相关系数：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">250</span>]: returns.corrwith(volume)
Out[<span class="hljs-number">250</span>]: 
AAPL   <span class="hljs-number">-0.075565</span>
GOOG   <span class="hljs-number">-0.007067</span>
IBM    <span class="hljs-number">-0.204849</span>
MSFT   <span class="hljs-number">-0.092950</span>
dtype: float64
</span></span></foreignObject></svg></code></pre>
<p>传入axis='columns'即可按行进行计算。无论如何，在计算相关系数之前，所有的数据项都会按标签对齐。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="145" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="145" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h3>5.3.2 唯一值、值计数以及成员资格</h3>
<p>还有一类方法可以从一维Series的值中抽取信息。看下面的例子：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">251</span>]: obj = pd.Series([<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])
</span></span></foreignObject></svg></code></pre>
<p>第一个函数是unique，它可以得到Series中的唯一值数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">252</span>]: uniques = obj.unique()

In [<span class="hljs-number">253</span>]: uniques
Out[<span class="hljs-number">253</span>]: array([<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>], dtype=object)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="146" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="146" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>返回的唯一值是未排序的，如果需要的话，可以对结果再次进行排序（uniques.sort()）。相似的，value_counts用于计算一个Series中各值出现的频率：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">254</span>]: obj.value_counts()
Out[<span class="hljs-number">254</span>]: 
c    <span class="hljs-number">3</span>
a    <span class="hljs-number">3</span>
b    <span class="hljs-number">2</span>
d    <span class="hljs-number">1</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="147" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="147" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>为了便于查看，结果Series是按值频率降序排列的。value_counts还是一个顶级pandas方法，可用于任何数组或序列：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">255</span>]: pd.value_counts(obj.values, sort=<span class="hljs-literal">False</span>)
Out[<span class="hljs-number">255</span>]: 
a    <span class="hljs-number">3</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">1</span>
dtype: int64
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="148" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="148" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>isin用于判断矢量化集合的成员资格，可用于过滤Series中或DataFrame列中数据的子集：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">256</span>]: obj
Out[<span class="hljs-number">256</span>]: 
<span class="hljs-number">0</span>    c
<span class="hljs-number">1</span>    a
<span class="hljs-number">2</span>    d
<span class="hljs-number">3</span>    a
<span class="hljs-number">4</span>    a
<span class="hljs-number">5</span>    b
<span class="hljs-number">6</span>    b
<span class="hljs-number">7</span>    c
<span class="hljs-number">8</span>    c
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="149" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="149" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">257</span>]: mask = obj.isin([<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])

In [<span class="hljs-number">258</span>]: mask
Out[<span class="hljs-number">258</span>]: 
<span class="hljs-number">0</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">4</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">5</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">6</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">7</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">8</span>     <span class="hljs-literal">True</span>
dtype: bool
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="150" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="150" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">259</span>]: obj[mask]
Out[<span class="hljs-number">259</span>]: 
<span class="hljs-number">0</span>    c
<span class="hljs-number">5</span>    b
<span class="hljs-number">6</span>    b
<span class="hljs-number">7</span>    c
<span class="hljs-number">8</span>    c
dtype: object
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="151" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="151" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>与isin类似的是Index.get_indexer方法，它可以给你一个索引数组，从可能包含重复值的数组到另一个不同值的数组：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">260</span>]: to_match = pd.Series([<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>])

In [<span class="hljs-number">261</span>]: unique_vals = pd.Series([<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>])

In [<span class="hljs-number">262</span>]: pd.Index(unique_vals).get_indexer(to_match)
Out[<span class="hljs-number">262</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>])
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="152" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="152" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>表5-9给出了这几个方法的一些参考信息。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-b53c4a9d65a2db32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表5-9 唯一值、值计数、成员资格方法" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="153" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="153" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>有时，你可能希望得到DataFrame中多个相关列的一张柱状图。例如：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">263</span>]: data = pd.DataFrame({<span class="hljs-string">&#x27;Qu1&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
   .....:                      <span class="hljs-string">&#x27;Qu2&#x27;</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
   .....:                      <span class="hljs-string">&#x27;Qu3&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>]})

In [<span class="hljs-number">264</span>]: data
Out[<span class="hljs-number">264</span>]: 
   Qu1  Qu2  Qu3
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>
<span class="hljs-number">1</span>    <span class="hljs-number">3</span>    <span class="hljs-number">3</span>    <span class="hljs-number">5</span>
<span class="hljs-number">2</span>    <span class="hljs-number">4</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
<span class="hljs-number">3</span>    <span class="hljs-number">3</span>    <span class="hljs-number">2</span>    <span class="hljs-number">4</span>
<span class="hljs-number">4</span>    <span class="hljs-number">4</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="154" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="154" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<p>将pandas.value_counts传给该DataFrame的apply函数，就会出现：</p>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>In [<span class="hljs-number">265</span>]: result = data.apply(pd.value_counts).fillna(<span class="hljs-number">0</span>)

In [<span class="hljs-number">266</span>]: result
Out[<span class="hljs-number">266</span>]: 
   Qu1  Qu2  Qu3
<span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">1.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">0.0</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">2.0</span>
<span class="hljs-number">5</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>
</span></span></foreignObject></svg></code></pre>
<p>这里，结果中的行标签是所有列的唯一值。后面的频率值是每个列中这些值的相应计数。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="155" data-paginate="true" data-background-color="#fff" data-background-image="url('https://marp.app/assets/hero-background.jpg')" data-theme="gaia" data-marpit-pagination="155" data-marpit-pagination-total="155" style="--paginate:true;--background-color:#fff;--background-image:url('https://marp.app/assets/hero-background.jpg');--theme:gaia;background-color:#fff;background-image:url('https://marp.app/assets/hero-background.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h2>5.4 总结</h2>
<p>在下一章，我们将讨论用pandas读取（或加载）和写入数据集的工具。</p>
<p>之后，我们将更深入地研究使用pandas进行数据清洗、规整、分析和可视化工具。</p>
</section>
<script>!function(){"use strict";const t="marpitSVGPolyfill:setZoomFactor,",e=Symbol();let o,r;function n(n){const i="object"==typeof n&&n.target||document,a="object"==typeof n?n.zoom:n;window[e]||(Object.defineProperty(window,e,{configurable:!0,value:!0}),window.addEventListener("message",({data:e,origin:o})=>{if(o===window.origin)try{if(e&&"string"==typeof e&&e.startsWith(t)){const[,t]=e.split(","),o=Number.parseFloat(t);Number.isNaN(o)||(r=o)}}catch(t){console.error(t)}}));let l=!1;Array.from(i.querySelectorAll("svg[data-marpit-svg]"),t=>{var e,n,i,s;t.style.transform||(t.style.transform="translateZ(0)");const c=a||r||t.currentScale||1;o!==c&&(o=c,l=c);const d=t.getBoundingClientRect(),{length:u}=t.children;for(let o=0;o<u;o+=1){const r=t.children[o],a=r.getScreenCTM();if(a){const t=null!==(n=null===(e=r.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==n?n:0,o=null!==(s=null===(i=r.y)||void 0===i?void 0:i.baseVal.value)&&void 0!==s?s:0,l=r.firstChild,{style:u}=l;u.transformOrigin||(u.transformOrigin=`${-t}px ${-o}px`),u.transform=`scale(${c}) matrix(${a.a}, ${a.b}, ${a.c}, ${a.d}, ${a.e-d.left}, ${a.f-d.top}) translateZ(0.0001px)`}}}),!1!==l&&Array.from(i.querySelectorAll("iframe"),({contentWindow:e})=>{null==e||e.postMessage(`${t}${l}`,"null"===window.origin?"*":window.origin)})}o=1,r=void 0;const i=(t,e,o)=>{if(t.getAttribute(e)!==o)return t.setAttribute(e,o),!0};function a(t={}){const e="boolean"==typeof t?(t=>{const e=!t;return console.warn(`[DEPRECATION WARNING] Usage of observer() with boolean option has been deprecated. Please replace with the usage of option object: observer({ once: ${e?"true":"false"} }).`),{once:e}})(t):t,{once:o=!1,target:r=document}=e,a="Apple Computer, Inc."===navigator.vendor?[n]:[];let l=!o;const s=()=>{for(const t of a)t({target:r});!function(t=document){Array.from(t.querySelectorAll('svg[data-marp-fitting="svg"]'),t=>{var e;const o=t.firstChild,r=o.firstChild,{scrollWidth:n,scrollHeight:a}=r;let l,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(l=null===(e=t.parentElement)||void 0===e?void 0:e.parentElement),t.hasAttribute("data-marp-fitting-math")&&(l=t.parentElement),l){const t=getComputedStyle(l),e=Math.ceil(l.clientWidth-parseFloat(t.paddingLeft||"0")-parseFloat(t.paddingRight||"0"));e&&(s=e)}const c=Math.max(n,s),d=Math.max(a,1),u=`0 0 ${c} ${d}`;i(o,"width",""+c),i(o,"height",""+d),i(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),i(t,"viewBox",u)&&t.classList.toggle("__reflow__")})}(r),l&&window.requestAnimationFrame(s)};return s(),()=>{l=!1}}const l=Symbol(),s=document.currentScript;((t=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(t[l])return t[l];const e=a({target:t}),o=()=>{e(),delete t[l]};Object.defineProperty(t,l,{configurable:!0,value:o})})(s?s.getRootNode():document)}();
</script></foreignObject></svg></div><script>!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),a=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),s={},i=function(e,t){return(t=t||{}).index=a.indexOf(e),t.slide=e,t},o=function(e,t){s[e]=(s[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(s[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){a[e]&&(n&&l("deactivate",i(n,t)),n=a[e],l("activate",i(n,t)))},d=function(e,t){var r=a.indexOf(n)+e;l(e>0?"next":"prev",i(n,t))&&c(r,t)},u={off:o,on:function(e,t){return(s[e]||(s[e]=[])).push(t),o.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return a.indexOf(n);l("slide",i(a[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:a,destroy:function(e){l("destroy",i(n,e)),s={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach(e=>e.classList.add("bespoke-marp-slide")),e.on("activate",t=>{const n=t.slide,r=!n.classList.contains("bespoke-marp-active");e.slides.forEach(e=>{e.classList.remove("bespoke-marp-active"),e.setAttribute("aria-hidden","true")}),n.classList.add("bespoke-marp-active"),n.removeAttribute("aria-hidden"),r&&(n.classList.add("bespoke-marp-active-ready"),document.body.clientHeight,n.classList.remove("bespoke-marp-active-ready"))})}function n(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map(e=>[null,...e.querySelectorAll("[data-marpit-fragment]")])});const r=r=>void 0!==e.fragments[t][n+r],a=(r,a)=>{t=r,n=a,e.fragments.forEach((e,t)=>{e.forEach((e,n)=>{if(null==e)return;const s=t<r||t===r&&n<=a;e.setAttribute("data-bespoke-marp-fragment",s?"active":"inactive"),t===r&&n===a?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")})}),e.fragmentIndex=a;const s={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:a};e.fire("fragment",s)};e.on("next",({fragment:s=!0})=>{if(s){if(r(1))return a(t,n+1),!1;const s=t+1;e.fragments[s]&&a(s,0)}else{const r=e.fragments[t].length;if(n+1<r)return a(t,r-1),!1;const s=e.fragments[t+1];s&&a(t+1,s.length-1)}}),e.on("prev",({fragment:s=!0})=>{if(r(-1)&&s)return a(t,n-1),!1;const i=t-1;e.fragments[i]&&a(i,e.fragments[i].length-1)}),e.on("slide",({index:t,fragment:n})=>{let r=0;if(void 0!==n){const a=e.fragments[t];if(a){const{length:e}=a;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}a(t,r)}),a(0,0)}var r,a,s=(function(e){
/*!
* screenfull
* v5.0.2 - 2020-02-13
* (c) Sindre Sorhus; MIT License
*/
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,a=n.length,s={};r<a;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)s[n[0][r]]=e[r];return s}return!1}(),a={change:r.fullscreenchange,error:r.fullscreenerror},s={request:function(e){return new Promise(function(n,a){var s=function(){this.off("change",s),n()}.bind(this);this.on("change",s);var i=(e=e||t.documentElement)[r.requestFullscreen]();i instanceof Promise&&i.then(s).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var a=function(){this.off("change",a),e()}.bind(this);this.on("change",a);var s=t[r.exitFullscreen]();s instanceof Promise&&s.then(a).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=a[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=a[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=s:window.screenfull=s):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}(a={path:r,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports);function i(e){e.fullscreen=()=>{s.isEnabled&&s.toggle(document.body)},document.addEventListener("keydown",t=>{70!==t.which&&122!==t.which||t.altKey||t.ctrlKey||t.metaKey||!s.isEnabled||(e.fullscreen(),t.preventDefault())})}function o(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout(()=>{t.parent.classList.add("bespoke-marp-inactive"),t.fire("marp-inactive")},e),t.parent.classList.contains("bespoke-marp-inactive")&&(t.parent.classList.remove("bespoke-marp-inactive"),t.fire("marp-active"))}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const l=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function c(e){e.parent.addEventListener("keydown",e=>{if(!e.target)return;const t=e.target;(l.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()})}function d(e){window.addEventListener("load",()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}})}var u;function f({interval:e=200}={}){return t=>{document.addEventListener("keydown",e=>{if(32===e.which&&e.shiftKey)t.prev();else if(33===e.which||37===e.which||38===e.which)t.prev({fragment:!e.shiftKey});else if(32!==e.which||e.shiftKey)if(34===e.which||39===e.which||40===e.which)t.next({fragment:!e.shiftKey});else if(35===e.which)t.slide(t.slides.length-1,{fragment:-1});else{if(36!==e.which)return;t.slide(0)}else t.next();e.preventDefault()});let n,r,a=0;t.parent.addEventListener("wheel",s=>{let i=!1;const o=(e,t)=>{e&&(i=i||function(e,t){return function(e,t){const n=t===u.X?"Width":"Height";return e["client"+n]<e["scroll"+n]}(e,t)&&function(e,t){const{overflow:n}=e,r=e["overflow"+t];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&o(e.parentElement,t)};if(0!==s.deltaX&&o(s.target,u.X),0!==s.deltaY&&o(s.target,u.Y),i)return;s.preventDefault(),r&&clearTimeout(r),r=setTimeout(()=>{n=0},e);const l=Date.now()-a<e,c=Math.sqrt(Math.pow(s.deltaX,2)+Math.pow(s.deltaY,2)),d=c<=n;if(n=c,l||d)return;let f;(s.deltaX>0||s.deltaY>0)&&(f="next"),(s.deltaX<0||s.deltaY<0)&&(f="prev"),f&&(t[f](),a=Date.now())})}}!function(e){e.X="X",e.Y="Y"}(u||(u={}));const m=(...e)=>history.replaceState(...e),p="data-bespoke-view";var h;!function(e){e.Normal="",e.Presenter="presenter",e.Next="next"}(h||(h={}));const g=(e,{protocol:t,host:n,pathname:r,hash:a}=location)=>{const s=e.toString();return`${t}//${n}${r}${s?"?":""}${s}${a}`},v=()=>{switch(document.body.getAttribute(p)){case h.Normal:return h.Normal;case h.Presenter:return h.Presenter;case h.Next:return h.Next;default:throw new Error("View mode is not assigned.")}},b=e=>new URLSearchParams(location.search).get(e),w=(e,t={})=>{const n=Object.assign({location:location,setter:m},t),r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter(null,document.title,g(r,n.location))}catch(e){console.error(e)}},y={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function x(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return s.isEnabled||n("fullscreen",e=>e.style.display="none"),y.available||n("presenter",e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."}),e=>{t.addEventListener("click",t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next({fragment:!t.shiftKey});break;case"prev":e.prev({fragment:!t.shiftKey});break;case"fullscreen":"function"==typeof e.fullscreen&&s.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}}),e.parent.appendChild(t),e.on("activate",({index:t})=>{n("page",n=>n.textContent=`Page ${t+1} of ${e.slides.length}`)}),e.on("fragment",({index:t,fragments:r,fragmentIndex:a})=>{n("prev",e=>e.disabled=0===t&&0===a),n("next",n=>n.disabled=t===e.slides.length-1&&a===r.length-1)}),e.on("marp-active",()=>t.removeAttribute("aria-hidden")),e.on("marp-inactive",()=>t.setAttribute("aria-hidden","true")),s.isEnabled&&s.onchange(()=>n("fullscreen",e=>e.classList.toggle("exit",s.isEnabled&&s.isFullscreen)))}}function E(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,"bespoke-marp-presenter-"+this.syncKey,`width=${e},height=${t},menubar=no,toolbar=no`)}function k(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),g(e)}var L=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let S=e=>String(e).replace(/[&<>"']/g,e=>`&${I[e]};`),I={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},P="dangerouslySetInnerHTML",M={className:"class",htmlFor:"for"},N={};function F(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==P&&(r+=` ${M[e]?M[e]:S(e)}="${S(t[e])}"`);r+=">"}if(-1===L.indexOf(e)){if(t[P])r+=t[P].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===N[e]?e:S(e)}r+=e?`</${e}>`:""}return N[r]=!0,r}const O=({children:e})=>F(null,null,...e),q="bespoke-marp-presenter-container",C="bespoke-marp-presenter-next",T="bespoke-marp-presenter-next-container",A="bespoke-marp-presenter-note-container",K="bespoke-marp-presenter-info-container",$="bespoke-marp-presenter-info-page",j="bespoke-marp-presenter-info-page-text",D="bespoke-marp-presenter-info-page-prev",R="bespoke-marp-presenter-info-page-next",U="bespoke-marp-presenter-info-time",V="bespoke-marp-presenter-info-timer";function X(e){const{title:t}=document;document.title="[Presenter view]"+(t?" - "+t:"");const n={},r=e=>(n[e]=n[e]||document.querySelector("."+e),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=q,t.appendChild(e),t.insertAdjacentHTML("beforeend",F(O,null,F("div",{class:T},F("iframe",{class:C,src:"?view=next"})),F("div",{class:A}),F("div",{class:K},F("div",{class:$},F("button",{class:D,tabindex:"-1",title:"Previous"},"Previous"),F("span",{class:j}),F("button",{class:R,tabindex:"-1",title:"Next"},"Next")),F("time",{class:U,title:"Current time"}),F("div",{class:V})))),t})(e.parent)),(e=>{r(T).addEventListener("click",()=>e.next());const t=r(C),n=(a=t,(e,t)=>{var n;return null===(n=a.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var a;t.addEventListener("load",()=>{r(T).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",({index:e,fragmentIndex:t})=>n(e,t))});const s=document.querySelectorAll(".bespoke-marp-note");s.forEach(e=>{e.addEventListener("keydown",e=>e.stopPropagation()),r(A).appendChild(e)}),e.on("activate",()=>s.forEach(t=>t.classList.toggle("active",t.dataset.index==e.slide()))),e.on("activate",({index:t})=>{r(j).textContent=`${t+1} / ${e.slides.length}`});const i=r(D),o=r(R);i.addEventListener("click",t=>{i.blur(),e.prev({fragment:!t.shiftKey})}),o.addEventListener("click",t=>{o.blur(),e.next({fragment:!t.shiftKey})}),e.on("fragment",({index:t,fragments:n,fragmentIndex:r})=>{i.disabled=0===t&&0===r,o.disabled=t===e.slides.length-1&&r===n.length-1});const l=()=>r(U).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function Y(e){const t=v();return t===h.Next&&e.appendChild(document.createElement("span")),e=>{t===h.Normal&&function(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:E},presenterUrl:{enumerable:!0,get:k}}),y.available&&document.addEventListener("keydown",t=>{80!==t.which||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())})}(e),t===h.Presenter&&X(e),t===h.Next&&function(e){const t=t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let a=Number.parseInt(t,10),s=Number.parseInt(n,10)+1;s>=e.fragments[a].length&&(a+=1,s=0),e.slide(a,{fragment:s})}};window.addEventListener("message",t),e.on("destroy",()=>window.removeEventListener("message",t))}(e)}}function B(e){e.on("activate",t=>{document.querySelectorAll(".bespoke-progress-bar").forEach(n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"})})}const z=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function H(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},a=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:a}=e,s=Math.max(0,Math.min(t,a.length-1)),i=Math.max(0,Math.min(n||0,r[s].length-1));s===e.slide()&&i===e.fragmentIndex||e.slide(s,{fragment:i})})((z(location.hash.slice(1))||1)-1,t.fragment?z(b("f")||""):null)};e.on("fragment",({index:e,fragmentIndex:r})=>{n||w({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:"#"+(e+1)}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})}),setTimeout(()=>{a(),window.addEventListener("hashchange",()=>r(()=>{a({fragment:!1}),w({f:void 0})})),window.addEventListener("popstate",()=>{n||r(()=>a())}),n=!1},0)}}function W(e={}){const t=e.key||((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t})(),n="bespoke-marp-sync-"+t,r=()=>{const e=y.get(n);return e?JSON.parse(e):Object.create(null)},a=e=>{const t=r(),a=Object.assign(Object.assign({},t),e(t));return y.set(n,JSON.stringify(a)),a};return a(e=>({reference:(e.reference||0)+1})),e=>{Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let s=!0;setTimeout(()=>{e.on("fragment",e=>{s&&a(()=>({index:e.index,fragmentIndex:e.fragmentIndex}))})},0),window.addEventListener("storage",t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),r=JSON.parse(t.newValue);if(n.index!==r.index||n.fragmentIndex!==r.fragmentIndex)try{s=!1,e.slide(r.index,{fragment:r.fragmentIndex})}finally{s=!0}}}),e.on("destroy",()=>{const{reference:e}=r();void 0===e||e<=1?y.remove(n):a(()=>({reference:e-1}))})}}function J({slope:e=Math.tan(-35*Math.PI/180),swipeThreshold:t=30}={}){return n=>{let r;const a=n.parent,s=e=>{const t=a.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};a.addEventListener("touchstart",e=>{r=1===e.touches.length?s(e.touches[0]):void 0},{passive:!0}),a.addEventListener("touchmove",e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),n=t.x-r.x,a=t.y-r.y;r.delta=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(a),2)),r.radian=Math.atan2(n,a)}else r=void 0}),a.addEventListener("touchend",a=>{if(r){if(r.delta&&r.delta>=t&&r.radian){let t=r.radian-e;t=(t+Math.PI)%(2*Math.PI)-Math.PI,n[t<0?"next":"prev"](),a.stopPropagation()}r=void 0}},{passive:!0})}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function _(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))}let G=void 0;const Q=()=>(void 0===G&&(G="wakeLock"in navigator&&navigator.wakeLock),G),Z=()=>_(void 0,void 0,void 0,(function*(){const e=Q();if(e)try{const t=yield e.request("screen");return t.addEventListener("release",()=>{console.debug("[Marp CLI] Wake Lock was released")}),console.debug("[Marp CLI] Wake Lock is active"),t}catch(e){console.warn(e)}return null}));function ee(){return _(this,void 0,void 0,(function*(){if(!Q())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&Z()};return document.addEventListener("visibilitychange",t),document.addEventListener("fullscreenchange",t),e=yield Z(),e}))}const te=[h.Normal,h.Presenter,h.Next];!function(r=document.getElementById("p")){document.body.setAttribute(p,(()=>{switch(b("view")){case"next":return h.Next;case"presenter":return h.Presenter;default:return h.Normal}})());const a=(e=>{const t=b(e);return w({[e]:void 0}),t})("sync")||void 0,s=!1,l=!0,u=e(r,((...e)=>{const t=te.findIndex(e=>v()===e);if(t<0)throw new Error("Invalid view");return e.map(([e,n])=>e[t]&&n).filter(e=>e)})([[l,l,s],W({key:a})],[[l,l,l],Y(r)],[[l,l,s],c],[[l,l,l],t],[[l,s,s],o()],[[l,l,l],d],[[l,l,l],H({history:!1})],[[l,l,s],f()],[[l,l,s],i],[[l,s,s],B],[[l,l,s],J()],[[l,s,s],x()],[[l,l,l],n],[[l,l,s],ee]));window.addEventListener("beforeunload",()=>w({sync:u.syncKey})),window.addEventListener("unload",()=>u.destroy())}()}();</script><script>window.__marpCliWatchWS="ws://localhost:37717/bd40826083f93cf7bdc8874462682a88a0768ce8eebea6ce880f367e519739d7";!function(){"use strict";const e=(n,o=!1)=>{const t=new WebSocket(n);return t.addEventListener("open",()=>{console.info("[Marp CLI] Observing the change of file..."),o&&location.reload()}),t.addEventListener("close",()=>{console.warn("[Marp CLI] WebSocket for file watcher was disconnected. Try re-connecting in 5000ms..."),setTimeout(()=>e(n,!0),5e3)}),t.addEventListener("message",e=>{"reload"===e.data&&location.reload()}),t};!function(){const n=window.__marpCliWatchWS;if(n)e(n)}()}();</script></body></html>